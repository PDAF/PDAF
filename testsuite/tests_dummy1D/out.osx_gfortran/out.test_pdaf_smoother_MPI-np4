====================  Testing smoother in PDAF  ====================
Machine:  Darwin binf02m041.fritz.box 17.3.0 Darwin Kernel Version 17.3.0: Thu Nov 9 18:09:22 PST 2017; root:xnu-4570.31.3~1/RELEASE_X86_64 x86_64
Date:  Fri Dec 22 10:30:12 CET 2017
--------------------------------------------------------
Run EnKF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs

               Use OpenMP with   2 threads



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2              2      0      1      1       F
     3              2      1      2      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         2
  PARSER: subtype=         0
  PARSER: dim_lag=        10
  PARSER: filename= output_par_smoother_enkf0.dat
                     Filter: EnKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF     +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF     +++          Ensemble Kalman Filter (EnKF)          +++
PDAF     +++                                                 +++
PDAF     +++   Evensen, J. Geophys. Res. 99C (1994) 10143    +++
PDAF     +++ using an ensemble of observations according to  +++
PDAF     +++ Burgers et al., Mon. Wea. Rev. 126 (1998) 1719  +++
PDAF     +++          This implementation follows            +++
PDAF     +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF     +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF      EnKF configuration
PDAF            filter sub-type = 0
PDAF              --> EnKF with analysis for large observation dimension
PDAF              --> Apply smoother up to lag:    10
PDAF              --> ensemble size:   50
PDAF          --> forgetting factor: 1.00

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use constrained random stochastic ensemble (EnKF type)
         --- Ensemble size:   50
         --- Generate ensemble
             Rank of covar matrix =    49
PDAF     --- EnKF_omega: Normalize columns of random matrix
PDAF     --- EnKF_omega: Project columns orthogonal to (1,...,1)^T

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.9918E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   6.0082E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector       150
            RMS error according to sampled variance:   3.9918E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   6.0082E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      2
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.4147E-01
               RMS error according to true variance:   9.6203E-01
              Relative underestimation of variances:   7.4900E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.4147E-01
               RMS error according to true variance:   9.6203E-01
              Relative underestimation of variances:   7.4900E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      4
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag       1
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8372E-01
               RMS error according to true variance:   9.5189E-01
              Relative underestimation of variances:   8.0699E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.8372E-01     9.5189E-01     8.0699E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector       150
            RMS error according to sampled variance:   1.8372E-01
               RMS error according to true variance:   9.5189E-01
              Relative underestimation of variances:   8.0699E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      6
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag       2
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5388E-01
               RMS error according to true variance:   9.5115E-01
              Relative underestimation of variances:   8.3822E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.5388E-01     9.5115E-01     8.3822E-01
                   2  1.5388E-01     9.5115E-01     8.3822E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector       150
            RMS error according to sampled variance:   1.5388E-01
               RMS error according to true variance:   9.5115E-01
              Relative underestimation of variances:   8.3822E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      8
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag       3
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3282E-01
               RMS error according to true variance:   9.4422E-01
              Relative underestimation of variances:   8.5933E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.3282E-01     9.4422E-01     8.5933E-01
                   2  1.3282E-01     9.4422E-01     8.5933E-01
                   3  1.3282E-01     9.4422E-01     8.5933E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3282E-01
               RMS error according to true variance:   9.4422E-01
              Relative underestimation of variances:   8.5933E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     10
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag       4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.1850E-01
               RMS error according to true variance:   9.4326E-01
              Relative underestimation of variances:   8.7437E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.1850E-01     9.4326E-01     8.7437E-01
                   2  1.1850E-01     9.4326E-01     8.7437E-01
                   3  1.1850E-01     9.4326E-01     8.7437E-01
                   4  1.1850E-01     9.4326E-01     8.7437E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.1850E-01
               RMS error according to true variance:   9.4326E-01
              Relative underestimation of variances:   8.7437E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     12
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag       5
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.0796E-01
               RMS error according to true variance:   9.4268E-01
              Relative underestimation of variances:   8.8547E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.0796E-01     9.4268E-01     8.8547E-01
                   2  1.0796E-01     9.4268E-01     8.8547E-01
                   3  1.0796E-01     9.4268E-01     8.8547E-01
                   4  1.0796E-01     9.4268E-01     8.8547E-01
                   5  1.0796E-01     9.4268E-01     8.8547E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.0796E-01
               RMS error according to true variance:   9.4268E-01
              Relative underestimation of variances:   8.8547E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     14
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag       6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   9.7926E-02
               RMS error according to true variance:   9.4110E-01
              Relative underestimation of variances:   8.9594E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  9.7926E-02     9.4110E-01     8.9594E-01
                   2  9.7926E-02     9.4110E-01     8.9594E-01
                   3  9.7926E-02     9.4110E-01     8.9594E-01
                   4  9.7926E-02     9.4110E-01     8.9594E-01
                   5  9.7926E-02     9.4110E-01     8.9594E-01
                   6  9.7926E-02     9.4110E-01     8.9594E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   9.7926E-02
               RMS error according to true variance:   9.4110E-01
              Relative underestimation of variances:   8.9594E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     16
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag       7
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   9.2088E-02
               RMS error according to true variance:   9.4022E-01
              Relative underestimation of variances:   9.0206E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  9.2088E-02     9.4022E-01     9.0206E-01
                   2  9.2088E-02     9.4022E-01     9.0206E-01
                   3  9.2088E-02     9.4022E-01     9.0206E-01
                   4  9.2088E-02     9.4022E-01     9.0206E-01
                   5  9.2088E-02     9.4022E-01     9.0206E-01
                   6  9.2088E-02     9.4022E-01     9.0206E-01
                   7  9.2088E-02     9.4022E-01     9.0206E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   9.2088E-02
               RMS error according to true variance:   9.4022E-01
              Relative underestimation of variances:   9.0206E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     18
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag       8
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.4728E-02
               RMS error according to true variance:   9.3915E-01
              Relative underestimation of variances:   9.0978E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  8.4728E-02     9.3915E-01     9.0978E-01
                   2  8.4728E-02     9.3915E-01     9.0978E-01
                   3  8.4728E-02     9.3915E-01     9.0978E-01
                   4  8.4728E-02     9.3915E-01     9.0978E-01
                   5  8.4728E-02     9.3915E-01     9.0978E-01
                   6  8.4728E-02     9.3915E-01     9.0978E-01
                   7  8.4728E-02     9.3915E-01     9.0978E-01
                   8  8.4728E-02     9.3915E-01     9.0978E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.4728E-02
               RMS error according to true variance:   9.3915E-01
              Relative underestimation of variances:   9.0978E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     20
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag       9
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.0894E-02
               RMS error according to true variance:   9.3875E-01
              Relative underestimation of variances:   9.1383E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  8.0894E-02     9.3875E-01     9.1383E-01
                   2  8.0894E-02     9.3875E-01     9.1383E-01
                   3  8.0894E-02     9.3875E-01     9.1383E-01
                   4  8.0894E-02     9.3875E-01     9.1383E-01
                   5  8.0894E-02     9.3875E-01     9.1383E-01
                   6  8.0894E-02     9.3875E-01     9.1383E-01
                   7  8.0894E-02     9.3875E-01     9.1383E-01
                   8  8.0894E-02     9.3875E-01     9.1383E-01
                   9  8.0894E-02     9.3875E-01     9.1383E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION
 model PE exited: mype            2
 model PE exited: mype            3

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.30517 MB (temporary)
             Pre-Poststep:   0.08926 MB (temporary)
 model PE exited: mype            1

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF                    state:   0.00114 MB (persistent)
PDAF           ensemble array:   0.60081 MB (persistent)
PDAF            analysis step:   1.08110 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.001 s
PDAF                  Time of forecasts:      0.004 s
PDAF              Time of assimilations:      0.062 s
PDAF                Time of prepoststep:      0.007 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.073 s
                   total run time:      0.075 s

 PDAF test suite: END
--------------------------------------------------------
Run ETKF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs

               Use OpenMP with   2 threads



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2              2      0      1      1       F
     3              2      1      2      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         4
  PARSER: subtype=         0
  PARSER: dim_lag=        10
  PARSER: filename= output_par_smoother_etkf0.dat
                     Filter: ETKF
      -- Variant using T-matrix
              ensemble size:   50
               smoother lag:   10
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++     Ensemble Transform Kalman Filter (ETKF)     +++
PDAF    +++                                                 +++
PDAF    +++   Bishop et al., Mon. Wea. Rev. 129 (2001) 420  +++
PDAF    +++    A symmetric square root is used following    +++
PDAF    +++      Hunt et al. Physica D 230 (2007) 112       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ETKF configuration
PDAF         filter sub-type = 0
PDAF            --> ETKF using T-matrix
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> Apply smoother up to lag:    10
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      2
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector       150
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      4
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        1
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  2.3333E-01     9.4184E-01     7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      6
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        2
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  2.0207E-01     9.3827E-01     7.8463E-01
                   2  2.0207E-01     9.3827E-01     7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      8
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        3
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.8074E-01     9.2853E-01     8.0535E-01
                   2  1.8074E-01     9.2853E-01     8.0535E-01
                   3  1.8074E-01     9.2853E-01     8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     10
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.6499E-01     9.2803E-01     8.2221E-01
                   2  1.6499E-01     9.2803E-01     8.2221E-01
                   3  1.6499E-01     9.2803E-01     8.2221E-01
                   4  1.6499E-01     9.2803E-01     8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     12
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        5
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.5275E-01     9.2691E-01     8.3520E-01
                   2  1.5275E-01     9.2691E-01     8.3520E-01
                   3  1.5275E-01     9.2691E-01     8.3520E-01
                   4  1.5275E-01     9.2691E-01     8.3520E-01
                   5  1.5275E-01     9.2691E-01     8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     14
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.4289E-01     9.2203E-01     8.4503E-01
                   2  1.4289E-01     9.2203E-01     8.4503E-01
                   3  1.4289E-01     9.2203E-01     8.4503E-01
                   4  1.4289E-01     9.2203E-01     8.4503E-01
                   5  1.4289E-01     9.2203E-01     8.4503E-01
                   6  1.4289E-01     9.2203E-01     8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     16
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        7
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.3472E-01     9.2057E-01     8.5366E-01
                   2  1.3472E-01     9.2057E-01     8.5366E-01
                   3  1.3472E-01     9.2057E-01     8.5366E-01
                   4  1.3472E-01     9.2057E-01     8.5366E-01
                   5  1.3472E-01     9.2057E-01     8.5366E-01
                   6  1.3472E-01     9.2057E-01     8.5366E-01
                   7  1.3472E-01     9.2057E-01     8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     18
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        8
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2780E-01     9.2052E-01     8.6116E-01
                   2  1.2780E-01     9.2052E-01     8.6116E-01
                   3  1.2780E-01     9.2052E-01     8.6116E-01
                   4  1.2780E-01     9.2052E-01     8.6116E-01
                   5  1.2780E-01     9.2052E-01     8.6116E-01
                   6  1.2780E-01     9.2052E-01     8.6116E-01
                   7  1.2780E-01     9.2052E-01     8.6116E-01
                   8  1.2780E-01     9.2052E-01     8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     20
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        9
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2185E-01     9.1982E-01     8.6752E-01
                   2  1.2185E-01     9.1982E-01     8.6752E-01
                   3  1.2185E-01     9.1982E-01     8.6752E-01
                   4  1.2185E-01     9.1982E-01     8.6752E-01
                   5  1.2185E-01     9.1982E-01     8.6752E-01
                   6  1.2185E-01     9.1982E-01     8.6752E-01
                   7  1.2185E-01     9.1982E-01     8.6752E-01
                   8  1.2185E-01     9.1982E-01     8.6752E-01
                   9  1.2185E-01     9.1982E-01     8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.28648 MB (temporary)
             Pre-Poststep:   0.08926 MB (temporary)

PDAF                       PDAF Memory overview
 model PE exited: mype            1
 model PE exited: mype            2
 model PE exited: mype            3
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.02022 MB (persistent)
PDAF           ensemble array:   0.62943 MB (persistent)
PDAF            analysis step:   0.32999 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.002 s
PDAF                  Time of forecasts:      0.003 s
PDAF              Time for assimilation:      0.009 s
PDAF                Time of prepoststep:      0.005 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.017 s
                   total run time:      0.020 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs

               Use OpenMP with   2 threads



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     3              2      1      2      1       F
     2              2      0      1      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         4
  PARSER: subtype=         1
  PARSER: dim_lag=        10
  PARSER: filename= output_par_smoother_etkf1.dat
                     Filter: ETKF
      -- Variant following Hunt et al. (2007)
              ensemble size:   50
               smoother lag:   10
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++     Ensemble Transform Kalman Filter (ETKF)     +++
PDAF    +++                                                 +++
PDAF    +++   Bishop et al., Mon. Wea. Rev. 129 (2001) 420  +++
PDAF    +++    A symmetric square root is used following    +++
PDAF    +++      Hunt et al. Physica D 230 (2007) 112       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ETKF configuration
PDAF         filter sub-type = 1
PDAF            --> ETKF following Hunt et al. (2007)
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> Apply smoother up to lag:    10
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      2
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      4
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        1
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  2.3333E-01     9.4184E-01     7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      6
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        2
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  2.0207E-01     9.3827E-01     7.8463E-01
                   2  2.0207E-01     9.3827E-01     7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      8
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        3
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.8074E-01     9.2853E-01     8.0535E-01
                   2  1.8074E-01     9.2853E-01     8.0535E-01
                   3  1.8074E-01     9.2853E-01     8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     10
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.6499E-01     9.2803E-01     8.2221E-01
                   2  1.6499E-01     9.2803E-01     8.2221E-01
                   3  1.6499E-01     9.2803E-01     8.2221E-01
                   4  1.6499E-01     9.2803E-01     8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector       150
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     12
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        5
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.5275E-01     9.2691E-01     8.3520E-01
                   2  1.5275E-01     9.2691E-01     8.3520E-01
                   3  1.5275E-01     9.2691E-01     8.3520E-01
                   4  1.5275E-01     9.2691E-01     8.3520E-01
                   5  1.5275E-01     9.2691E-01     8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     14
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.4289E-01     9.2203E-01     8.4503E-01
                   2  1.4289E-01     9.2203E-01     8.4503E-01
                   3  1.4289E-01     9.2203E-01     8.4503E-01
                   4  1.4289E-01     9.2203E-01     8.4503E-01
                   5  1.4289E-01     9.2203E-01     8.4503E-01
                   6  1.4289E-01     9.2203E-01     8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     16
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        7
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.3472E-01     9.2057E-01     8.5366E-01
                   2  1.3472E-01     9.2057E-01     8.5366E-01
                   3  1.3472E-01     9.2057E-01     8.5366E-01
                   4  1.3472E-01     9.2057E-01     8.5366E-01
                   5  1.3472E-01     9.2057E-01     8.5366E-01
                   6  1.3472E-01     9.2057E-01     8.5366E-01
                   7  1.3472E-01     9.2057E-01     8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     18
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        8
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2780E-01     9.2052E-01     8.6116E-01
                   2  1.2780E-01     9.2052E-01     8.6116E-01
                   3  1.2780E-01     9.2052E-01     8.6116E-01
                   4  1.2780E-01     9.2052E-01     8.6116E-01
                   5  1.2780E-01     9.2052E-01     8.6116E-01
                   6  1.2780E-01     9.2052E-01     8.6116E-01
                   7  1.2780E-01     9.2052E-01     8.6116E-01
                   8  1.2780E-01     9.2052E-01     8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     20
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        9
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2185E-01     9.1982E-01     8.6752E-01
                   2  1.2185E-01     9.1982E-01     8.6752E-01
                   3  1.2185E-01     9.1982E-01     8.6752E-01
                   4  1.2185E-01     9.1982E-01     8.6752E-01
                   5  1.2185E-01     9.1982E-01     8.6752E-01
                   6  1.2185E-01     9.1982E-01     8.6752E-01
                   7  1.2185E-01     9.1982E-01     8.6752E-01
                   8  1.2185E-01     9.1982E-01     8.6752E-01
                   9  1.2185E-01     9.1982E-01     8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
 model PE exited: mype            1
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.28648 MB (temporary)
             Pre-Poststep:   0.08926 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.02022 MB (persistent)
 model PE exited: mype            2
PDAF           ensemble array:   0.62943 MB (persistent)
PDAF            analysis step:   0.32999 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.002 s
PDAF                  Time of forecasts:      0.004 s
PDAF              Time for assimilation:      0.011 s
PDAF                Time of prepoststep:      0.002 s
 model PE exited: mype            3

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.018 s
                   total run time:      0.021 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs

               Use OpenMP with   2 threads



  PARSER: tasks=         1

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2       2      1      2      3      0       T
     3       3      1      3      4      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  4 PEs
     task   1 PE(model)   0 dim_local(state):    75
     task   1 PE(model)   1 dim_local(state):    75
     task   1 PE(model)   2 dim_local(state):    75
     task   1 PE(model)   3 dim_local(state):    75

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         4
  PARSER: subtype=         2
  PARSER: dim_lag=        10
  PARSER: filename= output_par_smoother_etkf2.dat
                     Filter: ETKF
              ensemble size:   50
               smoother lag:   10
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++     Ensemble Transform Kalman Filter (ETKF)     +++
PDAF    +++                                                 +++
PDAF    +++   Bishop et al., Mon. Wea. Rev. 129 (2001) 420  +++
PDAF    +++    A symmetric square root is used following    +++
PDAF    +++      Hunt et al. Physica D 230 (2007) 112       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ETKF configuration
PDAF         filter sub-type = 2
PDAF            --> ETKF with fixed error-space basis
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> Apply smoother up to lag:    10
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      4
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     4
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega
PDAF     --- PE-domain      1 dimension of observation vector        75

PDAF: Initialization completed
PDAF     --- PE-domain      2 dimension of observation vector        75

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF     --- PE-domain      3 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      2
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF     --- PE-domain      2 dimension of observation vector        75
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      4
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        1
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  2.3333E-01     9.4184E-01     7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      6
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        2
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  2.0207E-01     9.3827E-01     7.8463E-01
                   2  2.0207E-01     9.3827E-01     7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      8
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        3
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.8074E-01     9.2853E-01     8.0535E-01
                   2  1.8074E-01     9.2853E-01     8.0535E-01
                   3  1.8074E-01     9.2853E-01     8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     10
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.6499E-01     9.2803E-01     8.2221E-01
                   2  1.6499E-01     9.2803E-01     8.2221E-01
                   3  1.6499E-01     9.2803E-01     8.2221E-01
                   4  1.6499E-01     9.2803E-01     8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     12
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        5
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.5275E-01     9.2691E-01     8.3520E-01
                   2  1.5275E-01     9.2691E-01     8.3520E-01
                   3  1.5275E-01     9.2691E-01     8.3520E-01
                   4  1.5275E-01     9.2691E-01     8.3520E-01
                   5  1.5275E-01     9.2691E-01     8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     14
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.4289E-01     9.2203E-01     8.4503E-01
                   2  1.4289E-01     9.2203E-01     8.4503E-01
                   3  1.4289E-01     9.2203E-01     8.4503E-01
                   4  1.4289E-01     9.2203E-01     8.4503E-01
                   5  1.4289E-01     9.2203E-01     8.4503E-01
                   6  1.4289E-01     9.2203E-01     8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     16
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        7
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.3472E-01     9.2057E-01     8.5366E-01
                   2  1.3472E-01     9.2057E-01     8.5366E-01
                   3  1.3472E-01     9.2057E-01     8.5366E-01
                   4  1.3472E-01     9.2057E-01     8.5366E-01
                   5  1.3472E-01     9.2057E-01     8.5366E-01
                   6  1.3472E-01     9.2057E-01     8.5366E-01
                   7  1.3472E-01     9.2057E-01     8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     18
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        8
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2780E-01     9.2052E-01     8.6116E-01
                   2  1.2780E-01     9.2052E-01     8.6116E-01
                   3  1.2780E-01     9.2052E-01     8.6116E-01
                   4  1.2780E-01     9.2052E-01     8.6116E-01
                   5  1.2780E-01     9.2052E-01     8.6116E-01
                   6  1.2780E-01     9.2052E-01     8.6116E-01
                   7  1.2780E-01     9.2052E-01     8.6116E-01
                   8  1.2780E-01     9.2052E-01     8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     20
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        9
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2185E-01     9.1982E-01     8.6752E-01
                   2  1.2185E-01     9.1982E-01     8.6752E-01
                   3  1.2185E-01     9.1982E-01     8.6752E-01
                   4  1.2185E-01     9.1982E-01     8.6752E-01
                   5  1.2185E-01     9.1982E-01     8.6752E-01
                   6  1.2185E-01     9.1982E-01     8.6752E-01
                   7  1.2185E-01     9.1982E-01     8.6752E-01
                   8  1.2185E-01     9.1982E-01     8.6752E-01
                   9  1.2185E-01     9.1982E-01     8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            1
 model PE exited: mype            2
 model PE exited: mype            3
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00059 MB (persistent)
            ensemble init:   0.25787 MB (temporary)
             Pre-Poststep:   0.06981 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.01965 MB (persistent)
PDAF           ensemble array:   0.31471 MB (persistent)
PDAF            analysis step:   0.26991 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.002 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time for assimilation:      0.010 s
PDAF                Time of prepoststep:      0.007 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.018 s
                   total run time:      0.021 s

 PDAF test suite: END
--------------------------------------------------------
Run LETKF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs

               Use OpenMP with   2 threads



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2              2      0      1      1       F
     3              2      1      2      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         5
  PARSER: subtype=         0
  PARSER: dim_lag=        10
  PARSER: filename= output_par_smoother_letkf0.dat
                     Filter: LETKF
      -- Variant using T-matrix
              ensemble size:   50
               smoother lag:   10
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Ensemble Transform Kalman Filter (LETKF)  +++
PDAF    +++                                                  +++
PDAF    +++            Domain-localized LETKF by             +++
PDAF    +++      Hunt et al., Physica D 230 (2007) 112       +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LETKF configuration
PDAF          filter sub-type = 0
PDAF            --> LETKF using T-matrix
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> Apply smoother up to lag:    10
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF      --- PE-domain:     1 number of analysis domains:       150
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        1
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  2.3333E-01     9.4184E-01     7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        2
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  2.0207E-01     9.3827E-01     7.8463E-01
                   2  2.0207E-01     9.3827E-01     7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        3
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.8074E-01     9.2853E-01     8.0535E-01
                   2  1.8074E-01     9.2853E-01     8.0535E-01
                   3  1.8074E-01     9.2853E-01     8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        4
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.6499E-01     9.2803E-01     8.2221E-01
                   2  1.6499E-01     9.2803E-01     8.2221E-01
                   3  1.6499E-01     9.2803E-01     8.2221E-01
                   4  1.6499E-01     9.2803E-01     8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        5
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.5275E-01     9.2691E-01     8.3520E-01
                   2  1.5275E-01     9.2691E-01     8.3520E-01
                   3  1.5275E-01     9.2691E-01     8.3520E-01
                   4  1.5275E-01     9.2691E-01     8.3520E-01
                   5  1.5275E-01     9.2691E-01     8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        6
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.4289E-01     9.2203E-01     8.4503E-01
                   2  1.4289E-01     9.2203E-01     8.4503E-01
                   3  1.4289E-01     9.2203E-01     8.4503E-01
                   4  1.4289E-01     9.2203E-01     8.4503E-01
                   5  1.4289E-01     9.2203E-01     8.4503E-01
                   6  1.4289E-01     9.2203E-01     8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        7
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.3472E-01     9.2057E-01     8.5366E-01
                   2  1.3472E-01     9.2057E-01     8.5366E-01
                   3  1.3472E-01     9.2057E-01     8.5366E-01
                   4  1.3472E-01     9.2057E-01     8.5366E-01
                   5  1.3472E-01     9.2057E-01     8.5366E-01
                   6  1.3472E-01     9.2057E-01     8.5366E-01
                   7  1.3472E-01     9.2057E-01     8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF      --- PE-domain:     1 number of analysis domains:       150
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        8
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2780E-01     9.2052E-01     8.6116E-01
                   2  1.2780E-01     9.2052E-01     8.6116E-01
                   3  1.2780E-01     9.2052E-01     8.6116E-01
                   4  1.2780E-01     9.2052E-01     8.6116E-01
                   5  1.2780E-01     9.2052E-01     8.6116E-01
                   6  1.2780E-01     9.2052E-01     8.6116E-01
                   7  1.2780E-01     9.2052E-01     8.6116E-01
                   8  1.2780E-01     9.2052E-01     8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF      --- PE-domain:     1 number of analysis domains:       150
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        9
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2185E-01     9.1982E-01     8.6752E-01
                   2  1.2185E-01     9.1982E-01     8.6752E-01
                   3  1.2185E-01     9.1982E-01     8.6752E-01
                   4  1.2185E-01     9.1982E-01     8.6752E-01
                   5  1.2185E-01     9.1982E-01     8.6752E-01
                   6  1.2185E-01     9.1982E-01     8.6752E-01
                   7  1.2185E-01     9.1982E-01     8.6752E-01
                   8  1.2185E-01     9.1982E-01     8.6752E-01
                   9  1.2185E-01     9.1982E-01     8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0
 model PE exited: mype            1
 model PE exited: mype            3

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.28648 MB (temporary)
             Pre-Poststep:   0.08926 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.02136 MB (persistent)
PDAF           ensemble array:   0.60081 MB (persistent)
 model PE exited: mype            2
PDAF            analysis step:   0.37246 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.001 s
PDAF                  Time of forecasts:      0.003 s
PDAF        Time for analysis/transform:      0.224 s
PDAF                  global preparations:      0.004 s
PDAF                  local analysis loop:      0.220 s
PDAF                Time of prepoststep:      0.004 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.001 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.232 s
                   total run time:      0.235 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs

               Use OpenMP with   2 threads



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2              2      0      1      1       F
     3              2      1      2      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         5
  PARSER: subtype=         1
  PARSER: dim_lag=        10
  PARSER: filename= output_par_smoother_letkf1.dat
                     Filter: LETKF
      -- Variant following Hunt et al. (2007)
              ensemble size:   50
               smoother lag:   10
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Ensemble Transform Kalman Filter (LETKF)  +++
PDAF    +++                                                  +++
PDAF    +++            Domain-localized LETKF by             +++
PDAF    +++      Hunt et al., Physica D 230 (2007) 112       +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LETKF configuration
PDAF          filter sub-type = 1
PDAF            --> LETKF following Hunt et al. (2007)
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> Apply smoother up to lag:    10
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF      --- PE-domain:     1 number of analysis domains:       150
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF      --- PE-domain:     1 number of analysis domains:       150
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        1
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  2.3333E-01     4.8550E+00     9.5194E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        2
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  2.0207E-01     6.8087E+00     9.7032E-01
                   2  2.0207E-01     1.2682E+01     9.8407E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        3
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.8074E-01     8.7749E+00     9.7940E-01
                   2  1.8074E-01     1.8591E+01     9.9028E-01
                   3  1.8074E-01     2.8342E+01     9.9362E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        4
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.6499E-01     1.0753E+01     9.8466E-01
                   2  1.6499E-01     2.4530E+01     9.9327E-01
                   3  1.6499E-01     4.2167E+01     9.9609E-01
                   4  1.6499E-01     5.9670E+01     9.9723E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        5
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.5275E-01     1.2746E+01     9.8802E-01
                   2  1.5275E-01     3.0495E+01     9.9499E-01
                   3  1.5275E-01     5.6054E+01     9.9727E-01
                   4  1.5275E-01     8.9328E+01     9.9829E-01
                   5  1.5275E-01     1.2233E+02     9.9875E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        6
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.4289E-01     1.4738E+01     9.9030E-01
                   2  1.4289E-01     3.6473E+01     9.9608E-01
                   3  1.4289E-01     6.9976E+01     9.9796E-01
                   4  1.4289E-01     1.1909E+02     9.9880E-01
                   5  1.4289E-01     1.8364E+02     9.9922E-01
                   6  1.4289E-01     2.4765E+02     9.9942E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        7
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.3472E-01     1.6729E+01     9.9195E-01
                   2  1.3472E-01     4.2467E+01     9.9683E-01
                   3  1.3472E-01     8.3941E+01     9.9840E-01
                   4  1.3472E-01     1.4895E+02     9.9910E-01
                   5  1.3472E-01     2.4518E+02     9.9945E-01
                   6  1.3472E-01     3.7228E+02     9.9964E-01
                   7  1.3472E-01     4.9830E+02     9.9973E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        8
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2780E-01     1.8726E+01     9.9318E-01
                   2  1.2780E-01     4.8448E+01     9.9736E-01
                   3  1.2780E-01     9.7925E+01     9.9869E-01
                   4  1.2780E-01     1.7887E+02     9.9929E-01
                   5  1.2780E-01     3.0689E+02     9.9958E-01
                   6  1.2780E-01     4.9736E+02     9.9974E-01
                   7  1.2780E-01     7.4955E+02     9.9983E-01
                   8  1.2780E-01     9.9959E+02     9.9987E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        9
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2185E-01     2.0721E+01     9.9412E-01
                   2  1.2185E-01     5.4443E+01     9.9776E-01
                   3  1.2185E-01     1.1189E+02     9.9891E-01
                   4  1.2185E-01     2.0884E+02     9.9942E-01
                   5  1.2185E-01     3.6874E+02     9.9967E-01
                   6  1.2185E-01     6.2277E+02     9.9980E-01
                   7  1.2185E-01     1.0017E+03     9.9988E-01
                   8  1.2185E-01     1.5041E+03     9.9992E-01
                   9  1.2185E-01     2.0022E+03     9.9994E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
 model PE exited: mype            1
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.28648 MB (temporary)
             Pre-Poststep:   0.08926 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
 model PE exited: mype            2
 model PE exited: mype            3
PDAF              state and A:   0.02136 MB (persistent)
PDAF           ensemble array:   0.60081 MB (persistent)
PDAF            analysis step:   0.37208 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.002 s
PDAF                  Time of forecasts:      0.002 s
PDAF        Time for analysis/transform:      0.216 s
PDAF                  global preparations:      0.002 s
PDAF                  local analysis loop:      0.214 s
PDAF                Time of prepoststep:      0.005 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.001 s
                  initialize filter:      0.002 s
                       assimilation:      0.225 s
                   total run time:      0.228 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs

               Use OpenMP with   2 threads



  PARSER: tasks=         1

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     3       3      1      3      4      0       T
     2       2      1      2      3      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  4 PEs
     task   1 PE(model)   0 dim_local(state):    75
     task   1 PE(model)   1 dim_local(state):    75
     task   1 PE(model)   2 dim_local(state):    75
     task   1 PE(model)   3 dim_local(state):    75

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         5
  PARSER: subtype=         2
  PARSER: dim_lag=        10
  PARSER: filename= output_par_smoother_letkf2.dat
                     Filter: LETKF
              ensemble size:   50
               smoother lag:   10
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Ensemble Transform Kalman Filter (LETKF)  +++
PDAF    +++                                                  +++
PDAF    +++            Domain-localized LETKF by             +++
PDAF    +++      Hunt et al., Physica D 230 (2007) 112       +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LETKF configuration
PDAF          filter sub-type = 2
PDAF            --> LETKF with fixed error-space basis
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> Apply smoother up to lag:    10
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      4
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     4
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-Domain:     2 dimension of PE-local full obs. vector       300
PDAF      --- PE-domain:     3 number of analysis domains:        75
PDAF      --- PE-Domain:     3 dimension of PE-local full obs. vector       300

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-Domain:     2 dimension of PE-local full obs. vector       300
PDAF      --- PE-domain:     3 number of analysis domains:        75
PDAF      --- PE-Domain:     3 dimension of PE-local full obs. vector       300
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        1
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  2.3333E-01     9.4184E-01     7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-Domain:     2 dimension of PE-local full obs. vector       300
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF      --- PE-domain:     3 number of analysis domains:        75
PDAF      --- PE-Domain:     3 dimension of PE-local full obs. vector       300
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        2
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  2.0207E-01     9.3827E-01     7.8463E-01
                   2  2.0207E-01     9.3827E-01     7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF      --- PE-domain:     3 number of analysis domains:        75
PDAF      --- PE-Domain:     3 dimension of PE-local full obs. vector       300
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-Domain:     2 dimension of PE-local full obs. vector       300
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        3
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.8074E-01     9.2853E-01     8.0535E-01
                   2  1.8074E-01     9.2853E-01     8.0535E-01
                   3  1.8074E-01     9.2853E-01     8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-Domain:     2 dimension of PE-local full obs. vector       300
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF      --- PE-domain:     3 number of analysis domains:        75
PDAF      --- PE-Domain:     3 dimension of PE-local full obs. vector       300
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     Perform smoothing up to lag        4
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.6499E-01     9.2803E-01     8.2221E-01
                   2  1.6499E-01     9.2803E-01     8.2221E-01
                   3  1.6499E-01     9.2803E-01     8.2221E-01
                   4  1.6499E-01     9.2803E-01     8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF      --- PE-Domain:     2 dimension of PE-local full obs. vector       300
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF      --- PE-domain:     3 number of analysis domains:        75
PDAF      --- PE-Domain:     3 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        5
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.5275E-01     9.2691E-01     8.3520E-01
                   2  1.5275E-01     9.2691E-01     8.3520E-01
                   3  1.5275E-01     9.2691E-01     8.3520E-01
                   4  1.5275E-01     9.2691E-01     8.3520E-01
                   5  1.5275E-01     9.2691E-01     8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-Domain:     2 dimension of PE-local full obs. vector       300
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF      --- PE-domain:     3 number of analysis domains:        75
PDAF      --- PE-Domain:     3 dimension of PE-local full obs. vector       300
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        6
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.4289E-01     9.2203E-01     8.4503E-01
                   2  1.4289E-01     9.2203E-01     8.4503E-01
                   3  1.4289E-01     9.2203E-01     8.4503E-01
                   4  1.4289E-01     9.2203E-01     8.4503E-01
                   5  1.4289E-01     9.2203E-01     8.4503E-01
                   6  1.4289E-01     9.2203E-01     8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF      --- PE-Domain:     2 dimension of PE-local full obs. vector       300
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF      --- PE-domain:     3 number of analysis domains:        75
PDAF      --- PE-Domain:     3 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        7
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.3472E-01     9.2057E-01     8.5366E-01
                   2  1.3472E-01     9.2057E-01     8.5366E-01
                   3  1.3472E-01     9.2057E-01     8.5366E-01
                   4  1.3472E-01     9.2057E-01     8.5366E-01
                   5  1.3472E-01     9.2057E-01     8.5366E-01
                   6  1.3472E-01     9.2057E-01     8.5366E-01
                   7  1.3472E-01     9.2057E-01     8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF      --- PE-Domain:     2 dimension of PE-local full obs. vector       300
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF      --- PE-domain:     3 number of analysis domains:        75
PDAF      --- PE-Domain:     3 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        8
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2780E-01     9.2052E-01     8.6116E-01
                   2  1.2780E-01     9.2052E-01     8.6116E-01
                   3  1.2780E-01     9.2052E-01     8.6116E-01
                   4  1.2780E-01     9.2052E-01     8.6116E-01
                   5  1.2780E-01     9.2052E-01     8.6116E-01
                   6  1.2780E-01     9.2052E-01     8.6116E-01
                   7  1.2780E-01     9.2052E-01     8.6116E-01
                   8  1.2780E-01     9.2052E-01     8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-Domain:     2 dimension of PE-local full obs. vector       300
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-Domain:     1 dimension of PE-local full obs. vector       300
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF      --- PE-domain:     3 number of analysis domains:        75
PDAF      --- PE-Domain:     3 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        9
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2185E-01     9.1982E-01     8.6752E-01
                   2  1.2185E-01     9.1982E-01     8.6752E-01
                   3  1.2185E-01     9.1982E-01     8.6752E-01
                   4  1.2185E-01     9.1982E-01     8.6752E-01
                   5  1.2185E-01     9.1982E-01     8.6752E-01
                   6  1.2185E-01     9.1982E-01     8.6752E-01
                   7  1.2185E-01     9.1982E-01     8.6752E-01
                   8  1.2185E-01     9.1982E-01     8.6752E-01
                   9  1.2185E-01     9.1982E-01     8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            1
 model PE exited: mype            2
 model PE exited: mype            3
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00059 MB (persistent)
            ensemble init:   0.25787 MB (temporary)
             Pre-Poststep:   0.06981 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.02022 MB (persistent)
PDAF           ensemble array:   0.31471 MB (persistent)
PDAF            analysis step:   0.37246 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.002 s
PDAF                  Time of forecasts:      0.000 s
PDAF        Time for analysis/transform:      0.215 s
PDAF                  global preparations:      0.028 s
PDAF                  local analysis loop:      0.187 s
PDAF                Time of prepoststep:      0.005 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.001 s
                  initialize filter:      0.002 s
                       assimilation:      0.224 s
                   total run time:      0.228 s

 PDAF test suite: END
--------------------------------------------------------
Run ESTKF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs

               Use OpenMP with   2 threads



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     3              2      1      2      1       F
     2              2      0      1      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         6
  PARSER: subtype=         0
  PARSER: dim_lag=        10
  PARSER: filename= output_par_smoother_estkf0.dat
                     Filter: ESTKF
      -- Standard mode
              ensemble size:   50
               smoother lag:   10
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++ Error Subspace Transform Kalman Filter (ESTKF) +++
PDAF    +++                                                +++
PDAF    +++  Nerger et al., Mon. Wea. Rev. 140 (2012) 2335 +++
PDAF    +++           doi:10.1175/MWR-D-11-00102.1         +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ESTKF configuration
PDAF          filter sub-type = 0
PDAF            --> Standard ESTKF with ensemble integration
PDAF            --> Deterministic ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> Apply smoother up to lag:    10
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      2
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      4
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Perform smoothing up to lag        1
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  2.3333E-01     9.4184E-01     7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector       150
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      6
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Perform smoothing up to lag        2
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  2.0207E-01     9.3827E-01     7.8463E-01
                   2  2.0207E-01     9.3827E-01     7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      8
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Perform smoothing up to lag        3
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.8074E-01     9.2853E-01     8.0535E-01
                   2  1.8074E-01     9.2853E-01     8.0535E-01
                   3  1.8074E-01     9.2853E-01     8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     10
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Perform smoothing up to lag        4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.6499E-01     9.2803E-01     8.2221E-01
                   2  1.6499E-01     9.2803E-01     8.2221E-01
                   3  1.6499E-01     9.2803E-01     8.2221E-01
                   4  1.6499E-01     9.2803E-01     8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     12
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Perform smoothing up to lag        5
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.5275E-01     9.2691E-01     8.3520E-01
                   2  1.5275E-01     9.2691E-01     8.3520E-01
                   3  1.5275E-01     9.2691E-01     8.3520E-01
                   4  1.5275E-01     9.2691E-01     8.3520E-01
                   5  1.5275E-01     9.2691E-01     8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     14
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Perform smoothing up to lag        6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.4289E-01     9.2203E-01     8.4503E-01
                   2  1.4289E-01     9.2203E-01     8.4503E-01
                   3  1.4289E-01     9.2203E-01     8.4503E-01
                   4  1.4289E-01     9.2203E-01     8.4503E-01
                   5  1.4289E-01     9.2203E-01     8.4503E-01
                   6  1.4289E-01     9.2203E-01     8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector       150
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     16
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Perform smoothing up to lag        7
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.3472E-01     9.2057E-01     8.5366E-01
                   2  1.3472E-01     9.2057E-01     8.5366E-01
                   3  1.3472E-01     9.2057E-01     8.5366E-01
                   4  1.3472E-01     9.2057E-01     8.5366E-01
                   5  1.3472E-01     9.2057E-01     8.5366E-01
                   6  1.3472E-01     9.2057E-01     8.5366E-01
                   7  1.3472E-01     9.2057E-01     8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     18
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Perform smoothing up to lag        8
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2780E-01     9.2052E-01     8.6116E-01
                   2  1.2780E-01     9.2052E-01     8.6116E-01
                   3  1.2780E-01     9.2052E-01     8.6116E-01
                   4  1.2780E-01     9.2052E-01     8.6116E-01
                   5  1.2780E-01     9.2052E-01     8.6116E-01
                   6  1.2780E-01     9.2052E-01     8.6116E-01
                   7  1.2780E-01     9.2052E-01     8.6116E-01
                   8  1.2780E-01     9.2052E-01     8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector       150
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     20
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Perform smoothing up to lag        9
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2185E-01     9.1982E-01     8.6752E-01
                   2  1.2185E-01     9.1982E-01     8.6752E-01
                   3  1.2185E-01     9.1982E-01     8.6752E-01
                   4  1.2185E-01     9.1982E-01     8.6752E-01
                   5  1.2185E-01     9.1982E-01     8.6752E-01
                   6  1.2185E-01     9.1982E-01     8.6752E-01
                   7  1.2185E-01     9.1982E-01     8.6752E-01
                   8  1.2185E-01     9.1982E-01     8.6752E-01
                   9  1.2185E-01     9.1982E-01     8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            1
 model PE exited: mype            3
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.28648 MB (temporary)
             Pre-Poststep:   0.08926 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.01946 MB (persistent)
PDAF           ensemble array:   0.62943 MB (persistent)
PDAF            analysis step:   0.40244 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.001 s
PDAF                  Time of forecasts:      0.004 s
PDAF              Time for assimilation:      0.011 s
PDAF                Time of prepoststep:      0.007 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.024 s
                   total run time:      0.026 s

 PDAF test suite: END
 model PE exited: mype            2

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs

               Use OpenMP with   2 threads



  PARSER: tasks=         1

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2       2      1      2      3      0       T
     3       3      1      3      4      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  4 PEs
     task   1 PE(model)   0 dim_local(state):    75
     task   1 PE(model)   1 dim_local(state):    75
     task   1 PE(model)   2 dim_local(state):    75
     task   1 PE(model)   3 dim_local(state):    75

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         6
  PARSER: subtype=         2
  PARSER: dim_lag=        10
  PARSER: filename= output_par_smoother_estkf2.dat
                     Filter: ESTKF
              ensemble size:   50
               smoother lag:   10
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++ Error Subspace Transform Kalman Filter (ESTKF) +++
PDAF    +++                                                +++
PDAF    +++  Nerger et al., Mon. Wea. Rev. 140 (2012) 2335 +++
PDAF    +++           doi:10.1175/MWR-D-11-00102.1         +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ESTKF configuration
PDAF          filter sub-type = 2
PDAF            --> ESTKF with fixed error-space basis
PDAF            --> Deterministic ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> Apply smoother up to lag:    10
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      4
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     4
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega
PDAF     --- PE-domain      1 dimension of observation vector        75

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      2 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      2
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      4
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Perform smoothing up to lag        1
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  2.3333E-01     9.4184E-01     7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector        75
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      6
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Perform smoothing up to lag        2
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  2.0207E-01     9.3827E-01     7.8463E-01
                   2  2.0207E-01     9.3827E-01     7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector        75
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      8
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Perform smoothing up to lag        3
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.8074E-01     9.2853E-01     8.0535E-01
                   2  1.8074E-01     9.2853E-01     8.0535E-01
                   3  1.8074E-01     9.2853E-01     8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     10
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Perform smoothing up to lag        4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.6499E-01     9.2803E-01     8.2221E-01
                   2  1.6499E-01     9.2803E-01     8.2221E-01
                   3  1.6499E-01     9.2803E-01     8.2221E-01
                   4  1.6499E-01     9.2803E-01     8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     12
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Perform smoothing up to lag        5
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.5275E-01     9.2691E-01     8.3520E-01
                   2  1.5275E-01     9.2691E-01     8.3520E-01
                   3  1.5275E-01     9.2691E-01     8.3520E-01
                   4  1.5275E-01     9.2691E-01     8.3520E-01
                   5  1.5275E-01     9.2691E-01     8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     14
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Perform smoothing up to lag        6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.4289E-01     9.2203E-01     8.4503E-01
                   2  1.4289E-01     9.2203E-01     8.4503E-01
                   3  1.4289E-01     9.2203E-01     8.4503E-01
                   4  1.4289E-01     9.2203E-01     8.4503E-01
                   5  1.4289E-01     9.2203E-01     8.4503E-01
                   6  1.4289E-01     9.2203E-01     8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector        75
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     16
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Perform smoothing up to lag        7
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.3472E-01     9.2057E-01     8.5366E-01
                   2  1.3472E-01     9.2057E-01     8.5366E-01
                   3  1.3472E-01     9.2057E-01     8.5366E-01
                   4  1.3472E-01     9.2057E-01     8.5366E-01
                   5  1.3472E-01     9.2057E-01     8.5366E-01
                   6  1.3472E-01     9.2057E-01     8.5366E-01
                   7  1.3472E-01     9.2057E-01     8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     18
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Perform smoothing up to lag        8
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2780E-01     9.2052E-01     8.6116E-01
                   2  1.2780E-01     9.2052E-01     8.6116E-01
                   3  1.2780E-01     9.2052E-01     8.6116E-01
                   4  1.2780E-01     9.2052E-01     8.6116E-01
                   5  1.2780E-01     9.2052E-01     8.6116E-01
                   6  1.2780E-01     9.2052E-01     8.6116E-01
                   7  1.2780E-01     9.2052E-01     8.6116E-01
                   8  1.2780E-01     9.2052E-01     8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     20
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Perform smoothing up to lag        9
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2185E-01     9.1982E-01     8.6752E-01
                   2  1.2185E-01     9.1982E-01     8.6752E-01
                   3  1.2185E-01     9.1982E-01     8.6752E-01
                   4  1.2185E-01     9.1982E-01     8.6752E-01
                   5  1.2185E-01     9.1982E-01     8.6752E-01
                   6  1.2185E-01     9.1982E-01     8.6752E-01
                   7  1.2185E-01     9.1982E-01     8.6752E-01
                   8  1.2185E-01     9.1982E-01     8.6752E-01
                   9  1.2185E-01     9.1982E-01     8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            1
 model PE exited: mype            2
 model PE exited: mype            3
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00059 MB (persistent)
            ensemble init:   0.25787 MB (temporary)
             Pre-Poststep:   0.06981 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.01889 MB (persistent)
PDAF           ensemble array:   0.31471 MB (persistent)
PDAF            analysis step:   0.34293 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.001 s
PDAF                  Time of forecasts:      0.001 s
PDAF              Time for assimilation:      0.012 s
PDAF                Time of prepoststep:      0.010 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.023 s
                   total run time:      0.025 s

 PDAF test suite: END
--------------------------------------------------------
Run LESTKF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs

               Use OpenMP with   2 threads



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2              2      0      1      1       F
     3              2      1      2      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         7
  PARSER: subtype=         0
  PARSER: dim_lag=        10
  PARSER: filename= output_par_smoother_lestkf0.dat
                     Filter: LESTKF
      -- Standard mode
              ensemble size:   50
               smoother lag:   10
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Error Subspace Transform Kalman Filter   +++
PDAF    +++                    (LESTKF)                     +++
PDAF    +++                                                 +++
PDAF    +++ Domain-localized implementation of the ESTKF by +++
PDAF    +++  Nerger et al., Mon. Wea. Rev. 140 (2012) 2335  +++
PDAF    +++           doi:10.1175/MWR-D-11-00102.1          +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LESTKF configuration
PDAF          filter sub-type = 0
PDAF            --> Standard LESTKF
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> Apply smoother up to lag:    10
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF       2   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
PDAF     --- Use OpenMP parallelization with     2 threads
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     --- PE-Domain:     1 dimension of PE-local full obs. vector       300
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        1
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  2.3333E-01     9.4184E-01     7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF       6   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        2
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  2.0207E-01     9.3827E-01     7.8463E-01
                   2  2.0207E-01     9.3827E-01     7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     --- PE-Domain:     1 dimension of PE-local full obs. vector       300
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        3
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.8074E-01     9.2853E-01     8.0535E-01
                   2  1.8074E-01     9.2853E-01     8.0535E-01
                   3  1.8074E-01     9.2853E-01     8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF     --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      10   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        4
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.6499E-01     9.2803E-01     8.2221E-01
                   2  1.6499E-01     9.2803E-01     8.2221E-01
                   3  1.6499E-01     9.2803E-01     8.2221E-01
                   4  1.6499E-01     9.2803E-01     8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      12   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        5
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.5275E-01     9.2691E-01     8.3520E-01
                   2  1.5275E-01     9.2691E-01     8.3520E-01
                   3  1.5275E-01     9.2691E-01     8.3520E-01
                   4  1.5275E-01     9.2691E-01     8.3520E-01
                   5  1.5275E-01     9.2691E-01     8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      14   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        6
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.4289E-01     9.2203E-01     8.4503E-01
                   2  1.4289E-01     9.2203E-01     8.4503E-01
                   3  1.4289E-01     9.2203E-01     8.4503E-01
                   4  1.4289E-01     9.2203E-01     8.4503E-01
                   5  1.4289E-01     9.2203E-01     8.4503E-01
                   6  1.4289E-01     9.2203E-01     8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      16   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        7
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.3472E-01     9.2057E-01     8.5366E-01
                   2  1.3472E-01     9.2057E-01     8.5366E-01
                   3  1.3472E-01     9.2057E-01     8.5366E-01
                   4  1.3472E-01     9.2057E-01     8.5366E-01
                   5  1.3472E-01     9.2057E-01     8.5366E-01
                   6  1.3472E-01     9.2057E-01     8.5366E-01
                   7  1.3472E-01     9.2057E-01     8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      18   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        8
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2780E-01     9.2052E-01     8.6116E-01
                   2  1.2780E-01     9.2052E-01     8.6116E-01
                   3  1.2780E-01     9.2052E-01     8.6116E-01
                   4  1.2780E-01     9.2052E-01     8.6116E-01
                   5  1.2780E-01     9.2052E-01     8.6116E-01
                   6  1.2780E-01     9.2052E-01     8.6116E-01
                   7  1.2780E-01     9.2052E-01     8.6116E-01
                   8  1.2780E-01     9.2052E-01     8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        9
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2185E-01     9.1982E-01     8.6752E-01
                   2  1.2185E-01     9.1982E-01     8.6752E-01
                   3  1.2185E-01     9.1982E-01     8.6752E-01
                   4  1.2185E-01     9.1982E-01     8.6752E-01
                   5  1.2185E-01     9.1982E-01     8.6752E-01
                   6  1.2185E-01     9.1982E-01     8.6752E-01
                   7  1.2185E-01     9.1982E-01     8.6752E-01
                   8  1.2185E-01     9.1982E-01     8.6752E-01
                   9  1.2185E-01     9.1982E-01     8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            1
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.28648 MB (temporary)
             Pre-Poststep:   0.08926 MB (temporary)
 model PE exited: mype            2
 model PE exited: mype            3

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.02061 MB (persistent)
PDAF           ensemble array:   0.62943 MB (persistent)
PDAF            analysis step:   0.57861 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.001 s
PDAF                  Time of forecasts:      0.001 s
PDAF        Time for analysis/transform:      0.260 s
PDAF                  global preparations:      0.004 s
PDAF                  local analysis loop:      0.256 s
PDAF                Time of prepoststep:      0.009 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.270 s
                   total run time:      0.272 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs

               Use OpenMP with   2 threads



  PARSER: tasks=         1

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2       2      1      2      3      0       T
     3       3      1      3      4      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  4 PEs
     task   1 PE(model)   0 dim_local(state):    75
     task   1 PE(model)   1 dim_local(state):    75
     task   1 PE(model)   2 dim_local(state):    75
     task   1 PE(model)   3 dim_local(state):    75

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         7
  PARSER: subtype=         2
  PARSER: dim_lag=        10
  PARSER: filename= output_par_smoother_lestkf2.dat
                     Filter: LESTKF
              ensemble size:   50
               smoother lag:   10
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Error Subspace Transform Kalman Filter   +++
PDAF    +++                    (LESTKF)                     +++
PDAF    +++                                                 +++
PDAF    +++ Domain-localized implementation of the ESTKF by +++
PDAF    +++  Nerger et al., Mon. Wea. Rev. 140 (2012) 2335  +++
PDAF    +++           doi:10.1175/MWR-D-11-00102.1          +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LESTKF configuration
PDAF          filter sub-type = 2
PDAF            --> LESTKF with fixed error-space basis
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> Apply smoother up to lag:    10
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      4
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     4
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION
PDAF     --- PE-domain:     1 number of analysis domains:        75


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-Domain:     2 dimension of PE-local full obs. vector       300
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF     --- PE-Domain:     3 dimension of PE-local full obs. vector       300
PDAF     --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-Domain:     2 dimension of PE-local full obs. vector       300
PDAF     --- PE-domain:     1 number of analysis domains:        75
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF     --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-Domain:     3 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF       4   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        1
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  2.3333E-01     9.4184E-01     7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-Domain:     2 dimension of PE-local full obs. vector       300
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-Domain:     1 dimension of PE-local full obs. vector       300
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF     --- PE-Domain:     3 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF       6   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        2
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  2.0207E-01     9.3827E-01     7.8463E-01
                   2  2.0207E-01     9.3827E-01     7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-Domain:     3 dimension of PE-local full obs. vector       300
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-Domain:     2 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF       8   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        3
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.8074E-01     9.2853E-01     8.0535E-01
                   2  1.8074E-01     9.2853E-01     8.0535E-01
                   3  1.8074E-01     9.2853E-01     8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-Domain:     3 dimension of PE-local full obs. vector       300
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-Domain:     2 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      10   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        4
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.6499E-01     9.2803E-01     8.2221E-01
                   2  1.6499E-01     9.2803E-01     8.2221E-01
                   3  1.6499E-01     9.2803E-01     8.2221E-01
                   4  1.6499E-01     9.2803E-01     8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF     --- PE-Domain:     2 dimension of PE-local full obs. vector       300
PDAF     --- PE-Domain:     3 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      12   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        5
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.5275E-01     9.2691E-01     8.3520E-01
                   2  1.5275E-01     9.2691E-01     8.3520E-01
                   3  1.5275E-01     9.2691E-01     8.3520E-01
                   4  1.5275E-01     9.2691E-01     8.3520E-01
                   5  1.5275E-01     9.2691E-01     8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-Domain:     2 dimension of PE-local full obs. vector       300
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-Domain:     3 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      14   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        6
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.4289E-01     9.2203E-01     8.4503E-01
                   2  1.4289E-01     9.2203E-01     8.4503E-01
                   3  1.4289E-01     9.2203E-01     8.4503E-01
                   4  1.4289E-01     9.2203E-01     8.4503E-01
                   5  1.4289E-01     9.2203E-01     8.4503E-01
                   6  1.4289E-01     9.2203E-01     8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-Domain:     3 dimension of PE-local full obs. vector       300
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-Domain:     2 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      16   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        7
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.3472E-01     9.2057E-01     8.5366E-01
                   2  1.3472E-01     9.2057E-01     8.5366E-01
                   3  1.3472E-01     9.2057E-01     8.5366E-01
                   4  1.3472E-01     9.2057E-01     8.5366E-01
                   5  1.3472E-01     9.2057E-01     8.5366E-01
                   6  1.3472E-01     9.2057E-01     8.5366E-01
                   7  1.3472E-01     9.2057E-01     8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-Domain:     2 dimension of PE-local full obs. vector       300
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-Domain:     3 dimension of PE-local full obs. vector       300
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Compute deterministic Omega
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        8
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2780E-01     9.2052E-01     8.6116E-01
                   2  1.2780E-01     9.2052E-01     8.6116E-01
                   3  1.2780E-01     9.2052E-01     8.6116E-01
                   4  1.2780E-01     9.2052E-01     8.6116E-01
                   5  1.2780E-01     9.2052E-01     8.6116E-01
                   6  1.2780E-01     9.2052E-01     8.6116E-01
                   7  1.2780E-01     9.2052E-01     8.6116E-01
                   8  1.2780E-01     9.2052E-01     8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Store previous analysis for smoother
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-Domain:     1 dimension of PE-local full obs. vector       300
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-Domain:     2 dimension of PE-local full obs. vector       300
PDAF     --- PE-domain:     3 number of analysis domains:        75
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF     --- PE-Domain:     3 dimension of PE-local full obs. vector       300
PDAF Analysis -------------------------------------------------------
PDAF      20   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        9
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2185E-01     9.1982E-01     8.6752E-01
                   2  1.2185E-01     9.1982E-01     8.6752E-01
                   3  1.2185E-01     9.1982E-01     8.6752E-01
                   4  1.2185E-01     9.1982E-01     8.6752E-01
                   5  1.2185E-01     9.1982E-01     8.6752E-01
                   6  1.2185E-01     9.1982E-01     8.6752E-01
                   7  1.2185E-01     9.1982E-01     8.6752E-01
                   8  1.2185E-01     9.1982E-01     8.6752E-01
                   9  1.2185E-01     9.1982E-01     8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            1
 model PE exited: mype            2
 model PE exited: mype            3
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00059 MB (persistent)
            ensemble init:   0.25787 MB (temporary)
             Pre-Poststep:   0.06981 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.01946 MB (persistent)
PDAF           ensemble array:   0.31471 MB (persistent)
PDAF            analysis step:   0.57861 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.001 s
PDAF                  Time of forecasts:      0.000 s
PDAF        Time for analysis/transform:      0.238 s
PDAF                  global preparations:      0.047 s
PDAF                  local analysis loop:      0.190 s
PDAF                Time of prepoststep:      0.010 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.248 s
                   total run time:      0.250 s

 PDAF test suite: END
--------------------------------------------------------
Run NETF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs

               Use OpenMP with   2 threads



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2              2      0      1      1       F
     3              2      1      2      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         9
  PARSER: subtype=         0
  PARSER: dim_lag=        10
  PARSER: filename= output_par_smoother_netf0.dat

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++      Nonlinear Ensemble Transform Filter (NETF)       +++
PDAF    +++                                                       +++
PDAF    +++                         by                            +++
PDAF    +++ J. Toedter, B. Ahrens, Mon. Wea. Rev. 143 (2015) 1347 +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    NETF configuration
PDAF           filter sub-type = 0
--> NETF 
PDAF            --> Transform ensemble including product with random matrix
PDAF            --> Use fixed forgetting factor: 1.00

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF     NETF smoother: Compute transform matrix without inflation
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step      2
PDAF     --- Effective sample size       1.66
PDAF     --- number of small singular values     2
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step      2
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF     --- Effective sample size       1.00
PDAF     --- number of small singular values     3
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.4022E-02
               RMS error according to true variance:   1.0335E+00
              Relative underestimation of variances:   9.7676E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.4022E-02
               RMS error according to true variance:   1.0335E+00
              Relative underestimation of variances:   9.7676E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF     NETF smoother: Compute transform matrix without inflation
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step      4
PDAF     --- Effective sample size      11.45
PDAF     --- number of small singular values     0
PDAF     Compute NETF filter update
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step      4
PDAF     --- Effective sample size       7.96
PDAF     --- number of small singular values     0
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        1
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3168E-02
               RMS error according to true variance:   1.0255E+00
              Relative underestimation of variances:   9.7741E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  2.4792E-02     1.0264E+00     9.7585E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3168E-02
               RMS error according to true variance:   1.0255E+00
              Relative underestimation of variances:   9.7741E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF     NETF smoother: Compute transform matrix without inflation
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step      6
PDAF     --- Effective sample size      14.98
PDAF     --- number of small singular values     0
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step      6
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF     --- Effective sample size      15.80
PDAF     --- number of small singular values     0
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        2
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.7176E-02
               RMS error according to true variance:   1.0214E+00
              Relative underestimation of variances:   9.8318E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.6385E-02     1.0213E+00     9.8396E-01
                   2  1.7027E-02     1.0219E+00     9.8334E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.7176E-02
               RMS error according to true variance:   1.0214E+00
              Relative underestimation of variances:   9.8318E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF     NETF smoother: Compute transform matrix without inflation
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step      8
PDAF     --- Effective sample size      32.79
PDAF     --- number of small singular values     0
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector     150
PDAF     --- PE-domain   1 dimension of observation vector     150
        --- initialize observation at time step      8
PDAF     --- Effective sample size      29.70
PDAF     --- number of small singular values     0
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        3
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5771E-02
               RMS error according to true variance:   1.0195E+00
              Relative underestimation of variances:   9.8453E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.6060E-02     1.0199E+00     9.8425E-01
                   2  1.5434E-02     1.0198E+00     9.8487E-01
                   3  1.6094E-02     1.0202E+00     9.8423E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5771E-02
               RMS error according to true variance:   1.0195E+00
              Relative underestimation of variances:   9.8453E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF     NETF smoother: Compute transform matrix without inflation
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step     10
PDAF     --- Effective sample size      22.04
PDAF     --- number of small singular values     0
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector     150
PDAF     --- PE-domain   1 dimension of observation vector     150
        --- initialize observation at time step     10
PDAF     --- Effective sample size      40.79
PDAF     --- number of small singular values     0
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4952E-02
               RMS error according to true variance:   1.0186E+00
              Relative underestimation of variances:   9.8532E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2632E-02     1.0175E+00     9.8759E-01
                   2  1.3168E-02     1.0177E+00     9.8706E-01
                   3  1.2716E-02     1.0177E+00     9.8750E-01
                   4  1.3455E-02     1.0180E+00     9.8678E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4952E-02
               RMS error according to true variance:   1.0186E+00
              Relative underestimation of variances:   9.8532E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF     NETF smoother: Compute transform matrix without inflation
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step     12
PDAF     --- Effective sample size      41.85
PDAF     --- number of small singular values     0
PDAF     Compute NETF filter update
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step     12
PDAF     --- Effective sample size      20.48
PDAF     --- number of small singular values     0
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        5
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5110E-02
               RMS error according to true variance:   1.0167E+00
              Relative underestimation of variances:   9.8514E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.4868E-02     1.0178E+00     9.8539E-01
                   2  1.2564E-02     1.0169E+00     9.8764E-01
                   3  1.3070E-02     1.0170E+00     9.8715E-01
                   4  1.2675E-02     1.0170E+00     9.8754E-01
                   5  1.3343E-02     1.0172E+00     9.8688E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5110E-02
               RMS error according to true variance:   1.0167E+00
              Relative underestimation of variances:   9.8514E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF     NETF smoother: Compute transform matrix without inflation
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step     14
PDAF     --- Effective sample size      37.92
PDAF     --- number of small singular values     0
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step     14
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF     --- Effective sample size      36.34
PDAF     --- number of small singular values     0
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3478E-02
               RMS error according to true variance:   1.0156E+00
              Relative underestimation of variances:   9.8673E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.3499E-02     1.0157E+00     9.8671E-01
                   2  1.4558E-02     1.0167E+00     9.8568E-01
                   3  1.2179E-02     1.0161E+00     9.8801E-01
                   4  1.2762E-02     1.0162E+00     9.8744E-01
                   5  1.2642E-02     1.0161E+00     9.8756E-01
                   6  1.3230E-02     1.0163E+00     9.8698E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3478E-02
               RMS error according to true variance:   1.0156E+00
              Relative underestimation of variances:   9.8673E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF     NETF smoother: Compute transform matrix without inflation
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step     16
PDAF     --- Effective sample size      43.66
PDAF     --- number of small singular values     0
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step     16
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF     --- Effective sample size      45.34
PDAF     --- number of small singular values     0
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        7
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3351E-02
               RMS error according to true variance:   1.0152E+00
              Relative underestimation of variances:   9.8685E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.3530E-02     1.0152E+00     9.8667E-01
                   2  1.3570E-02     1.0153E+00     9.8663E-01
                   3  1.4573E-02     1.0163E+00     9.8566E-01
                   4  1.2039E-02     1.0157E+00     9.8815E-01
                   5  1.2515E-02     1.0157E+00     9.8768E-01
                   6  1.2401E-02     1.0156E+00     9.8779E-01
                   7  1.2989E-02     1.0157E+00     9.8721E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3351E-02
               RMS error according to true variance:   1.0152E+00
              Relative underestimation of variances:   9.8685E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF     NETF smoother: Compute transform matrix without inflation
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step     18
PDAF     --- Effective sample size      40.49
PDAF     --- number of small singular values     0
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step     18
PDAF     --- Effective sample size      45.94
PDAF     --- number of small singular values     0
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        8
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3011E-02
               RMS error according to true variance:   1.0150E+00
              Relative underestimation of variances:   9.8718E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2601E-02     1.0145E+00     9.8758E-01
                   2  1.2746E-02     1.0145E+00     9.8744E-01
                   3  1.3037E-02     1.0145E+00     9.8715E-01
                   4  1.3763E-02     1.0155E+00     9.8645E-01
                   5  1.1239E-02     1.0151E+00     9.8893E-01
                   6  1.1433E-02     1.0150E+00     9.8874E-01
                   7  1.1227E-02     1.0150E+00     9.8894E-01
                   8  1.1703E-02     1.0150E+00     9.8847E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3011E-02
               RMS error according to true variance:   1.0150E+00
              Relative underestimation of variances:   9.8718E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF     NETF smoother: Compute transform matrix without inflation
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step     20
PDAF     --- Effective sample size      46.33
PDAF     --- number of small singular values     0
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step     20
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF     --- Effective sample size      39.73
PDAF     --- number of small singular values     0
PDAF     --- use blocking with size   200
PDAF     Perform smoothing up to lag        9
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2356E-02
               RMS error according to true variance:   1.0143E+00
              Relative underestimation of variances:   9.8782E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.2781E-02     1.0147E+00     9.8740E-01
                   2  1.2428E-02     1.0143E+00     9.8775E-01
                   3  1.2612E-02     1.0143E+00     9.8757E-01
                   4  1.2841E-02     1.0143E+00     9.8734E-01
                   5  1.3787E-02     1.0152E+00     9.8642E-01
                   6  1.1181E-02     1.0148E+00     9.8898E-01
                   7  1.1405E-02     1.0148E+00     9.8876E-01
                   8  1.1352E-02     1.0147E+00     9.8881E-01
                   9  1.1793E-02     1.0147E+00     9.8838E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.28648 MB (temporary)
 model PE exited: mype            1
 model PE exited: mype            2
             Pre-Poststep:   0.08926 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.02022 MB (persistent)
PDAF           ensemble array:   0.60081 MB (persistent)
PDAF            analysis step:   0.26971 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.001 s
 model PE exited: mype            3
PDAF                  Time of forecasts:      0.002 s
PDAF              Time for assimilation:      0.062 s
PDAF                Time of prepoststep:      0.006 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.001 s
                 ------------ Summary ------------
                   initialize model:      0.001 s
                  initialize filter:      0.001 s
                       assimilation:      0.072 s
                   total run time:      0.074 s

 PDAF test suite: END
--------------------------------------------------------
Run LNETF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs

               Use OpenMP with   2 threads



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2              2      0      1      1       F
     3              2      1      2      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=        10
  PARSER: subtype=         0
  PARSER: dim_lag=        10
  PARSER: filename= output_par_smoother_netf0.dat

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++   Local Nonlinear Ensemble Transform Filter (LNETF)   +++
PDAF    +++                                                       +++
PDAF    +++              Domain-localized NETF by                 +++
PDAF    +++ J. Toedter, B. Ahrens, Mon. Wea. Rev. 143 (2015) 1347 +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LNETF configuration
PDAF          filter sub-type = 0
PDAF            --> LNETF 
PDAF            --> Transform ensemble including product with random matrix
PDAF            --> Use fixed forgetting factor: 1.00

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain:  1 number of analysis domains:     150
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF     --- PE-Domain:  1 dimension of PE-local full obs. vector     300
PDAF Analysis -------------------------------------------------------
PDAF      2   Assimilating observations - LNETF analysis using T-matrix
PDAF     --- PE-domain:  0 number of analysis domains:     150
PDAF     --- PE-Domain:  0 dimension of PE-local full obs. vector     300
PDAF     --- Initialize random transformation
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- use blocking with size   200
PDAF     Compute transform matrix for smoother without inflation
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF        Minimal  effective ensemble size:             1.0
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:                0
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5007E-01
               RMS error according to true variance:   1.0029E+00
              Relative underestimation of variances:   7.5065E-01
    -------------------------------------------------------------
      2   Next observation at time step      4
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5007E-01
               RMS error according to true variance:   1.0029E+00
              Relative underestimation of variances:   7.5065E-01
PDAF     --- PE-domain:  1 number of analysis domains:     150
PDAF     --- PE-Domain:  1 dimension of PE-local full obs. vector     300
PDAF Analysis -------------------------------------------------------
PDAF      4   Assimilating observations - LNETF analysis using T-matrix
PDAF     --- PE-domain:  0 number of analysis domains:     150
PDAF     --- PE-Domain:  0 dimension of PE-local full obs. vector     300
PDAF     --- Initialize random transformation
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- use blocking with size   200
PDAF     Compute transform matrix for smoother without inflation
PDAF     Perform smoothing up to lag        1
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF        Minimal  effective ensemble size:             1.2
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:               17
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3598E-01
               RMS error according to true variance:   9.8811E-01
              Relative underestimation of variances:   8.6238E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.3598E-01     9.8811E-01     8.6238E-01
    -------------------------------------------------------------
      4   Next observation at time step      6
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3598E-01
               RMS error according to true variance:   9.8811E-01
              Relative underestimation of variances:   8.6238E-01
PDAF     --- PE-domain:  1 number of analysis domains:     150
PDAF     --- PE-Domain:  1 dimension of PE-local full obs. vector     300
PDAF Analysis -------------------------------------------------------
PDAF      6   Assimilating observations - LNETF analysis using T-matrix
PDAF     --- PE-domain:  0 number of analysis domains:     150
PDAF     --- PE-Domain:  0 dimension of PE-local full obs. vector     300
PDAF     --- Initialize random transformation
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- use blocking with size   200
PDAF     Compute transform matrix for smoother without inflation
PDAF     Perform smoothing up to lag        2
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF        Minimal  effective ensemble size:             9.9
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:                0
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.0957E-01
               RMS error according to true variance:   9.8256E-01
              Relative underestimation of variances:   8.8849E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  1.0957E-01     9.8256E-01     8.8849E-01
                   2  1.0957E-01     9.8256E-01     8.8849E-01
    -------------------------------------------------------------
      6   Next observation at time step      8
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.0957E-01
               RMS error according to true variance:   9.8256E-01
              Relative underestimation of variances:   8.8849E-01
PDAF     --- PE-domain:  1 number of analysis domains:     150
PDAF     --- PE-Domain:  1 dimension of PE-local full obs. vector     300
PDAF Analysis -------------------------------------------------------
PDAF      8   Assimilating observations - LNETF analysis using T-matrix
PDAF     --- PE-domain:  0 number of analysis domains:     150
PDAF     --- PE-Domain:  0 dimension of PE-local full obs. vector     300
PDAF     --- Initialize random transformation
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- use blocking with size   200
PDAF     Compute transform matrix for smoother without inflation
PDAF     Perform smoothing up to lag        3
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF        Minimal  effective ensemble size:             4.9
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:                0
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.8994E-02
               RMS error according to true variance:   9.7408E-01
              Relative underestimation of variances:   9.0864E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  8.8994E-02     9.7408E-01     9.0864E-01
                   2  8.8994E-02     9.7408E-01     9.0864E-01
                   3  8.8994E-02     9.7408E-01     9.0864E-01
    -------------------------------------------------------------
      8   Next observation at time step     10
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.8994E-02
               RMS error according to true variance:   9.7408E-01
              Relative underestimation of variances:   9.0864E-01
PDAF     --- PE-domain:  1 number of analysis domains:     150
PDAF     --- PE-Domain:  1 dimension of PE-local full obs. vector     300
PDAF Analysis -------------------------------------------------------
PDAF     10   Assimilating observations - LNETF analysis using T-matrix
PDAF     --- PE-domain:  0 number of analysis domains:     150
PDAF     --- PE-Domain:  0 dimension of PE-local full obs. vector     300
PDAF     --- Initialize random transformation
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- use blocking with size   200
PDAF     Compute transform matrix for smoother without inflation
PDAF     Perform smoothing up to lag        4
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF        Minimal  effective ensemble size:            18.2
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:                0
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.4194E-02
               RMS error according to true variance:   9.7223E-01
              Relative underestimation of variances:   9.1340E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  8.4194E-02     9.7223E-01     9.1340E-01
                   2  8.4194E-02     9.7223E-01     9.1340E-01
                   3  8.4194E-02     9.7223E-01     9.1340E-01
                   4  8.4194E-02     9.7223E-01     9.1340E-01
    -------------------------------------------------------------
     10   Next observation at time step     12
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.4194E-02
               RMS error according to true variance:   9.7223E-01
              Relative underestimation of variances:   9.1340E-01
PDAF     --- PE-domain:  1 number of analysis domains:     150
PDAF     --- PE-Domain:  1 dimension of PE-local full obs. vector     300
PDAF Analysis -------------------------------------------------------
PDAF     12   Assimilating observations - LNETF analysis using T-matrix
PDAF     --- PE-domain:  0 number of analysis domains:     150
PDAF     --- PE-Domain:  0 dimension of PE-local full obs. vector     300
PDAF     --- Initialize random transformation
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- use blocking with size   200
PDAF     Compute transform matrix for smoother without inflation
PDAF     Perform smoothing up to lag        5
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF        Minimal  effective ensemble size:            21.8
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:                0
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   7.9932E-02
               RMS error according to true variance:   9.7124E-01
              Relative underestimation of variances:   9.1770E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  7.9932E-02     9.7124E-01     9.1770E-01
                   2  7.9932E-02     9.7124E-01     9.1770E-01
                   3  7.9932E-02     9.7124E-01     9.1770E-01
                   4  7.9932E-02     9.7124E-01     9.1770E-01
                   5  7.9932E-02     9.7124E-01     9.1770E-01
    -------------------------------------------------------------
     12   Next observation at time step     14
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:  1 number of analysis domains:     150
PDAF     --- PE-Domain:  1 dimension of PE-local full obs. vector     300
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   7.9932E-02
               RMS error according to true variance:   9.7124E-01
              Relative underestimation of variances:   9.1770E-01
PDAF Analysis -------------------------------------------------------
PDAF     14   Assimilating observations - LNETF analysis using T-matrix
PDAF     --- PE-domain:  0 number of analysis domains:     150
PDAF     --- PE-Domain:  0 dimension of PE-local full obs. vector     300
PDAF     --- Initialize random transformation
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- use blocking with size   200
PDAF     Compute transform matrix for smoother without inflation
PDAF     Perform smoothing up to lag        6
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF        Minimal  effective ensemble size:            11.1
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:                0
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   7.3651E-02
               RMS error according to true variance:   9.6798E-01
              Relative underestimation of variances:   9.2391E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  7.3651E-02     9.6798E-01     9.2391E-01
                   2  7.3651E-02     9.6798E-01     9.2391E-01
                   3  7.3651E-02     9.6798E-01     9.2391E-01
                   4  7.3651E-02     9.6798E-01     9.2391E-01
                   5  7.3651E-02     9.6798E-01     9.2391E-01
                   6  7.3651E-02     9.6798E-01     9.2391E-01
    -------------------------------------------------------------
     14   Next observation at time step     16
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   7.3651E-02
               RMS error according to true variance:   9.6798E-01
              Relative underestimation of variances:   9.2391E-01
PDAF     --- PE-domain:  1 number of analysis domains:     150
PDAF     --- PE-Domain:  1 dimension of PE-local full obs. vector     300
PDAF Analysis -------------------------------------------------------
PDAF     16   Assimilating observations - LNETF analysis using T-matrix
PDAF     --- PE-domain:  0 number of analysis domains:     150
PDAF     --- PE-Domain:  0 dimension of PE-local full obs. vector     300
PDAF     --- Initialize random transformation
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- use blocking with size   200
PDAF     Compute transform matrix for smoother without inflation
PDAF     Perform smoothing up to lag        7
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF        Minimal  effective ensemble size:            25.1
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:                0
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   7.0108E-02
               RMS error according to true variance:   9.6643E-01
              Relative underestimation of variances:   9.2746E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  7.0108E-02     9.6643E-01     9.2746E-01
                   2  7.0108E-02     9.6643E-01     9.2746E-01
                   3  7.0108E-02     9.6643E-01     9.2746E-01
                   4  7.0108E-02     9.6643E-01     9.2746E-01
                   5  7.0108E-02     9.6643E-01     9.2746E-01
                   6  7.0108E-02     9.6643E-01     9.2746E-01
                   7  7.0108E-02     9.6643E-01     9.2746E-01
    -------------------------------------------------------------
     16   Next observation at time step     18
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   7.0108E-02
               RMS error according to true variance:   9.6643E-01
              Relative underestimation of variances:   9.2746E-01
PDAF     --- PE-domain:  1 number of analysis domains:     150
PDAF     --- PE-Domain:  1 dimension of PE-local full obs. vector     300
PDAF Analysis -------------------------------------------------------
PDAF     18   Assimilating observations - LNETF analysis using T-matrix
PDAF     --- PE-domain:  0 number of analysis domains:     150
PDAF     --- PE-Domain:  0 dimension of PE-local full obs. vector     300
PDAF     --- Initialize random transformation
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- use blocking with size   200
PDAF     Compute transform matrix for smoother without inflation
PDAF     Perform smoothing up to lag        8
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF        Minimal  effective ensemble size:            23.6
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:                0
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   6.5636E-02
               RMS error according to true variance:   9.6534E-01
              Relative underestimation of variances:   9.3201E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  6.5636E-02     9.6534E-01     9.3201E-01
                   2  6.5636E-02     9.6534E-01     9.3201E-01
                   3  6.5636E-02     9.6534E-01     9.3201E-01
                   4  6.5636E-02     9.6534E-01     9.3201E-01
                   5  6.5636E-02     9.6534E-01     9.3201E-01
                   6  6.5636E-02     9.6534E-01     9.3201E-01
                   7  6.5636E-02     9.6534E-01     9.3201E-01
                   8  6.5636E-02     9.6534E-01     9.3201E-01
    -------------------------------------------------------------
     18   Final observation at time step     20
PDAF     Store previous analysis for smoother
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   6.5636E-02
               RMS error according to true variance:   9.6534E-01
              Relative underestimation of variances:   9.3201E-01
PDAF     --- PE-domain:  1 number of analysis domains:     150
PDAF     --- PE-Domain:  1 dimension of PE-local full obs. vector     300
PDAF Analysis -------------------------------------------------------
PDAF     20   Assimilating observations - LNETF analysis using T-matrix
PDAF     --- PE-domain:  0 number of analysis domains:     150
PDAF     --- PE-Domain:  0 dimension of PE-local full obs. vector     300
PDAF     --- Initialize random transformation
PDAF     --- Use OpenMP parallelization with     2 threads
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Use OpenMP parallelization with     2 threads
PDAF     --- use blocking with size   200
PDAF     Compute transform matrix for smoother without inflation
PDAF     Perform smoothing up to lag        9
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF        Minimal  effective ensemble size:            24.8
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:                0
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   6.4775E-02
               RMS error according to true variance:   9.6440E-01
              Relative underestimation of variances:   9.3283E-01
        Analyze smoothed states
            Smoother RMS errors:
               lag     sampled          true     relative underestimation
                   1  6.4775E-02     9.6440E-01     9.3283E-01
                   2  6.4775E-02     9.6440E-01     9.3283E-01
                   3  6.4775E-02     9.6440E-01     9.3283E-01
                   4  6.4775E-02     9.6440E-01     9.3283E-01
                   5  6.4775E-02     9.6440E-01     9.3283E-01
                   6  6.4775E-02     9.6440E-01     9.3283E-01
                   7  6.4775E-02     9.6440E-01     9.3283E-01
                   8  6.4775E-02     9.6440E-01     9.3283E-01
                   9  6.4775E-02     9.6440E-01     9.3283E-01
    -------------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.28648 MB (temporary)
             Pre-Poststep:   0.08926 MB (temporary)
 model PE exited: mype            1
 model PE exited: mype            2

                       PDAF Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              state and A:   0.02022 MB (persistent)
           ensemble array:   0.60081 MB (persistent)
            analysis step:  12.09346 MB (temporary)


                     PDAF Timing information
          ---------------------------------------------
            Generate state ensemble:      0.002 s
                  Time of forecasts:      0.004 s
        Time for analysis/transform:      1.043 s
                  global preparations:      0.052 s
                  local analysis loop:      0.991 s
 model PE exited: mype            3
                Time of prepoststep:      0.014 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      1.061 s
                   total run time:      1.064 s

 PDAF test suite: END
PDAF tests completed:  Fri Dec 22 10:30:16 CET 2017
