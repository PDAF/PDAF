Running tests with PDAF in online configuration in ../bin
The output files can be compared with outputs in testsuite/tests_dummy1D
cd ../bin; ../tests_dummy1D/runtests_1pe.sh
====================  Testing PDAF  ====================
Machine:  Linux uv100 3.0.13-0.27-default #1 SMP Wed Feb 15 13:33:49 UTC 2012 (d73692b) x86_64 x86_64 x86_64 GNU/Linux
Date:  Fri Jun 12 14:43:57 CEST 2015
--------------------------------------------------------
Run SEEK tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        49
  PARSER: filtertype=         0
  PARSER: subtype=         0
  PARSER: filename= output_seek0.dat

                     Filter: SEEK
             number of EOFs:   49
      Assimilation interval:    2
          forgetting factor: 1.00
          Re-diag each    1-th analysis step

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF     +++                  SEEK Filter                   +++
PDAF     +++                                                +++
PDAF     +++    Pham et al., J. Mar. Syst. 16 (1998) 323    +++
PDAF     +++          This implementation follows           +++
PDAF     +++      Nerger et al., Tellus 57A (2005) 715      +++
PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEEK configuration
PDAF          filter sub-type = 0
PDAF            --> Standard SEEK with unit modes
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> number of EOFs:   49
PDAF          Re-diag at each analysis step

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    49
PDAF   Evolve central state on task:   1

PDAF: Call routine for ensemble initialization

         Initialize state estimate and EOF decomposed covariance matrix
         --- number of EOFs:   49

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      2
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecast state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      4
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecast state ensemble
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      6
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecast state ensemble
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      8
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecast state ensemble
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     10
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecast state ensemble
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     12
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecast state ensemble
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     14
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecast state ensemble
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     16
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecast state ensemble
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     18
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecast state ensemble
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     20
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.11481 MB (temporary)
             Pre-Poststep:   0.14439 MB (temporary)


PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.02061 MB (persistent)
PDAF         covariance modes:   0.11215 MB (persistent)
PDAF            analysis step:   0.28935 MB (temporary)
PDAF         reinitialization:   0.16879 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF                 EOF initialization:      0.000 s
PDAF                  Time of forecasts:      0.001 s
PDAF              Time of assimilations:      0.007 s
PDAF               re-diagonalize covar:      0.011 s
PDAF                Time of prepoststep:      0.165 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.000 s
                       assimilation:      0.184 s
                   total run time:      0.185 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        49
  PARSER: filtertype=         0
  PARSER: subtype=         1
  PARSER: filename= output_seek1.dat

                     Filter: SEEK
             number of EOFs:   49
      Assimilation interval:    2
          forgetting factor: 1.00
          Re-diag each    1-th analysis step

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF     +++                  SEEK Filter                   +++
PDAF     +++                                                +++
PDAF     +++    Pham et al., J. Mar. Syst. 16 (1998) 323    +++
PDAF     +++          This implementation follows           +++
PDAF     +++      Nerger et al., Tellus 57A (2005) 715      +++
PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEEK configuration
PDAF          filter sub-type = 1
PDAF            --> SEEK with non-unit modes
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> number of EOFs:   49
PDAF          Re-diag at each analysis step

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    49
PDAF   Evolve central state on task:   1

PDAF: Call routine for ensemble initialization

         Initialize state estimate and EOF decomposed covariance matrix
         --- number of EOFs:   49

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      2
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecast state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      4
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecast state ensemble
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      6
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecast state ensemble
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      8
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecast state ensemble
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     10
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecast state ensemble
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     12
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecast state ensemble
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     14
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecast state ensemble
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     16
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecast state ensemble
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     18
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecast state ensemble
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     20
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.11481 MB (temporary)
             Pre-Poststep:   0.14439 MB (temporary)


PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.02061 MB (persistent)
PDAF         covariance modes:   0.11215 MB (persistent)
PDAF            analysis step:   0.28935 MB (temporary)
PDAF         reinitialization:   0.16879 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF                 EOF initialization:      0.000 s
PDAF                  Time of forecasts:      0.001 s
PDAF              Time of assimilations:      0.008 s
PDAF               re-diagonalize covar:      0.024 s
PDAF                Time of prepoststep:      0.289 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.000 s
                       assimilation:      0.323 s
                   total run time:      0.324 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        49
  PARSER: filtertype=         0
  PARSER: subtype=         2
  PARSER: filename= output_seek2.dat

                     Filter: SEEK
      -- fixed basis filter with update of matrix U
      -- no re-diagonalization of VUV^T
             number of EOFs:   49
      Assimilation interval:    2
          forgetting factor: 1.00
          Re-diag each    1-th analysis step

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF     +++                  SEEK Filter                   +++
PDAF     +++                                                +++
PDAF     +++    Pham et al., J. Mar. Syst. 16 (1998) 323    +++
PDAF     +++          This implementation follows           +++
PDAF     +++      Nerger et al., Tellus 57A (2005) 715      +++
PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEEK configuration
PDAF          filter sub-type = 2
PDAF            --> fixed basis filter with update of matrix U
PDAF            --> no re-diagonalization of VUV^T
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> number of EOFs:   49

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    49
PDAF   Evolve central state on task:   1

PDAF: Call routine for ensemble initialization

         Initialize state estimate and EOF decomposed covariance matrix
         --- number of EOFs:   49

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      2
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecast state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      4
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecast state ensemble
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecast state ensemble
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      8
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecast state ensemble
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     10
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecast state ensemble
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     12
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecast state ensemble
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     14
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecast state ensemble
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     16
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecast state ensemble
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     18
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecast state ensemble
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     20
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.11481 MB (temporary)
             Pre-Poststep:   0.14439 MB (temporary)


PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.02061 MB (persistent)
PDAF         covariance modes:   0.11215 MB (persistent)
PDAF            analysis step:   0.28935 MB (temporary)
PDAF         reinitialization:   0.00000 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF                 EOF initialization:      0.000 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time of assimilations:      0.012 s
PDAF               re-diagonalize covar:      0.000 s
PDAF                Time of prepoststep:      0.203 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.000 s
                       assimilation:      0.216 s
                   total run time:      0.216 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        49
  PARSER: filtertype=         0
  PARSER: subtype=         3
  PARSER: filename= output_seek3.dat

                     Filter: SEEK
      -- fixed basis filter & no update of matrix U
      -- no re-diagonalization of VUV^T
             number of EOFs:   49
      Assimilation interval:    2
          forgetting factor: 1.00
          Re-diag each    1-th analysis step

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF     +++                  SEEK Filter                   +++
PDAF     +++                                                +++
PDAF     +++    Pham et al., J. Mar. Syst. 16 (1998) 323    +++
PDAF     +++          This implementation follows           +++
PDAF     +++      Nerger et al., Tellus 57A (2005) 715      +++
PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEEK configuration
PDAF          filter sub-type = 3
PDAF            --> fixed basis filter & no update of matrix U
PDAF            --> no re-diagonalization of VUV^T
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> number of EOFs:   49

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    49
PDAF   Evolve central state on task:   1

PDAF: Call routine for ensemble initialization

         Initialize state estimate and EOF decomposed covariance matrix
         --- number of EOFs:   49

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      2
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   5.7864E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      4
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   6.9642E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   5.7067E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   6.9846E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   5.7356E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      8
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   6.9530E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   5.6909E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     10
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   6.9980E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   5.7546E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     12
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   6.9831E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   5.7334E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     14
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   6.9453E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   5.6801E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     16
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   6.9498E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     18
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   6.9552E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   5.6941E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     20
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   6.9498E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.11481 MB (temporary)
             Pre-Poststep:   0.14439 MB (temporary)


PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.02061 MB (persistent)
PDAF         covariance modes:   0.11215 MB (persistent)
PDAF            analysis step:   0.28935 MB (temporary)
PDAF         reinitialization:   0.00000 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF                 EOF initialization:      0.000 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time of assimilations:      0.042 s
PDAF               re-diagonalize covar:      0.000 s
PDAF                Time of prepoststep:      0.257 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.000 s
                       assimilation:      0.300 s
                   total run time:      0.301 s

 PDAF test suite: END
--------------------------------------------------------
Run SEIK tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         1
  PARSER: subtype=         0
  PARSER: filename= output_seik0.dat
                     Filter: SEIK
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  SEIK Filter                    +++
PDAF    +++                                                 +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++          This implementation follows            +++
PDAF    +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEIK configuration
PDAF          filter sub-type = 0
PDAF            --> Standard SEIK
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      2
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      4
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      6
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      8
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     10
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     12
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     14
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     16
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     18
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     20
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.01373 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.02061 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.38703 MB (temporary)
PDAF               resampling:   0.15107 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.169 s
PDAF                  Time of forecasts:      0.001 s
PDAF              Time for assimilation:      0.036 s
PDAF            ensemble transformation:      0.007 s
PDAF                Time of prepoststep:      0.021 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.170 s
                       assimilation:      0.065 s
                   total run time:      0.235 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         1
  PARSER: subtype=         1
  PARSER: filename= output_seik1.dat
                     Filter: SEIK
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  SEIK Filter                    +++
PDAF    +++                                                 +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++          This implementation follows            +++
PDAF    +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEIK configuration
PDAF          filter sub-type = 1
PDAF            --> Standard SEIK - old formulation
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      2
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      4
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      6
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      8
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     10
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     12
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     14
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     16
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     18
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     20
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.01373 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.02061 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.38435 MB (temporary)
PDAF               resampling:   0.13200 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.172 s
PDAF                  Time of forecasts:      0.001 s
PDAF              Time for assimilation:      0.022 s
PDAF            ensemble transformation:      0.004 s
PDAF                Time of prepoststep:      0.046 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.173 s
                       assimilation:      0.072 s
                   total run time:      0.245 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         1
  PARSER: subtype=         2
  PARSER: filename= output_seik2.dat
                     Filter: SEIK
      -- fixed error-space basis
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  SEIK Filter                    +++
PDAF    +++                                                 +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++          This implementation follows            +++
PDAF    +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEIK configuration
PDAF          filter sub-type = 2
PDAF            --> fixed error-space basis
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      2
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      4
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      6
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      8
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     10
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     12
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     14
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     16
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     18
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     20
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.01373 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.02061 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.38703 MB (temporary)
PDAF               resampling:   0.15107 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.136 s
PDAF                  Time of forecasts:      0.001 s
PDAF              Time for assimilation:      0.021 s
PDAF            ensemble transformation:      0.003 s
PDAF                Time of prepoststep:      0.016 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.138 s
                       assimilation:      0.041 s
                   total run time:      0.179 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         1
  PARSER: subtype=         3
  PARSER: filename= output_seik3.dat
                     Filter: SEIK
      -- fixed state covariance matrix
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  SEIK Filter                    +++
PDAF    +++                                                 +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++          This implementation follows            +++
PDAF    +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEIK configuration
PDAF          filter sub-type = 3
PDAF            --> fixed state covariance matrix
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      2
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   5.7864E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      4
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   6.9642E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   5.7067E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      6
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   6.9846E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   5.7356E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      8
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   6.9530E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   5.6909E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     10
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   6.9980E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   5.7546E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     12
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   6.9831E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   5.7334E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     14
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   6.9453E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   5.6801E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     16
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   6.9498E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     18
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   6.9552E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   5.6941E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     20
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   6.9498E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.12646 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.02061 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.38740 MB (temporary)
PDAF               resampling:   0.16976 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.268 s
PDAF                  Time of forecasts:      0.001 s
PDAF              Time for assimilation:      0.006 s
PDAF            ensemble transformation:      0.004 s
PDAF                Time of prepoststep:      0.067 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.002 s
                  initialize filter:      0.269 s
                       assimilation:      0.077 s
                   total run time:      0.347 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         1
  PARSER: subtype=         4
  PARSER: filename= output_seik4.dat
                     Filter: SEIK
      -- use ensemble transformation
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  SEIK Filter                    +++
PDAF    +++                                                 +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++          This implementation follows            +++
PDAF    +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEIK configuration
PDAF          filter sub-type = 4
PDAF            --> SEIK with ensemble transformation
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      2
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      4
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      6
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      8
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     10
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     12
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     14
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     16
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     18
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     20
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.01373 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.02061 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.50145 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.278 s
PDAF                  Time of forecasts:      0.001 s
PDAF              Time for assimilation:      0.019 s
PDAF                Time of prepoststep:      0.024 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.279 s
                       assimilation:      0.045 s
                   total run time:      0.324 s

 PDAF test suite: END
--------------------------------------------------------
Run EnKF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         2
  PARSER: subtype=         0
  PARSER: filename= output_enkf0.dat
                     Filter: EnKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF     +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF     +++          Ensemble Kalman Filter (EnKF)          +++
PDAF     +++                                                 +++
PDAF     +++   Evensen, J. Geophys. Res. 99C (1994) 10143    +++
PDAF     +++ using an ensemble of observations according to  +++
PDAF     +++ Burgers et al., Mon. Wea. Rev. 126 (1998) 1719  +++
PDAF     +++          This implementation follows            +++
PDAF     +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF     +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF      EnKF configuration
PDAF            filter sub-type = 0
PDAF              --> EnKF with analysis for large observation dimension
PDAF              --> ensemble size:   50
PDAF          --> forgetting factor: 1.00

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use random stochastic ensemble (EnKF type)
         --- Ensemble size:   50
         --- Generate ensemble
             Rank of covar matrix =    49
PDAF     --- EnKF_omega: Normalize columns of random matrix
PDAF     --- EnKF_omega: Project columns orthogonal to (1,...,1)^T

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.9918E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   6.0082E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.9918E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   6.0082E-01
PDAF Analysis -------------------------------------------------------
PDAF     Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       300
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      2
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.4147E-01
               RMS error according to true variance:   9.6203E-01
              Relative underestimation of variances:   7.4900E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.4147E-01
               RMS error according to true variance:   9.6203E-01
              Relative underestimation of variances:   7.4900E-01
PDAF Analysis -------------------------------------------------------
PDAF     Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       300
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      4
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8372E-01
               RMS error according to true variance:   9.5189E-01
              Relative underestimation of variances:   8.0699E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8372E-01
               RMS error according to true variance:   9.5189E-01
              Relative underestimation of variances:   8.0699E-01
PDAF Analysis -------------------------------------------------------
PDAF     Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       300
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      6
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5388E-01
               RMS error according to true variance:   9.5115E-01
              Relative underestimation of variances:   8.3822E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5388E-01
               RMS error according to true variance:   9.5115E-01
              Relative underestimation of variances:   8.3822E-01
PDAF Analysis -------------------------------------------------------
PDAF     Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       300
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      8
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3282E-01
               RMS error according to true variance:   9.4422E-01
              Relative underestimation of variances:   8.5933E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3282E-01
               RMS error according to true variance:   9.4422E-01
              Relative underestimation of variances:   8.5933E-01
PDAF Analysis -------------------------------------------------------
PDAF     Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       300
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     10
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.1850E-01
               RMS error according to true variance:   9.4326E-01
              Relative underestimation of variances:   8.7437E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.1850E-01
               RMS error according to true variance:   9.4326E-01
              Relative underestimation of variances:   8.7437E-01
PDAF Analysis -------------------------------------------------------
PDAF     Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       300
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     12
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.0796E-01
               RMS error according to true variance:   9.4268E-01
              Relative underestimation of variances:   8.8547E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.0796E-01
               RMS error according to true variance:   9.4268E-01
              Relative underestimation of variances:   8.8547E-01
PDAF Analysis -------------------------------------------------------
PDAF     Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       300
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     14
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   9.7926E-02
               RMS error according to true variance:   9.4110E-01
              Relative underestimation of variances:   8.9594E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   9.7926E-02
               RMS error according to true variance:   9.4110E-01
              Relative underestimation of variances:   8.9594E-01
PDAF Analysis -------------------------------------------------------
PDAF     Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       300
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     16
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   9.2088E-02
               RMS error according to true variance:   9.4022E-01
              Relative underestimation of variances:   9.0206E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   9.2088E-02
               RMS error according to true variance:   9.4022E-01
              Relative underestimation of variances:   9.0206E-01
PDAF Analysis -------------------------------------------------------
PDAF     Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       300
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     18
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.4728E-02
               RMS error according to true variance:   9.3915E-01
              Relative underestimation of variances:   9.0978E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.4728E-02
               RMS error according to true variance:   9.3915E-01
              Relative underestimation of variances:   9.0978E-01
PDAF Analysis -------------------------------------------------------
PDAF     Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       300
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     20
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.0894E-02
               RMS error according to true variance:   9.3875E-01
              Relative underestimation of variances:   9.1383E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.01373 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF                    state:   0.00229 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   1.14022 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.181 s
PDAF                  Time of forecasts:      0.001 s
PDAF              Time of assimilations:      0.175 s
PDAF                Time of prepoststep:      0.053 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.001 s
                  initialize filter:      0.182 s
                       assimilation:      0.229 s
                   total run time:      0.412 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         2
  PARSER: subtype=         1
  PARSER: filename= output_enkf1.dat
                     Filter: EnKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF     +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF     +++          Ensemble Kalman Filter (EnKF)          +++
PDAF     +++                                                 +++
PDAF     +++   Evensen, J. Geophys. Res. 99C (1994) 10143    +++
PDAF     +++ using an ensemble of observations according to  +++
PDAF     +++ Burgers et al., Mon. Wea. Rev. 126 (1998) 1719  +++
PDAF     +++          This implementation follows            +++
PDAF     +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF     +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF      EnKF configuration
PDAF            filter sub-type = 1
PDAF              --> EnKF with analysis for small observation dimension
PDAF              --> ensemble size:   50
PDAF          --> forgetting factor: 1.00

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use random stochastic ensemble (EnKF type)
         --- Ensemble size:   50
         --- Generate ensemble
             Rank of covar matrix =    49
PDAF     --- EnKF_omega: Normalize columns of random matrix
PDAF     --- EnKF_omega: Project columns orthogonal to (1,...,1)^T

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.9918E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   6.0082E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.9918E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   6.0082E-01
PDAF Analysis -------------------------------------------------------
        Assimilating observations - EnKF small-m version
        --- use HPH directly
        --- PE-domain      0 dimension of observation vector       300
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      2
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.4147E-01
               RMS error according to true variance:   9.6203E-01
              Relative underestimation of variances:   7.4900E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.4147E-01
               RMS error according to true variance:   9.6203E-01
              Relative underestimation of variances:   7.4900E-01
PDAF Analysis -------------------------------------------------------
        Assimilating observations - EnKF small-m version
        --- use HPH directly
        --- PE-domain      0 dimension of observation vector       300
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      4
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8372E-01
               RMS error according to true variance:   9.5189E-01
              Relative underestimation of variances:   8.0699E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8372E-01
               RMS error according to true variance:   9.5189E-01
              Relative underestimation of variances:   8.0699E-01
PDAF Analysis -------------------------------------------------------
        Assimilating observations - EnKF small-m version
        --- use HPH directly
        --- PE-domain      0 dimension of observation vector       300
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      6
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5388E-01
               RMS error according to true variance:   9.5115E-01
              Relative underestimation of variances:   8.3822E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5388E-01
               RMS error according to true variance:   9.5115E-01
              Relative underestimation of variances:   8.3822E-01
PDAF Analysis -------------------------------------------------------
        Assimilating observations - EnKF small-m version
        --- use HPH directly
        --- PE-domain      0 dimension of observation vector       300
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      8
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3282E-01
               RMS error according to true variance:   9.4422E-01
              Relative underestimation of variances:   8.5933E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3282E-01
               RMS error according to true variance:   9.4422E-01
              Relative underestimation of variances:   8.5933E-01
PDAF Analysis -------------------------------------------------------
        Assimilating observations - EnKF small-m version
        --- use HPH directly
        --- PE-domain      0 dimension of observation vector       300
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     10
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.1850E-01
               RMS error according to true variance:   9.4326E-01
              Relative underestimation of variances:   8.7437E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.1850E-01
               RMS error according to true variance:   9.4326E-01
              Relative underestimation of variances:   8.7437E-01
PDAF Analysis -------------------------------------------------------
        Assimilating observations - EnKF small-m version
        --- use HPH directly
        --- PE-domain      0 dimension of observation vector       300
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     12
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.0796E-01
               RMS error according to true variance:   9.4268E-01
              Relative underestimation of variances:   8.8547E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.0796E-01
               RMS error according to true variance:   9.4268E-01
              Relative underestimation of variances:   8.8547E-01
PDAF Analysis -------------------------------------------------------
        Assimilating observations - EnKF small-m version
        --- use HPH directly
        --- PE-domain      0 dimension of observation vector       300
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     14
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   9.7926E-02
               RMS error according to true variance:   9.4110E-01
              Relative underestimation of variances:   8.9594E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   9.7926E-02
               RMS error according to true variance:   9.4110E-01
              Relative underestimation of variances:   8.9594E-01
PDAF Analysis -------------------------------------------------------
        Assimilating observations - EnKF small-m version
        --- use HPH directly
        --- PE-domain      0 dimension of observation vector       300
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     16
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   9.2088E-02
               RMS error according to true variance:   9.4022E-01
              Relative underestimation of variances:   9.0206E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   9.2088E-02
               RMS error according to true variance:   9.4022E-01
              Relative underestimation of variances:   9.0206E-01
PDAF Analysis -------------------------------------------------------
        Assimilating observations - EnKF small-m version
        --- use HPH directly
        --- PE-domain      0 dimension of observation vector       300
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     18
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.4728E-02
               RMS error according to true variance:   9.3915E-01
              Relative underestimation of variances:   9.0978E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.4728E-02
               RMS error according to true variance:   9.3915E-01
              Relative underestimation of variances:   9.0978E-01
PDAF Analysis -------------------------------------------------------
        Assimilating observations - EnKF small-m version
        --- use HPH directly
        --- PE-domain      0 dimension of observation vector       300
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     20
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.0894E-02
               RMS error according to true variance:   9.3875E-01
              Relative underestimation of variances:   9.1383E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.01373 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF                    state:   0.00229 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   1.75172 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.119 s
PDAF                  Time of forecasts:      0.001 s
PDAF              Time of assimilations:      0.249 s
PDAF                Time of prepoststep:      0.055 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.119 s
                       assimilation:      0.305 s
                   total run time:      0.424 s

 PDAF test suite: END
--------------------------------------------------------
Run LSEIK tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         3
  PARSER: subtype=         0
  PARSER: filename= output_lseik0.dat
                     Filter: LSEIK
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  LSEIK Filter                   +++
PDAF    +++                                                 +++
PDAF    +++        Domain-localized SEIK filter by          +++
PDAF    +++   Nerger et al., Ocean Dynamics 56 (2006) 634   +++
PDAF    +++      based in the global SEIK filter by         +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LSEIK configuration
PDAF          filter sub-type = 0
PDAF            --> Standard LSEIK
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis-------------------------------------------------------
PDAF       2   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis-------------------------------------------------------
PDAF       4   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3327E-01
               RMS error according to true variance:   9.4174E-01
              Relative underestimation of variances:   7.5230E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3327E-01
               RMS error according to true variance:   9.4174E-01
              Relative underestimation of variances:   7.5230E-01
PDAF Analysis-------------------------------------------------------
PDAF       6   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0196E-01
               RMS error according to true variance:   9.3820E-01
              Relative underestimation of variances:   7.8474E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0196E-01
               RMS error according to true variance:   9.3820E-01
              Relative underestimation of variances:   7.8474E-01
PDAF Analysis-------------------------------------------------------
PDAF       8   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8059E-01
               RMS error according to true variance:   9.2848E-01
              Relative underestimation of variances:   8.0550E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8059E-01
               RMS error according to true variance:   9.2848E-01
              Relative underestimation of variances:   8.0550E-01
PDAF Analysis-------------------------------------------------------
PDAF      10   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6482E-01
               RMS error according to true variance:   9.2810E-01
              Relative underestimation of variances:   8.2241E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6482E-01
               RMS error according to true variance:   9.2810E-01
              Relative underestimation of variances:   8.2241E-01
PDAF Analysis-------------------------------------------------------
PDAF      12   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5256E-01
               RMS error according to true variance:   9.2703E-01
              Relative underestimation of variances:   8.3543E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5256E-01
               RMS error according to true variance:   9.2703E-01
              Relative underestimation of variances:   8.3543E-01
PDAF Analysis-------------------------------------------------------
PDAF      14   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4268E-01
               RMS error according to true variance:   9.2194E-01
              Relative underestimation of variances:   8.4524E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4268E-01
               RMS error according to true variance:   9.2194E-01
              Relative underestimation of variances:   8.4524E-01
PDAF Analysis-------------------------------------------------------
PDAF      16   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3449E-01
               RMS error according to true variance:   9.2044E-01
              Relative underestimation of variances:   8.5388E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3449E-01
               RMS error according to true variance:   9.2044E-01
              Relative underestimation of variances:   8.5388E-01
PDAF Analysis-------------------------------------------------------
PDAF      18   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2757E-01
               RMS error according to true variance:   9.2040E-01
              Relative underestimation of variances:   8.6140E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2757E-01
               RMS error according to true variance:   9.2040E-01
              Relative underestimation of variances:   8.6140E-01
PDAF Analysis-------------------------------------------------------
PDAF      20   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2161E-01
               RMS error according to true variance:   9.1974E-01
              Relative underestimation of variances:   8.6777E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.01373 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.02290 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.27436 MB (temporary)
PDAF               resampling:   0.16976 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.317 s
PDAF                  Time of forecasts:      0.001 s
PDAF        Time for analysis/transform:      1.692 s
PDAF                  global preparations:      0.001 s
PDAF                  local analysis loop:      1.691 s
PDAF                Time of prepoststep:      0.042 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.319 s
                       assimilation:      1.735 s
                   total run time:      2.054 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         3
  PARSER: subtype=         2
  PARSER: filename= output_lseik2.dat
                     Filter: LSEIK
      -- fixed error-space basis
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  LSEIK Filter                   +++
PDAF    +++                                                 +++
PDAF    +++        Domain-localized SEIK filter by          +++
PDAF    +++   Nerger et al., Ocean Dynamics 56 (2006) 634   +++
PDAF    +++      based in the global SEIK filter by         +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LSEIK configuration
PDAF          filter sub-type = 2
PDAF            --> fixed error-space basis
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis-------------------------------------------------------
PDAF       2   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis-------------------------------------------------------
PDAF       4   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3327E-01
               RMS error according to true variance:   9.4174E-01
              Relative underestimation of variances:   7.5230E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3327E-01
               RMS error according to true variance:   9.4174E-01
              Relative underestimation of variances:   7.5230E-01
PDAF Analysis-------------------------------------------------------
PDAF       6   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0196E-01
               RMS error according to true variance:   9.3820E-01
              Relative underestimation of variances:   7.8474E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0196E-01
               RMS error according to true variance:   9.3820E-01
              Relative underestimation of variances:   7.8474E-01
PDAF Analysis-------------------------------------------------------
PDAF       8   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8059E-01
               RMS error according to true variance:   9.2848E-01
              Relative underestimation of variances:   8.0550E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8059E-01
               RMS error according to true variance:   9.2848E-01
              Relative underestimation of variances:   8.0550E-01
PDAF Analysis-------------------------------------------------------
PDAF      10   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6482E-01
               RMS error according to true variance:   9.2810E-01
              Relative underestimation of variances:   8.2241E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6482E-01
               RMS error according to true variance:   9.2810E-01
              Relative underestimation of variances:   8.2241E-01
PDAF Analysis-------------------------------------------------------
PDAF      12   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5256E-01
               RMS error according to true variance:   9.2703E-01
              Relative underestimation of variances:   8.3543E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5256E-01
               RMS error according to true variance:   9.2703E-01
              Relative underestimation of variances:   8.3543E-01
PDAF Analysis-------------------------------------------------------
PDAF      14   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4268E-01
               RMS error according to true variance:   9.2194E-01
              Relative underestimation of variances:   8.4524E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4268E-01
               RMS error according to true variance:   9.2194E-01
              Relative underestimation of variances:   8.4524E-01
PDAF Analysis-------------------------------------------------------
PDAF      16   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3449E-01
               RMS error according to true variance:   9.2044E-01
              Relative underestimation of variances:   8.5388E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3449E-01
               RMS error according to true variance:   9.2044E-01
              Relative underestimation of variances:   8.5388E-01
PDAF Analysis-------------------------------------------------------
PDAF      18   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2757E-01
               RMS error according to true variance:   9.2040E-01
              Relative underestimation of variances:   8.6140E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2757E-01
               RMS error according to true variance:   9.2040E-01
              Relative underestimation of variances:   8.6140E-01
PDAF Analysis-------------------------------------------------------
PDAF      20   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2161E-01
               RMS error according to true variance:   9.1974E-01
              Relative underestimation of variances:   8.6777E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.01373 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.02290 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.27436 MB (temporary)
PDAF               resampling:   0.16976 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.279 s
PDAF                  Time of forecasts:      0.001 s
PDAF        Time for analysis/transform:      1.000 s
PDAF                  global preparations:      0.001 s
PDAF                  local analysis loop:      0.999 s
PDAF                Time of prepoststep:      0.057 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.281 s
                       assimilation:      1.060 s
                   total run time:      1.341 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         3
  PARSER: subtype=         3
  PARSER: filename= output_lseik3.dat
                     Filter: LSEIK
      -- fixed state covariance matrix
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  LSEIK Filter                   +++
PDAF    +++                                                 +++
PDAF    +++        Domain-localized SEIK filter by          +++
PDAF    +++   Nerger et al., Ocean Dynamics 56 (2006) 634   +++
PDAF    +++      based in the global SEIK filter by         +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LSEIK configuration
PDAF          filter sub-type = 3
PDAF            --> fixed state covariance matrix
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis-------------------------------------------------------
PDAF       2   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   5.7864E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   5.7864E-01
PDAF Analysis-------------------------------------------------------
PDAF       4   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   5.7067E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   5.7067E-01
PDAF Analysis-------------------------------------------------------
PDAF       6   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   5.7356E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   5.7356E-01
PDAF Analysis-------------------------------------------------------
PDAF       8   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   5.6909E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   5.6909E-01
PDAF Analysis-------------------------------------------------------
PDAF      10   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   5.7546E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   5.7546E-01
PDAF Analysis-------------------------------------------------------
PDAF      12   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   5.7334E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   5.7334E-01
PDAF Analysis-------------------------------------------------------
PDAF      14   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   5.6801E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   5.6801E-01
PDAF Analysis-------------------------------------------------------
PDAF      16   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Analysis-------------------------------------------------------
PDAF      18   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   5.6941E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   5.6941E-01
PDAF Analysis-------------------------------------------------------
PDAF      20   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.12646 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.02290 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.27474 MB (temporary)
PDAF               resampling:   0.18845 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.290 s
PDAF                  Time of forecasts:      0.000 s
PDAF        Time for analysis/transform:      2.844 s
PDAF                  global preparations:      0.002 s
PDAF                  local analysis loop:      2.843 s
PDAF                Time of prepoststep:      0.111 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.290 s
                       assimilation:      2.958 s
                   total run time:      3.248 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         3
  PARSER: subtype=         4
  PARSER: filename= output_lseik4.dat
                     Filter: LSEIK
      -- use ensemble transformation
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  LSEIK Filter                   +++
PDAF    +++                                                 +++
PDAF    +++        Domain-localized SEIK filter by          +++
PDAF    +++   Nerger et al., Ocean Dynamics 56 (2006) 634   +++
PDAF    +++      based in the global SEIK filter by         +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LSEIK configuration
PDAF          filter sub-type = 4
PDAF            --> SEIK with ensemble transformation
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis-------------------------------------------------------
PDAF       2   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis-------------------------------------------------------
PDAF       4   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3327E-01
               RMS error according to true variance:   9.4174E-01
              Relative underestimation of variances:   7.5230E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3327E-01
               RMS error according to true variance:   9.4174E-01
              Relative underestimation of variances:   7.5230E-01
PDAF Analysis-------------------------------------------------------
PDAF       6   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0196E-01
               RMS error according to true variance:   9.3820E-01
              Relative underestimation of variances:   7.8474E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0196E-01
               RMS error according to true variance:   9.3820E-01
              Relative underestimation of variances:   7.8474E-01
PDAF Analysis-------------------------------------------------------
PDAF       8   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8059E-01
               RMS error according to true variance:   9.2848E-01
              Relative underestimation of variances:   8.0550E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8059E-01
               RMS error according to true variance:   9.2848E-01
              Relative underestimation of variances:   8.0550E-01
PDAF Analysis-------------------------------------------------------
PDAF      10   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6482E-01
               RMS error according to true variance:   9.2810E-01
              Relative underestimation of variances:   8.2241E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6482E-01
               RMS error according to true variance:   9.2810E-01
              Relative underestimation of variances:   8.2241E-01
PDAF Analysis-------------------------------------------------------
PDAF      12   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5256E-01
               RMS error according to true variance:   9.2703E-01
              Relative underestimation of variances:   8.3543E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5256E-01
               RMS error according to true variance:   9.2703E-01
              Relative underestimation of variances:   8.3543E-01
PDAF Analysis-------------------------------------------------------
PDAF      14   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4268E-01
               RMS error according to true variance:   9.2194E-01
              Relative underestimation of variances:   8.4524E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4268E-01
               RMS error according to true variance:   9.2194E-01
              Relative underestimation of variances:   8.4524E-01
PDAF Analysis-------------------------------------------------------
PDAF      16   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3449E-01
               RMS error according to true variance:   9.2044E-01
              Relative underestimation of variances:   8.5388E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3449E-01
               RMS error according to true variance:   9.2044E-01
              Relative underestimation of variances:   8.5388E-01
PDAF Analysis-------------------------------------------------------
PDAF      18   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2757E-01
               RMS error according to true variance:   9.2040E-01
              Relative underestimation of variances:   8.6140E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2757E-01
               RMS error according to true variance:   9.2040E-01
              Relative underestimation of variances:   8.6140E-01
PDAF Analysis-------------------------------------------------------
PDAF      20   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2161E-01
               RMS error according to true variance:   9.1974E-01
              Relative underestimation of variances:   8.6777E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.01373 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.02290 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.36972 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.293 s
PDAF                  Time of forecasts:      0.001 s
PDAF        Time for analysis/transform:      2.605 s
PDAF                  global preparations:      0.001 s
PDAF                  local analysis loop:      2.604 s
PDAF                Time of prepoststep:      0.050 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.293 s
                       assimilation:      2.659 s
                   total run time:      2.952 s

 PDAF test suite: END
--------------------------------------------------------
Run ETKF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         4
  PARSER: subtype=         0
  PARSER: filename= output_etkf0.dat
                     Filter: ETKF
      -- Variant using T-matrix
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++     Ensemble Transform Kalman Filter (ETKF)     +++
PDAF    +++                                                 +++
PDAF    +++   Bishop et al., Mon. Wea. Rev. 129 (2001) 420  +++
PDAF    +++    A symmetric square root is used following    +++
PDAF    +++      Hunt et al. Physica D 230 (2007) 112       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ETKF configuration
PDAF         filter sub-type = 0
PDAF            --> ETKF using T-matrix
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      2
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      4
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      6
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      8
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     10
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     12
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     14
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     16
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     18
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     20
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.01373 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.02136 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.45015 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.293 s
PDAF                  Time of forecasts:      0.001 s
PDAF              Time for assimilation:      0.053 s
PDAF                Time of prepoststep:      0.012 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.294 s
                       assimilation:      0.067 s
                   total run time:      0.361 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         4
  PARSER: subtype=         1
  PARSER: filename= output_etkf1.dat
                     Filter: ETKF
      -- Variant following Hunt et al. (2007)
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++     Ensemble Transform Kalman Filter (ETKF)     +++
PDAF    +++                                                 +++
PDAF    +++   Bishop et al., Mon. Wea. Rev. 129 (2001) 420  +++
PDAF    +++    A symmetric square root is used following    +++
PDAF    +++      Hunt et al. Physica D 230 (2007) 112       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ETKF configuration
PDAF         filter sub-type = 1
PDAF            --> ETKF following Hunt et al. (2007)
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      2
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      4
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      6
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      8
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     10
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     12
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     14
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     16
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     18
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     20
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.01373 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.02136 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.45015 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.291 s
PDAF                  Time of forecasts:      0.001 s
PDAF              Time for assimilation:      0.037 s
PDAF                Time of prepoststep:      0.014 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.291 s
                       assimilation:      0.052 s
                   total run time:      0.343 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         4
  PARSER: subtype=         2
  PARSER: filename= output_etkf2.dat
                     Filter: ETKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++     Ensemble Transform Kalman Filter (ETKF)     +++
PDAF    +++                                                 +++
PDAF    +++   Bishop et al., Mon. Wea. Rev. 129 (2001) 420  +++
PDAF    +++    A symmetric square root is used following    +++
PDAF    +++      Hunt et al. Physica D 230 (2007) 112       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ETKF configuration
PDAF         filter sub-type = 2
PDAF            --> ETKF with fixed error-space basis
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      2
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      4
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      6
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      8
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     10
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     12
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     14
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     16
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     18
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     20
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.01373 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.02136 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.45015 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.162 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time for assimilation:      0.088 s
PDAF                Time of prepoststep:      0.053 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.163 s
                       assimilation:      0.142 s
                   total run time:      0.306 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         4
  PARSER: subtype=         3
  PARSER: filename= output_etkf3.dat
                     Filter: ETKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++     Ensemble Transform Kalman Filter (ETKF)     +++
PDAF    +++                                                 +++
PDAF    +++   Bishop et al., Mon. Wea. Rev. 129 (2001) 420  +++
PDAF    +++    A symmetric square root is used following    +++
PDAF    +++      Hunt et al. Physica D 230 (2007) 112       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ETKF configuration
PDAF         filter sub-type = 3
PDAF            --> ETKF with fixed state covariance matrix
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      2
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   5.7864E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      4
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   6.9642E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   5.7067E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   6.9846E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   5.7356E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      8
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   6.9530E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   5.6909E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     10
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   6.9980E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   5.7546E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     12
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   6.9831E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   5.7334E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     14
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   6.9453E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   5.6801E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     16
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   6.9498E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     18
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   6.9552E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   5.6941E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     20
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   6.9498E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.12760 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.02136 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.37348 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.162 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time for assimilation:      0.059 s
PDAF                Time of prepoststep:      0.074 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.163 s
                       assimilation:      0.134 s
                   total run time:      0.297 s

 PDAF test suite: END
--------------------------------------------------------
Run LETKF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         5
  PARSER: subtype=         0
  PARSER: filename= output_letkf0.dat
                     Filter: LETKF
      -- Variant using T-matrix
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Ensemble Transform Kalman Filter (LETKF)  +++
PDAF    +++                                                  +++
PDAF    +++            Domain-localized LETKF by             +++
PDAF    +++      Hunt et al., Physica D 230 (2007) 112       +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LETKF configuration
PDAF          filter sub-type = 0
PDAF            --> LETKF using T-matrix
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.01373 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.02365 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.29675 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.142 s
PDAF                  Time of forecasts:      0.001 s
PDAF        Time for analysis/transform:      7.795 s
PDAF                  global preparations:      0.001 s
PDAF                  local analysis loop:      7.794 s
PDAF                Time of prepoststep:      0.052 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.143 s
                       assimilation:      7.848 s
                   total run time:      7.992 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         5
  PARSER: subtype=         1
  PARSER: filename= output_letkf1.dat
                     Filter: LETKF
      -- Variant following Hunt et al. (2007)
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Ensemble Transform Kalman Filter (LETKF)  +++
PDAF    +++                                                  +++
PDAF    +++            Domain-localized LETKF by             +++
PDAF    +++      Hunt et al., Physica D 230 (2007) 112       +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LETKF configuration
PDAF          filter sub-type = 1
PDAF            --> LETKF following Hunt et al. (2007)
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.01373 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.02365 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.29637 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.279 s
PDAF                  Time of forecasts:      0.001 s
PDAF        Time for analysis/transform:      9.891 s
PDAF                  global preparations:      0.001 s
PDAF                  local analysis loop:      9.889 s
PDAF                Time of prepoststep:      0.064 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.001 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.288 s
                       assimilation:      9.959 s
                   total run time:     10.247 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         5
  PARSER: subtype=         2
  PARSER: filename= output_letkf2.dat
                     Filter: LETKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Ensemble Transform Kalman Filter (LETKF)  +++
PDAF    +++                                                  +++
PDAF    +++            Domain-localized LETKF by             +++
PDAF    +++      Hunt et al., Physica D 230 (2007) 112       +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LETKF configuration
PDAF          filter sub-type = 2
PDAF            --> LETKF with fixed error-space basis
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.01373 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.02365 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.29675 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.307 s
PDAF                  Time of forecasts:      0.001 s
PDAF        Time for analysis/transform:      8.005 s
PDAF                  global preparations:      0.002 s
PDAF                  local analysis loop:      8.003 s
PDAF                Time of prepoststep:      0.119 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.307 s
                       assimilation:      8.129 s
                   total run time:      8.436 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         5
  PARSER: subtype=         3
  PARSER: filename= output_letkf3.dat
                     Filter: LETKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Ensemble Transform Kalman Filter (LETKF)  +++
PDAF    +++                                                  +++
PDAF    +++            Domain-localized LETKF by             +++
PDAF    +++      Hunt et al., Physica D 230 (2007) 112       +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LETKF configuration
PDAF          filter sub-type = 3
PDAF            --> LETKF with fixed state covariance matrix
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   5.7864E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   5.7864E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   5.7067E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   5.7067E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   5.7356E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   5.7356E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   5.6909E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   5.6909E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   5.7546E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   5.7546E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   5.7334E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   5.7334E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   5.6801E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   5.6801E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   5.6941E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   5.6941E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:       300
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.12760 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.02365 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.27731 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.324 s
PDAF                  Time of forecasts:      0.000 s
PDAF        Time for analysis/transform:      2.151 s
PDAF                  global preparations:      0.001 s
PDAF                  local analysis loop:      2.149 s
PDAF                Time of prepoststep:      0.109 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.324 s
                       assimilation:      2.261 s
                   total run time:      2.585 s

 PDAF test suite: END
--------------------------------------------------------
Run ESTKF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         6
  PARSER: subtype=         0
  PARSER: filename= output_estkf0.dat
                     Filter: ESTKF
      -- Standard mode
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++ Error Subspace Transform Kalman Filter (ESTKF) +++
PDAF    +++                                                +++
PDAF    +++  Nerger et al., Mon. Wea. Rev. 140 (2012) 2335 +++
PDAF    +++           doi:10.1175/MWR-D-11-00102.1         +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ESTKF configuration
PDAF          filter sub-type = 0
PDAF            --> Standard ESTKF with ensemble integration
PDAF            --> Deterministic ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      2
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      4
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      6
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      8
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     10
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     12
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     14
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     16
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     18
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     20
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.01373 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.02061 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.52145 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.078 s
PDAF                  Time of forecasts:      0.001 s
PDAF              Time for assimilation:      0.065 s
PDAF                Time of prepoststep:      0.036 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.079 s
                       assimilation:      0.103 s
                   total run time:      0.182 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         6
  PARSER: subtype=         2
  PARSER: filename= output_estkf2.dat
                     Filter: ESTKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++ Error Subspace Transform Kalman Filter (ESTKF) +++
PDAF    +++                                                +++
PDAF    +++  Nerger et al., Mon. Wea. Rev. 140 (2012) 2335 +++
PDAF    +++           doi:10.1175/MWR-D-11-00102.1         +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ESTKF configuration
PDAF          filter sub-type = 2
PDAF            --> ESTKF with fixed error-space basis
PDAF            --> Deterministic ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      2
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      4
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      6
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      8
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     10
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     12
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     14
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     16
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     18
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     20
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.01373 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.02061 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.52145 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.138 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time for assimilation:      0.109 s
PDAF                Time of prepoststep:      0.043 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.138 s
                       assimilation:      0.153 s
                   total run time:      0.291 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         6
  PARSER: subtype=         3
  PARSER: filename= output_estkf3.dat
                     Filter: ESTKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++ Error Subspace Transform Kalman Filter (ESTKF) +++
PDAF    +++                                                +++
PDAF    +++  Nerger et al., Mon. Wea. Rev. 140 (2012) 2335 +++
PDAF    +++           doi:10.1175/MWR-D-11-00102.1         +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ESTKF configuration
PDAF          filter sub-type = 3
PDAF            --> ESTKF with fixed state covariance matrix
PDAF            --> Deterministic ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      2
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   5.7864E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      4
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   6.9642E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   5.7067E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   6.9846E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   5.7356E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step      8
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   6.9530E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   5.6909E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     10
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   6.9980E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   5.7546E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     12
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   6.9831E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   5.7334E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     14
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   6.9453E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   5.6801E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     16
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   6.9498E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     18
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   6.9552E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   5.6941E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector       300
        --- initialize observation at time step     20
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   6.9498E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.12646 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.02061 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.38947 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.291 s
PDAF                  Time of forecasts:      0.001 s
PDAF              Time for assimilation:      0.030 s
PDAF                Time of prepoststep:      0.076 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.291 s
                       assimilation:      0.107 s
                   total run time:      0.398 s

 PDAF test suite: END
--------------------------------------------------------
Run LESTKF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         7
  PARSER: subtype=         0
  PARSER: filename= output_lestkf0.dat
                     Filter: LESTKF
      -- Standard mode
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Error Subspace Transform Kalman Filter   +++
PDAF    +++                    (LESTKF)                     +++
PDAF    +++                                                 +++
PDAF    +++ Domain-localized implementation of the ESTKF by +++
PDAF    +++  Nerger et al., Mon. Wea. Rev. 140 (2012) 2335  +++
PDAF    +++           doi:10.1175/MWR-D-11-00102.1          +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LESTKF configuration
PDAF          filter sub-type = 0
PDAF            --> Standard LESTKF
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.01373 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.02290 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.40879 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.272 s
PDAF                  Time of forecasts:      0.001 s
PDAF        Time for analysis/transform:      6.053 s
PDAF                  global preparations:      0.002 s
PDAF                  local analysis loop:      6.049 s
PDAF                Time of prepoststep:      0.050 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.273 s
                       assimilation:      6.104 s
                   total run time:      6.377 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         7
  PARSER: subtype=         2
  PARSER: filename= output_lestkf2.dat
                     Filter: LESTKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Error Subspace Transform Kalman Filter   +++
PDAF    +++                    (LESTKF)                     +++
PDAF    +++                                                 +++
PDAF    +++ Domain-localized implementation of the ESTKF by +++
PDAF    +++  Nerger et al., Mon. Wea. Rev. 140 (2012) 2335  +++
PDAF    +++           doi:10.1175/MWR-D-11-00102.1          +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LESTKF configuration
PDAF          filter sub-type = 2
PDAF            --> LESTKF with fixed error-space basis
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.01373 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.02290 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.40879 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.292 s
PDAF                  Time of forecasts:      0.000 s
PDAF        Time for analysis/transform:      7.241 s
PDAF                  global preparations:      0.001 s
PDAF                  local analysis loop:      7.238 s
PDAF                Time of prepoststep:      0.091 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.293 s
                       assimilation:      7.334 s
                   total run time:      7.627 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):   300

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         7
  PARSER: subtype=         3
  PARSER: filename= output_lestkf3.dat
                     Filter: LESTKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.11.1                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Error Subspace Transform Kalman Filter   +++
PDAF    +++                    (LESTKF)                     +++
PDAF    +++                                                 +++
PDAF    +++ Domain-localized implementation of the ESTKF by +++
PDAF    +++  Nerger et al., Mon. Wea. Rev. 140 (2012) 2335  +++
PDAF    +++           doi:10.1175/MWR-D-11-00102.1          +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LESTKF configuration
PDAF          filter sub-type = 3
PDAF            --> LESTKF with fixed state covariance matrix
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analize initial state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   5.7864E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   5.7864E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   5.7067E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   5.7067E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   5.7356E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   5.7356E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   5.6909E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   5.6909E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   5.7546E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   5.7546E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   5.7334E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   5.7334E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   5.6801E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   5.6801E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   5.6941E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analize forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   5.6941E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:       300
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analize assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00229 MB (persistent)
            ensemble init:   0.24795 MB (temporary)
             Pre-Poststep:   0.12646 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.02290 MB (persistent)
PDAF           ensemble array:   0.11444 MB (persistent)
PDAF            analysis step:   0.31419 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.295 s
PDAF                  Time of forecasts:      0.000 s
PDAF        Time for analysis/transform:      3.468 s
PDAF                  global preparations:      0.001 s
PDAF                  local analysis loop:      3.467 s
PDAF                Time of prepoststep:      0.133 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.296 s
                       assimilation:      3.602 s
                   total run time:      3.898 s

 PDAF test suite: END
PDAF tests completed:  Fri Jun 12 14:45:02 CEST 2015
