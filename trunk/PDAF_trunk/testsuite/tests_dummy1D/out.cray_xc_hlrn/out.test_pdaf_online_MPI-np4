
********************************************************************************
* Batch Job Information:                                                       *
********************************************************************************
Moab ID:                berlin.2651848
Torque ID:              2540519.bbatch.hsn.hlrn.de
Job Name:               pdaftest
HLRN Complex:           berlin
User Name:              hzfblner
HLRN Project Account:   hzfblner
Batch Class:            mpp1smallq
Number of Nodes:        1
Node List:              b00015
Start Time:             Thu Jul 4 13:05:49 CEST 2019
MOM Node:               bxcmom01
Submission Directory:   /home/hzfblner/PDAF-D_V1.14/testsuite/bin
********************************************************************************

********************************************************************************
*                                                                              *
*                 Welcome to HLRN-III Complex Berlin                           *
*                 This is node bxcmom01 on "Konrad"                            *
*                                                                              *
* Documentation:  https://www.hlrn.de/home/view/Service/WebHome                *
* Support:        mailto:support@hlrn.de                                       *
*                                                                              *
********************************************************************************
Module sw.mpp1 loaded.
Module HLRNenv loaded
====================  Testing PDAF  ====================
Machine:  Linux bxcmom01 3.0.101-0.46.1_1.0502.8871-cray_ari_s #1 SMP Mon Oct 8 17:45:41 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux
Date:  Thu Jul 4 13:05:51 CEST 2019
--------------------------------------------------------
Run SEEK tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     3              2      1      2      1       F
     2              2      0      1      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        49
  PARSER: filtertype=         0
  PARSER: subtype=         0
  PARSER: filename= output_par_seek0.dat

                     Filter: SEEK
             number of EOFs:   49
      Assimilation interval:    2
          forgetting factor: 1.00
          Re-diag each    1-th analysis step

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF     +++                  SEEK Filter                   +++
PDAF     +++                                                +++
PDAF     +++    Pham et al., J. Mar. Syst. 16 (1998) 323    +++
PDAF     +++          This implementation follows           +++
PDAF     +++      Nerger et al., Tellus 57A (2005) 715      +++
PDAF     +++                                                +++
PDAF     +++ NOTE: The SEEK filter in PDAF is deprecated    +++
PDAF     +++       as of Version 1.14. It will be removed   +++
PDAF     +++       in the future.                           +++
PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEEK configuration
PDAF          filter sub-type = 0
PDAF            --> Standard SEEK with unit modes
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> number of EOFs:   49
PDAF          Re-diag at each analysis step

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    24
PDAF   Evolve central state on task:   2

PDAF: Call routine for ensemble initialization

         Initialize state estimate and EOF decomposed covariance matrix
         --- number of EOFs:   49

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state and error space basis
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      2
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state and error space basis
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecast state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      4
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state and error space basis
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecast state ensemble
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      6
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state and error space basis
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecast state ensemble
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      8
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state and error space basis
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecast state ensemble
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     10
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state and error space basis
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecast state ensemble
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     12
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state and error space basis
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecast state ensemble
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     14
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state and error space basis
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecast state ensemble
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     16
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state and error space basis
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecast state ensemble
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     18
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state and error space basis
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecast state ensemble
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     20
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  1
 model PE exited: mype  2
 model PE exited: mype  3






PDAF                     PDAF Timing information

 PDAF test suite: EXITED ASSIMILATION
PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF          ---------------------------------------------

PDAF          ---------------------------------------------
PDAF                  EOF initialization (1):      0.001 s
PDAF          ---------------------------------------------
PDAF                   Time of forecasts (2):      0.076 s
PDAF                  EOF initialization (1):      0.000 s
PDAF                  EOF initialization (1):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF                   Time of forecasts (2):      2.207 s
PDAF               Time of assimilations (3):      0.129 s
PDAF       Time to collect/distribute ens (19):      2.206 s
PDAF                   Time of forecasts (2):      2.206 s
PDAF                         get residual (12):      0.127 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF                        compute new U (10):      0.002 s
PDAF       Time to collect/distribute ens (19):      2.131 s
PDAF                       solve for gain (13):      0.001 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF                         update state (14):      0.000 s
PDAF                re-diagonalize covar (4):      0.005 s
PDAF                 prepare mode weights (20):      0.003 s
PDAF                   gather mode matrix (21):      0.001 s
PDAF                   update mode matrix (22):      0.001 s
PDAF                 Time of prepoststep (5):      0.006 s
                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.17204 MB (temporary)
             Pre-Poststep:   0.14096 MB (temporary)


PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and U:      0.019 MiB (persistent)
PDAF         covariance modes:      0.056 MiB (persistent)
PDAF            analysis step:      0.173 MiB (temporary)
PDAF         reinitialization:      0.113 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF                  EOF initialization (1):      0.000 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time of assimilations (3):      0.004 s
PDAF                         get residual (12):      0.001 s
PDAF                        compute new U (10):      0.002 s
PDAF                                  H V_p (30):      0.000 s
PDAF                          complete Uinv (31):      0.008 s
PDAF                       solve for gain (13):      0.001 s
PDAF                         update state (14):      0.000 s
PDAF                re-diagonalize covar (4):      0.005 s
PDAF                 prepare mode weights (20):      0.004 s
PDAF                            invert Uinv (32):      0.002 s
PDAF                                SQRT(U) (33):      0.001 s
PDAF                   gather mode matrix (21):      0.000 s
PDAF                   update mode matrix (22):      0.001 s
PDAF                 Time of prepoststep (5):      2.226 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      2.236 s
                   total run time:      2.239 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF                  EOF initialization (1):      0.000 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time of assimilations (3):      0.004 s
PDAF                         get residual (12):      0.001 s
PDAF                        compute new U (10):      0.002 s
PDAF                       solve for gain (13):      0.001 s
PDAF                         update state (14):      0.000 s
PDAF                re-diagonalize covar (4):      0.005 s
PDAF                 prepare mode weights (20):      0.004 s
PDAF                   gather mode matrix (21):      0.000 s
PDAF                   update mode matrix (22):      0.001 s
PDAF                 Time of prepoststep (5):      2.226 s
Application 8683229 resources: utime ~7s, stime ~1s, Rss ~8460, inblocks ~33525, outblocks ~124003

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2              2      0      1      1       F
     3              2      1      2      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        49
  PARSER: filtertype=         0
  PARSER: subtype=         1
  PARSER: filename= output_par_seek1.dat

                     Filter: SEEK
             number of EOFs:   49
      Assimilation interval:    2
          forgetting factor: 1.00
          Re-diag each    1-th analysis step

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF     +++                  SEEK Filter                   +++
PDAF     +++                                                +++
PDAF     +++    Pham et al., J. Mar. Syst. 16 (1998) 323    +++
PDAF     +++          This implementation follows           +++
PDAF     +++      Nerger et al., Tellus 57A (2005) 715      +++
PDAF     +++                                                +++
PDAF     +++ NOTE: The SEEK filter in PDAF is deprecated    +++
PDAF     +++       as of Version 1.14. It will be removed   +++
PDAF     +++       in the future.                           +++
PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEEK configuration
PDAF          filter sub-type = 1
PDAF            --> SEEK with non-unit modes
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> number of EOFs:   49
PDAF          Re-diag at each analysis step

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    24
PDAF   Evolve central state on task:   2

PDAF: Call routine for ensemble initialization

         Initialize state estimate and EOF decomposed covariance matrix
         --- number of EOFs:   49

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state and error space basis
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      2
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state and error space basis
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecast state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      4
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state and error space basis
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecast state ensemble
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      6
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state and error space basis
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecast state ensemble
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      8
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state and error space basis
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecast state ensemble
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     10
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state and error space basis
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecast state ensemble
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     12
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state and error space basis
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecast state ensemble
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     14
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state and error space basis
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecast state ensemble
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     16
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state and error space basis
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecast state ensemble
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     18
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state and error space basis
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecast state ensemble
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     20
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  3
 model PE exited: mype  2
 model PE exited: mype  1







PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF                  EOF initialization (1):      0.000 s
PDAF                  EOF initialization (1):      0.000 s
PDAF                   Time of forecasts (2):      0.447 s
PDAF                   Time of forecasts (2):      0.447 s
PDAF                  EOF initialization (1):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.325 s
PDAF                   Time of forecasts (2):      0.123 s
PDAF       Time to collect/distribute ens (19):      0.447 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF               Time of assimilations (3):      0.140 s
 PDAF test suite: EXITED ASSIMILATION
PDAF                         get residual (12):      0.138 s
PDAF                        compute new U (10):      0.002 s
PDAF                       solve for gain (13):      0.001 s
PDAF                         update state (14):      0.000 s
PDAF                re-diagonalize covar (4):      0.005 s
PDAF                 prepare mode weights (20):      0.003 s
PDAF                   gather mode matrix (21):      0.001 s
PDAF                   update mode matrix (22):      0.001 s
PDAF                 Time of prepoststep (5):      0.006 s

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.17204 MB (temporary)
             Pre-Poststep:   0.14096 MB (temporary)


PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and U:      0.019 MiB (persistent)
PDAF         covariance modes:      0.056 MiB (persistent)
PDAF            analysis step:      0.173 MiB (temporary)
PDAF         reinitialization:      0.113 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF                  EOF initialization (1):      0.000 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time of assimilations (3):      0.004 s
PDAF                         get residual (12):      0.001 s
PDAF                        compute new U (10):      0.002 s
PDAF                                  H V_p (30):      0.000 s
PDAF                          complete Uinv (31):      0.008 s
PDAF                       solve for gain (13):      0.001 s
PDAF                         update state (14):      0.000 s
PDAF                re-diagonalize covar (4):      0.005 s
PDAF                 prepare mode weights (20):      0.004 s
PDAF                            invert Uinv (32):      0.002 s
PDAF                                SQRT(U) (33):      0.001 s
PDAF                   gather mode matrix (21):      0.000 s
PDAF                   update mode matrix (22):      0.001 s
PDAF                 Time of prepoststep (5):      0.466 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.476 s
                   total run time:      0.478 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF                  EOF initialization (1):      0.000 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time of assimilations (3):      0.004 s
PDAF                         get residual (12):      0.001 s
PDAF                        compute new U (10):      0.002 s
PDAF                       solve for gain (13):      0.001 s
PDAF                         update state (14):      0.000 s
PDAF                re-diagonalize covar (4):      0.005 s
PDAF                 prepare mode weights (20):      0.004 s
PDAF                   gather mode matrix (21):      0.000 s
PDAF                   update mode matrix (22):      0.001 s
PDAF                 Time of prepoststep (5):      0.466 s
Application 8683230 resources: utime ~2s, stime ~1s, Rss ~8460, inblocks ~33525, outblocks ~124003

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         1

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     3       3      1      3      4      0       T
     2       2      1      2      3      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  4 PEs
     task   1 PE(model)   0 dim_local(state):    75
     task   1 PE(model)   1 dim_local(state):    75
     task   1 PE(model)   2 dim_local(state):    75
     task   1 PE(model)   3 dim_local(state):    75

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        49
  PARSER: filtertype=         0
  PARSER: subtype=         2
  PARSER: filename= output_par_seek2.dat

                     Filter: SEEK
      -- fixed basis filter with update of matrix U
      -- no re-diagonalization of VUV^T
             number of EOFs:   49
      Assimilation interval:    2
          forgetting factor: 1.00
          Re-diag each    1-th analysis step

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF     +++                  SEEK Filter                   +++
PDAF     +++                                                +++
PDAF     +++    Pham et al., J. Mar. Syst. 16 (1998) 323    +++
PDAF     +++          This implementation follows           +++
PDAF     +++      Nerger et al., Tellus 57A (2005) 715      +++
PDAF     +++                                                +++
PDAF     +++ NOTE: The SEEK filter in PDAF is deprecated    +++
PDAF     +++       as of Version 1.14. It will be removed   +++
PDAF     +++       in the future.                           +++
PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEEK configuration
PDAF          filter sub-type = 2
PDAF            --> fixed basis filter with update of matrix U
PDAF            --> no re-diagonalization of VUV^T
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> number of EOFs:   49

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      4
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     4
PDAF        N    49
PDAF   Evolve central state on task:   1

PDAF: Call routine for ensemble initialization

         Initialize state estimate and EOF decomposed covariance matrix
         --- number of EOFs:   49

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      2
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecast state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecast state ensemble
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecast state ensemble
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      8
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecast state ensemble
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     10
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecast state ensemble
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     12
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecast state ensemble
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     14
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecast state ensemble
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     16
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecast state ensemble
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     18
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecast state ensemble
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     20
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  1
 model PE exited: mype  3
 model PE exited: mype  2


 PDAF test suite: EXITED ASSIMILATION





PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF                     PDAF Timing information

PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF                  EOF initialization (1):      0.001 s
PDAF                  EOF initialization (1):      0.001 s
PDAF                  EOF initialization (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time of assimilations (3):      0.176 s
PDAF               Time of assimilations (3):      0.176 s
PDAF                         get residual (12):      0.174 s
PDAF               Time of assimilations (3):      0.176 s
PDAF                        compute new U (10):      0.001 s
PDAF                         get residual (12):      0.174 s
PDAF                       solve for gain (13):      0.001 s
PDAF                         get residual (12):      0.174 s
PDAF                        compute new U (10):      0.001 s
PDAF                         update state (14):      0.000 s
PDAF                       solve for gain (13):      0.001 s
PDAF                        compute new U (10):      0.001 s
PDAF                re-diagonalize covar (4):      0.000 s
PDAF                         update state (14):      0.000 s
PDAF                       solve for gain (13):      0.001 s
PDAF                 prepare mode weights (20):      0.000 s
PDAF                re-diagonalize covar (4):      0.000 s
PDAF                         update state (14):      0.000 s
PDAF                   gather mode matrix (21):      0.000 s
PDAF                 prepare mode weights (20):      0.000 s
PDAF                re-diagonalize covar (4):      0.000 s
PDAF                   update mode matrix (22):      0.000 s
PDAF                   gather mode matrix (21):      0.000 s
PDAF                 Time of prepoststep (5):      0.004 s
PDAF                   update mode matrix (22):      0.000 s
PDAF                 prepare mode weights (20):      0.000 s
PDAF                 Time of prepoststep (5):      0.004 s
PDAF                   gather mode matrix (21):      0.000 s
PDAF                   update mode matrix (22):      0.000 s
PDAF                 Time of prepoststep (5):      0.004 s
                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00059 MB (persistent)
            ensemble init:   0.14342 MB (temporary)
             Pre-Poststep:   0.13924 MB (temporary)


PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and U:      0.019 MiB (persistent)
PDAF         covariance modes:      0.028 MiB (persistent)
PDAF            analysis step:      0.114 MiB (temporary)
PDAF         reinitialization:      0.000 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF                  EOF initialization (1):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time of assimilations (3):      0.003 s
PDAF                         get residual (12):      0.001 s
PDAF                        compute new U (10):      0.001 s
PDAF                                  H V_p (30):      0.000 s
PDAF                          complete Uinv (31):      0.001 s
PDAF                       solve for gain (13):      0.001 s
PDAF                         update state (14):      0.000 s
PDAF                re-diagonalize covar (4):      0.000 s
PDAF                 prepare mode weights (20):      0.000 s
PDAF                            invert Uinv (32):      0.000 s
PDAF                                SQRT(U) (33):      0.000 s
PDAF                   gather mode matrix (21):      0.000 s
PDAF                   update mode matrix (22):      0.000 s
PDAF                 Time of prepoststep (5):      0.343 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.347 s
                   total run time:      0.350 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF                  EOF initialization (1):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time of assimilations (3):      0.003 s
PDAF                         get residual (12):      0.001 s
PDAF                        compute new U (10):      0.001 s
PDAF                       solve for gain (13):      0.001 s
PDAF                         update state (14):      0.000 s
PDAF                re-diagonalize covar (4):      0.000 s
PDAF                 prepare mode weights (20):      0.000 s
PDAF                   gather mode matrix (21):      0.000 s
PDAF                   update mode matrix (22):      0.000 s
PDAF                 Time of prepoststep (5):      0.343 s
Application 8683231 resources: utime ~2s, stime ~1s, Rss ~8460, inblocks ~33525, outblocks ~124003

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         1

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2       2      1      2      3      0       T
     3       3      1      3      4      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  4 PEs
     task   1 PE(model)   0 dim_local(state):    75
     task   1 PE(model)   1 dim_local(state):    75
     task   1 PE(model)   2 dim_local(state):    75
     task   1 PE(model)   3 dim_local(state):    75

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        49
  PARSER: filtertype=         0
  PARSER: subtype=         3
  PARSER: filename= output_par_seek3.dat

                     Filter: SEEK
      -- fixed basis filter & no update of matrix U
      -- no re-diagonalization of VUV^T
             number of EOFs:   49
      Assimilation interval:    2
          forgetting factor: 1.00
          Re-diag each    1-th analysis step

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF     +++                  SEEK Filter                   +++
PDAF     +++                                                +++
PDAF     +++    Pham et al., J. Mar. Syst. 16 (1998) 323    +++
PDAF     +++          This implementation follows           +++
PDAF     +++      Nerger et al., Tellus 57A (2005) 715      +++
PDAF     +++                                                +++
PDAF     +++ NOTE: The SEEK filter in PDAF is deprecated    +++
PDAF     +++       as of Version 1.14. It will be removed   +++
PDAF     +++       in the future.                           +++
PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEEK configuration
PDAF          filter sub-type = 3
PDAF            --> fixed basis filter & no update of matrix U
PDAF            --> no re-diagonalization of VUV^T
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> number of EOFs:   49

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      4
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     4
PDAF        N    49
PDAF   Evolve central state on task:   1

PDAF: Call routine for ensemble initialization

         Initialize state estimate and EOF decomposed covariance matrix
         --- number of EOFs:   49

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      2
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   5.7864E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   6.9642E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   5.7067E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   6.9846E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   5.7356E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      8
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   6.9530E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   5.6909E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     10
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   6.9980E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   5.7546E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     12
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   6.9831E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   5.7334E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     14
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   6.9453E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   5.6801E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     16
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   6.9498E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     18
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   6.9552E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecast state ensemble
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   5.6941E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     20
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   6.9498E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  1
 model PE exited: mype  2
 model PE exited: mype  3






PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF                     PDAF Timing information

PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF                  EOF initialization (1):      0.001 s
PDAF                  EOF initialization (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF                  EOF initialization (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF               Time of assimilations (3):      0.186 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF                         get residual (12):      0.184 s
PDAF               Time of assimilations (3):      0.186 s
PDAF               Time of assimilations (3):      0.186 s
PDAF                        compute new U (10):      0.001 s
PDAF                         get residual (12):      0.184 s
PDAF                         get residual (12):      0.184 s
PDAF                       solve for gain (13):      0.001 s
PDAF                        compute new U (10):      0.001 s
PDAF                        compute new U (10):      0.001 s
PDAF                       solve for gain (13):      0.001 s
PDAF                         update state (14):      0.000 s
PDAF                         update state (14):      0.000 s
PDAF                       solve for gain (13):      0.001 s
PDAF                re-diagonalize covar (4):      0.000 s
PDAF                re-diagonalize covar (4):      0.000 s
PDAF                 prepare mode weights (20):      0.000 s
PDAF                         update state (14):      0.000 s
PDAF                   gather mode matrix (21):      0.000 s
PDAF                 prepare mode weights (20):      0.000 s
PDAF                re-diagonalize covar (4):      0.000 s
PDAF                   gather mode matrix (21):      0.000 s
PDAF                 prepare mode weights (20):      0.000 s
PDAF                   update mode matrix (22):      0.000 s
PDAF                 Time of prepoststep (5):      0.004 s
PDAF                   gather mode matrix (21):      0.000 s
PDAF                   update mode matrix (22):      0.000 s
PDAF                 Time of prepoststep (5):      0.004 s
 PDAF test suite: EXITED ASSIMILATION
PDAF                   update mode matrix (22):      0.000 s
PDAF                 Time of prepoststep (5):      0.004 s

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00059 MB (persistent)
            ensemble init:   0.14342 MB (temporary)
             Pre-Poststep:   0.13924 MB (temporary)


PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and U:      0.019 MiB (persistent)
PDAF         covariance modes:      0.028 MiB (persistent)
PDAF            analysis step:      0.114 MiB (temporary)
PDAF         reinitialization:      0.000 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF                  EOF initialization (1):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time of assimilations (3):      0.003 s
PDAF                         get residual (12):      0.001 s
PDAF                        compute new U (10):      0.001 s
PDAF                                  H V_p (30):      0.000 s
PDAF                          complete Uinv (31):      0.001 s
PDAF                       solve for gain (13):      0.001 s
PDAF                         update state (14):      0.000 s
PDAF                re-diagonalize covar (4):      0.000 s
PDAF                 prepare mode weights (20):      0.000 s
PDAF                            invert Uinv (32):      0.000 s
PDAF                                SQRT(U) (33):      0.000 s
PDAF                   gather mode matrix (21):      0.000 s
PDAF                   update mode matrix (22):      0.000 s
PDAF                 Time of prepoststep (5):      0.390 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.395 s
                   total run time:      0.397 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF                  EOF initialization (1):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time of assimilations (3):      0.003 s
PDAF                         get residual (12):      0.001 s
PDAF                        compute new U (10):      0.001 s
PDAF                       solve for gain (13):      0.001 s
PDAF                         update state (14):      0.000 s
PDAF                re-diagonalize covar (4):      0.000 s
PDAF                 prepare mode weights (20):      0.000 s
PDAF                   gather mode matrix (21):      0.000 s
PDAF                   update mode matrix (22):      0.000 s
PDAF                 Time of prepoststep (5):      0.390 s
Application 8683232 resources: utime ~2s, stime ~0s, Rss ~8460, inblocks ~33525, outblocks ~124003
--------------------------------------------------------
Run SEIK tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2              2      0      1      1       F
     3              2      1      2      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         1
  PARSER: subtype=         0
  PARSER: filename= output_par_seik0.dat
                     Filter: SEIK
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  SEIK Filter                    +++
PDAF    +++                                                 +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++          This implementation follows            +++
PDAF    +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEIK configuration
PDAF          filter sub-type = 0
PDAF            --> Standard SEIK
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      2
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      4
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      6
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      8
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     10
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     12
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     14
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     16
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     18
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     20
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  1
 model PE exited: mype  3
 model PE exited: mype  2







PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
 PDAF test suite: EXITED ASSIMILATION
PDAF          ---------------------------------------------

PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.095 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF                   Time of forecasts (2):      0.374 s
PDAF                   Time of forecasts (2):      0.374 s
PDAF       Time to collect/distribute ens (19):      0.280 s
PDAF               Time for assimilation (3):      0.130 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF                       get mean state (11):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.374 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.127 s
PDAF                             update U (10):      0.002 s
PDAF              get state weight vector (13):      0.001 s
PDAF                         update state (14):      0.000 s
                  Model - Memory overview
PDAF             ensemble transformation (4):      0.002 s
PDAF             prepare ensemble weights (20):      0.001 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.001 s
PDAF                 Time of prepoststep (5):      0.000 s
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.28648 MB (temporary)
             Pre-Poststep:   0.00916 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and U:      0.019 MiB (persistent)
PDAF           ensemble array:      0.057 MiB (persistent)
PDAF            analysis step:      0.287 MiB (temporary)
PDAF                resampling:     0.151 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.005 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.001 s
PDAF                             update U (10):      0.002 s
PDAF                                   HL_p (30):      0.000 s
PDAF                          complete Uinv (31):      0.002 s
PDAF              get state weight vector (13):      0.002 s
PDAF                         update state (14):      0.000 s
PDAF             ensemble transformation (4):      0.003 s
PDAF             prepare ensemble weights (20):      0.002 s
PDAF                             SQRT(Uinv) (32):      0.001 s
PDAF                             init Omega (33):      0.000 s
PDAF                      compute Ct OmegaT (34):      0.001 s
PDAF                       complete weights (35):      0.000 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.001 s
PDAF                 Time of prepoststep (5):      0.393 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.403 s
                   total run time:      0.406 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.005 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.001 s
PDAF                             update U (10):      0.002 s
PDAF              get state weight vector (13):      0.002 s
PDAF                         update state (14):      0.000 s
PDAF             ensemble transformation (4):      0.003 s
PDAF             prepare ensemble weights (20):      0.002 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.001 s
PDAF                 Time of prepoststep (5):      0.393 s
Application 8683233 resources: utime ~2s, stime ~0s, Rss ~8460, inblocks ~33525, outblocks ~124008

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     3              2      1      2      1       F
     2              2      0      1      1       F
     1       1      1      1      2      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         1
  PARSER: subtype=         1
  PARSER: filename= output_par_seik1.dat
                     Filter: SEIK
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  SEIK Filter                    +++
PDAF    +++                                                 +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++          This implementation follows            +++
PDAF    +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEIK configuration
PDAF          filter sub-type = 1
PDAF            --> Standard SEIK - old formulation
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      2
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector       150
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      4
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector       150
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      6
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector       150
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      8
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector       150
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     10
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector       150
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     12
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector       150
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     14
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector       150
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     16
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector       150
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     18
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      1 dimension of observation vector       150
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     20
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0

 model PE exited: mype  2
 model PE exited: mype  3
 model PE exited: mype  1
 PDAF test suite: EXITED ASSIMILATION




PDAF                     PDAF Timing information

PDAF                     PDAF Timing information


PDAF          ---------------------------------------------
PDAF                     PDAF Timing information
                  Model - Memory overview
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.000 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF                   Time of forecasts (2):      0.302 s
PDAF                   Time of forecasts (2):      0.302 s
PDAF       Time to collect/distribute ens (19):      0.301 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF       Time to collect/distribute ens (19):      0.274 s
PDAF          ---------------------------------------------
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
          ---------------------------------------------
                     Allocated memory  (MB)
PDAF             Generate state ensemble (1):      0.001 s
              Model field:   0.00115 MB (persistent)
PDAF                   Time of forecasts (2):      0.028 s
            ensemble init:   0.28648 MB (temporary)
             Pre-Poststep:   0.00916 MB (temporary)
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.127 s

PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.123 s
PDAF                             update U (10):      0.002 s
PDAF              get state weight vector (13):      0.002 s
PDAF                         update state (14):      0.000 s
PDAF                       PDAF Memory overview
PDAF             ensemble transformation (4):      0.003 s
PDAF             prepare ensemble weights (20):      0.001 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF          ---------------------------------------------
PDAF                      update ensemble (22):      0.001 s
PDAF                     Allocated memory  (MiB)
PDAF                 Time of prepoststep (5):      0.000 s
PDAF              state and U:      0.019 MiB (persistent)
PDAF           ensemble array:      0.057 MiB (persistent)
PDAF            analysis step:      0.285 MiB (temporary)
PDAF                resampling:     0.132 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.004 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.000 s
PDAF                             update U (10):      0.002 s
PDAF                                   HL_p (30):      0.000 s
PDAF                          complete Uinv (31):      0.002 s
PDAF              get state weight vector (13):      0.001 s
PDAF                         update state (14):      0.000 s
PDAF             ensemble transformation (4):      0.002 s
PDAF             prepare ensemble weights (20):      0.001 s
PDAF                             SQRT(Uinv) (32):      0.001 s
PDAF                             init Omega (33):      0.000 s
PDAF                      compute Ct OmegaT (34):      0.000 s
PDAF                       complete weights (35):      0.000 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.001 s
PDAF                 Time of prepoststep (5):      0.325 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.332 s
                   total run time:      0.335 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.004 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.000 s
PDAF                             update U (10):      0.002 s
PDAF              get state weight vector (13):      0.001 s
PDAF                         update state (14):      0.000 s
PDAF             ensemble transformation (4):      0.002 s
PDAF             prepare ensemble weights (20):      0.001 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.001 s
PDAF                 Time of prepoststep (5):      0.325 s
Application 8683234 resources: utime ~2s, stime ~0s, Rss ~8460, inblocks ~33525, outblocks ~124009

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         1

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     2       2      1      2      3      0       T
     1       1      1      1      2      0       T
     3       3      1      3      4      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  4 PEs
     task   1 PE(model)   0 dim_local(state):    75
     task   1 PE(model)   1 dim_local(state):    75
     task   1 PE(model)   2 dim_local(state):    75
     task   1 PE(model)   3 dim_local(state):    75

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         1
  PARSER: subtype=         2
  PARSER: filename= output_par_seik2.dat
                     Filter: SEIK
      -- fixed error-space basis
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  SEIK Filter                    +++
PDAF    +++                                                 +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++          This implementation follows            +++
PDAF    +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEIK configuration
PDAF          filter sub-type = 2
PDAF            --> fixed error-space basis
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      4
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     4
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega
PDAF     --- PE-domain      1 dimension of observation vector        75

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
PDAF     --- PE-domain      3 dimension of observation vector        75
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      2
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      4
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      6
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      8
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     10
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     12
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     14
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     16
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     18
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     20
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  2
 model PE exited: mype  3
 model PE exited: mype  1





PDAF                     PDAF Timing information

PDAF                     PDAF Timing information

PDAF                     PDAF Timing information
 PDAF test suite: EXITED ASSIMILATION
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF          ---------------------------------------------
PDAF                   Time of forecasts (2):      0.000 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF               Time for assimilation (3):      0.249 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF                       get mean state (11):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.249 s
PDAF           init observation dimension (15):      0.000 s
PDAF               Time for assimilation (3):      0.249 s
PDAF                       get mean state (11):      0.000 s
PDAF                        init residual (12):      0.245 s
PDAF                       get mean state (11):      0.000 s
PDAF                             update U (10):      0.002 s
PDAF           init observation dimension (15):      0.000 s
PDAF              get state weight vector (13):      0.002 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.245 s
PDAF                         update state (14):      0.000 s
PDAF                        init residual (12):      0.245 s
PDAF                             update U (10):      0.002 s
PDAF             ensemble transformation (4):      0.002 s
PDAF                             update U (10):      0.002 s
PDAF              get state weight vector (13):      0.002 s
PDAF             prepare ensemble weights (20):      0.001 s
PDAF              get state weight vector (13):      0.002 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                         update state (14):      0.000 s
PDAF                         update state (14):      0.000 s
PDAF                      update ensemble (22):      0.000 s
PDAF             ensemble transformation (4):      0.002 s
PDAF                 Time of prepoststep (5):      0.000 s
PDAF             ensemble transformation (4):      0.002 s
PDAF             prepare ensemble weights (20):      0.001 s
PDAF             prepare ensemble weights (20):      0.001 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.000 s
PDAF                      update ensemble (22):      0.000 s
PDAF                 Time of prepoststep (5):      0.000 s
PDAF                 Time of prepoststep (5):      0.000 s

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00059 MB (persistent)
            ensemble init:   0.25787 MB (temporary)
             Pre-Poststep:   0.00687 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and U:      0.019 MiB (persistent)
PDAF           ensemble array:      0.029 MiB (persistent)
PDAF            analysis step:      0.227 MiB (temporary)
PDAF                resampling:     0.151 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.004 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.001 s
PDAF                             update U (10):      0.002 s
PDAF                                   HL_p (30):      0.000 s
PDAF                          complete Uinv (31):      0.001 s
PDAF              get state weight vector (13):      0.002 s
PDAF                         update state (14):      0.000 s
PDAF             ensemble transformation (4):      0.003 s
PDAF             prepare ensemble weights (20):      0.002 s
PDAF                             SQRT(Uinv) (32):      0.001 s
PDAF                             init Omega (33):      0.000 s
PDAF                      compute Ct OmegaT (34):      0.001 s
PDAF                       complete weights (35):      0.000 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.000 s
PDAF                 Time of prepoststep (5):      0.433 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.442 s
                   total run time:      0.445 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.004 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.001 s
PDAF                             update U (10):      0.002 s
PDAF              get state weight vector (13):      0.002 s
PDAF                         update state (14):      0.000 s
PDAF             ensemble transformation (4):      0.003 s
PDAF             prepare ensemble weights (20):      0.002 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.000 s
PDAF                 Time of prepoststep (5):      0.433 s
Application 8683235 resources: utime ~2s, stime ~0s, Rss ~8460, inblocks ~33525, outblocks ~124012

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         1

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     3       3      1      3      4      0       T
     2       2      1      2      3      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  4 PEs
     task   1 PE(model)   0 dim_local(state):    75
     task   1 PE(model)   1 dim_local(state):    75
     task   1 PE(model)   2 dim_local(state):    75
     task   1 PE(model)   3 dim_local(state):    75

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         1
  PARSER: subtype=         3
  PARSER: filename= output_par_seik3.dat
                     Filter: SEIK
      -- fixed state covariance matrix
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  SEIK Filter                    +++
PDAF    +++                                                 +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++          This implementation follows            +++
PDAF    +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEIK configuration
PDAF          filter sub-type = 3
PDAF            --> fixed state covariance matrix
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      4
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     4
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      2
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   5.7864E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      4
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   6.9642E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   5.7067E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      6
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   6.9846E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   5.7356E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      8
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   6.9530E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   5.6909E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     10
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   6.9980E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   5.7546E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     12
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   6.9831E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   5.7334E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     14
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   6.9453E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   5.6801E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     16
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   6.9498E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     18
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   6.9552E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   5.6941E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     20
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   6.9498E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  3
 model PE exited: mype  2
 model PE exited: mype  1







PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
 PDAF test suite: EXITED ASSIMILATION

PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.204 s
PDAF               Time for assimilation (3):      0.204 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF                       get mean state (11):      0.000 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF               Time for assimilation (3):      0.204 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.202 s
PDAF                        init residual (12):      0.202 s
PDAF                       get mean state (11):      0.000 s
PDAF                             update U (10):      0.001 s
PDAF                             update U (10):      0.001 s
PDAF              get state weight vector (13):      0.001 s
PDAF              get state weight vector (13):      0.001 s
PDAF           init observation dimension (15):      0.000 s
PDAF                         update state (14):      0.000 s
PDAF                         update state (14):      0.000 s
PDAF                        init residual (12):      0.202 s
PDAF             ensemble transformation (4):      0.002 s
PDAF             ensemble transformation (4):      0.002 s
PDAF                             update U (10):      0.002 s
PDAF             prepare ensemble weights (20):      0.001 s
PDAF              get state weight vector (13):      0.001 s
PDAF             prepare ensemble weights (20):      0.001 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                         update state (14):      0.000 s
PDAF                      update ensemble (22):      0.000 s
PDAF                      update ensemble (22):      0.000 s
PDAF             ensemble transformation (4):      0.002 s
PDAF                 Time of prepoststep (5):      0.005 s
PDAF                 Time of prepoststep (5):      0.005 s
PDAF             prepare ensemble weights (20):      0.001 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.000 s
PDAF                 Time of prepoststep (5):      0.005 s
                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00059 MB (persistent)
            ensemble init:   0.25787 MB (temporary)
             Pre-Poststep:   0.11959 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and U:      0.019 MiB (persistent)
PDAF           ensemble array:      0.029 MiB (persistent)
PDAF            analysis step:      0.228 MiB (temporary)
PDAF                resampling:     0.170 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.003 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.001 s
PDAF                             update U (10):      0.002 s
PDAF                                   HL_p (30):      0.000 s
PDAF                          complete Uinv (31):      0.001 s
PDAF              get state weight vector (13):      0.001 s
PDAF                         update state (14):      0.000 s
PDAF             ensemble transformation (4):      0.003 s
PDAF             prepare ensemble weights (20):      0.002 s
PDAF                             SQRT(Uinv) (32):      0.001 s
PDAF                             init Omega (33):      0.000 s
PDAF                      compute Ct OmegaT (34):      0.001 s
PDAF                       complete weights (35):      0.000 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.001 s
PDAF                 Time of prepoststep (5):      0.400 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.408 s
                   total run time:      0.411 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.003 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.001 s
PDAF                             update U (10):      0.002 s
PDAF              get state weight vector (13):      0.001 s
PDAF                         update state (14):      0.000 s
PDAF             ensemble transformation (4):      0.003 s
PDAF             prepare ensemble weights (20):      0.002 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.001 s
PDAF                 Time of prepoststep (5):      0.400 s
Application 8683237 resources: utime ~2s, stime ~1s, Rss ~8460, inblocks ~33525, outblocks ~124013

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     2              2      0      1      1       F
     1       1      1      1      2      0       T
     3              2      1      2      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         1
  PARSER: subtype=         4
  PARSER: filename= output_par_seik4.dat
                     Filter: SEIK
      -- use ensemble transformation
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  SEIK Filter                    +++
PDAF    +++                                                 +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++          This implementation follows            +++
PDAF    +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEIK configuration
PDAF          filter sub-type = 4
PDAF            --> SEIK with ensemble transformation
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      2
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      4
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      6
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      8
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     10
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     12
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     14
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     16
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     18
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     20
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  1
 model PE exited: mype  2
 model PE exited: mype  3



PDAF                     PDAF Timing information




 PDAF test suite: EXITED ASSIMILATION
PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF                     PDAF Timing information
PDAF             Generate state ensemble (1):      0.001 s
PDAF          ---------------------------------------------
PDAF                   Time of forecasts (2):      0.188 s

PDAF          ---------------------------------------------
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF               Time for assimilation (3):      0.919 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF                       get mean state (11):      0.000 s
PDAF                   Time of forecasts (2):      1.987 s
PDAF                   Time of forecasts (2):      1.987 s
PDAF           init observation dimension (15):      0.000 s
PDAF       Time to collect/distribute ens (19):      1.799 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF                        init residual (12):      0.913 s
PDAF       Time to collect/distribute ens (19):      1.986 s
PDAF                             update U (10):      0.002 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF              get state weight vector (13):      0.001 s
PDAF             prepare ensemble weights (20):      0.001 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.001 s
PDAF                 Time of prepoststep (5):      0.000 s
                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.28648 MB (temporary)
             Pre-Poststep:   0.00916 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and U:      0.019 MiB (persistent)
PDAF           ensemble array:      0.057 MiB (persistent)
PDAF            analysis step:      0.401 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.008 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.001 s
PDAF                             update U (10):      0.002 s
PDAF                                   HL_p (30):      0.000 s
PDAF                          complete Uinv (31):      0.002 s
PDAF              get state weight vector (13):      0.002 s
PDAF             prepare ensemble weights (20):      0.002 s
PDAF                             SQRT(Uinv) (32):      0.001 s
PDAF                             init Omega (33):      0.000 s
PDAF                      compute Ct OmegaT (34):      0.001 s
PDAF                       complete weights (35):      0.000 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.001 s
PDAF                 Time of prepoststep (5):      2.007 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      2.017 s
                   total run time:      2.020 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.008 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.001 s
PDAF                             update U (10):      0.002 s
PDAF              get state weight vector (13):      0.002 s
PDAF             prepare ensemble weights (20):      0.002 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.001 s
PDAF                 Time of prepoststep (5):      2.007 s
Application 8683238 resources: utime ~7s, stime ~1s, Rss ~8460, inblocks ~33525, outblocks ~124009
--------------------------------------------------------
Run EnKF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2              2      0      1      1       F
     3              2      1      2      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         2
  PARSER: subtype=         0
  PARSER: filename= output_par_enkf0.dat
                     Filter: EnKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF     +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF     +++          Ensemble Kalman Filter (EnKF)          +++
PDAF     +++                                                 +++
PDAF     +++   Evensen, J. Geophys. Res. 99C (1994) 10143    +++
PDAF     +++ using an ensemble of observations according to  +++
PDAF     +++ Burgers et al., Mon. Wea. Rev. 126 (1998) 1719  +++
PDAF     +++          This implementation follows            +++
PDAF     +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF     +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF      EnKF configuration
PDAF            filter sub-type = 0
PDAF              --> EnKF with analysis for large observation dimension
PDAF              --> ensemble size:   50
PDAF          --> forgetting factor: 1.00

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use constrained random stochastic ensemble (EnKF type)
         --- Ensemble size:   50
         --- Generate ensemble
             Rank of covar matrix =    49
PDAF     --- EnKF_omega: Normalize columns of random matrix
PDAF     --- EnKF_omega: Project columns orthogonal to (1,...,1)^T

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.9918E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   6.0082E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
PDAF     --- PE-domain      1 dimension of observation vector       150
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.9918E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   6.0082E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      2
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.4147E-01
               RMS error according to true variance:   9.6203E-01
              Relative underestimation of variances:   7.4900E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.4147E-01
               RMS error according to true variance:   9.6203E-01
              Relative underestimation of variances:   7.4900E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      4
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8372E-01
               RMS error according to true variance:   9.5189E-01
              Relative underestimation of variances:   8.0699E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8372E-01
               RMS error according to true variance:   9.5189E-01
              Relative underestimation of variances:   8.0699E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      6
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5388E-01
               RMS error according to true variance:   9.5115E-01
              Relative underestimation of variances:   8.3822E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5388E-01
               RMS error according to true variance:   9.5115E-01
              Relative underestimation of variances:   8.3822E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      8
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3282E-01
               RMS error according to true variance:   9.4422E-01
              Relative underestimation of variances:   8.5933E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3282E-01
               RMS error according to true variance:   9.4422E-01
              Relative underestimation of variances:   8.5933E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     10
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.1850E-01
               RMS error according to true variance:   9.4326E-01
              Relative underestimation of variances:   8.7437E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.1850E-01
               RMS error according to true variance:   9.4326E-01
              Relative underestimation of variances:   8.7437E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     12
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.0796E-01
               RMS error according to true variance:   9.4268E-01
              Relative underestimation of variances:   8.8547E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.0796E-01
               RMS error according to true variance:   9.4268E-01
              Relative underestimation of variances:   8.8547E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     14
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   9.7926E-02
               RMS error according to true variance:   9.4110E-01
              Relative underestimation of variances:   8.9594E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   9.7926E-02
               RMS error according to true variance:   9.4110E-01
              Relative underestimation of variances:   8.9594E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     16
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   9.2088E-02
               RMS error according to true variance:   9.4022E-01
              Relative underestimation of variances:   9.0206E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   9.2088E-02
               RMS error according to true variance:   9.4022E-01
              Relative underestimation of variances:   9.0206E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     18
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.4728E-02
               RMS error according to true variance:   9.3915E-01
              Relative underestimation of variances:   9.0978E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.4728E-02
               RMS error according to true variance:   9.3915E-01
              Relative underestimation of variances:   9.0978E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     20
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.0894E-02
               RMS error according to true variance:   9.3875E-01
              Relative underestimation of variances:   9.1383E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  1
 model PE exited: mype  2
 model PE exited: mype  3





PDAF                     PDAF Timing information


PDAF                     PDAF Timing information
 PDAF test suite: EXITED ASSIMILATION
PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.153 s
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF               Time of assimilations (3):      0.183 s
PDAF                   Time of forecasts (2):      0.488 s
PDAF                       get mean state (11):      0.000 s
PDAF                   Time of forecasts (2):      0.488 s
PDAF       Time to collect/distribute ens (19):      0.488 s
PDAF                        compute HPH+R (10):      0.006 s
PDAF       Time to collect/distribute ens (19):      0.336 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF               generate obs. ensemble (15):      0.029 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF                        init residual (12):      0.001 s
PDAF              ensemble transformation (14):      0.027 s
PDAF                 Time of prepoststep (5):      0.000 s

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.30517 MB (temporary)
             Pre-Poststep:   0.00916 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and A:      0.001 MiB (persistent)
PDAF           ensemble array:      0.057 MiB (persistent)
PDAF            analysis step:      1.081 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time of assimilations (3):      0.064 s
PDAF                       get mean state (11):      0.000 s
PDAF                        compute HPH+R (10):      0.008 s
PDAF                               HXmean_p (33):      0.000 s
PDAF                                 HXpert (30):      0.001 s
PDAF                                    HPH (32):      0.007 s
PDAF               generate obs. ensemble (15):      0.028 s
PDAF                        init residual (12):      0.001 s
PDAF              ensemble transformation (14):      0.027 s
PDAF                 solve for representers (13):      0.025 s
PDAF                blocked ensemble update (16):      0.002 s
PDAF                           HX*representer (31):      0.001 s
PDAF                             blocked X-Xm (35):      0.000 s
PDAF                          update ensemble (38):      0.001 s
PDAF                 Time of prepoststep (5):      0.457 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.523 s
                   total run time:      0.526 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time of assimilations (3):      0.064 s
PDAF                       get mean state (11):      0.000 s
PDAF                        compute HPH+R (10):      0.008 s
PDAF               generate obs. ensemble (15):      0.028 s
PDAF                        init residual (12):      0.001 s
PDAF              ensemble transformation (14):      0.027 s
PDAF                 Time of prepoststep (5):      0.457 s
Application 8683239 resources: utime ~2s, stime ~1s, Rss ~9284, inblocks ~33525, outblocks ~124007

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2              2      0      1      1       F
     3              2      1      2      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         2
  PARSER: subtype=         1
  PARSER: filename= output_par_enkf1.dat
                     Filter: EnKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF     +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF     +++          Ensemble Kalman Filter (EnKF)          +++
PDAF     +++                                                 +++
PDAF     +++   Evensen, J. Geophys. Res. 99C (1994) 10143    +++
PDAF     +++ using an ensemble of observations according to  +++
PDAF     +++ Burgers et al., Mon. Wea. Rev. 126 (1998) 1719  +++
PDAF     +++          This implementation follows            +++
PDAF     +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF     +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF      EnKF configuration
PDAF            filter sub-type = 1
PDAF              --> EnKF with analysis for small observation dimension
PDAF              --> ensemble size:   50
PDAF          --> forgetting factor: 1.00

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use constrained random stochastic ensemble (EnKF type)
         --- Ensemble size:   50
         --- Generate ensemble
             Rank of covar matrix =    49
PDAF     --- EnKF_omega: Normalize columns of random matrix
PDAF     --- EnKF_omega: Project columns orthogonal to (1,...,1)^T

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.9918E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   6.0082E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
PDAF     --- PE-domain      1 dimension of observation vector       150
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.9918E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   6.0082E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      2
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.4147E-01
               RMS error according to true variance:   9.6203E-01
              Relative underestimation of variances:   7.4900E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.4147E-01
               RMS error according to true variance:   9.6203E-01
              Relative underestimation of variances:   7.4900E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      4
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8372E-01
               RMS error according to true variance:   9.5189E-01
              Relative underestimation of variances:   8.0699E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8372E-01
               RMS error according to true variance:   9.5189E-01
              Relative underestimation of variances:   8.0699E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      6
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5388E-01
               RMS error according to true variance:   9.5115E-01
              Relative underestimation of variances:   8.3822E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5388E-01
               RMS error according to true variance:   9.5115E-01
              Relative underestimation of variances:   8.3822E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      8
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3282E-01
               RMS error according to true variance:   9.4422E-01
              Relative underestimation of variances:   8.5933E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3282E-01
               RMS error according to true variance:   9.4422E-01
              Relative underestimation of variances:   8.5933E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     10
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.1850E-01
               RMS error according to true variance:   9.4326E-01
              Relative underestimation of variances:   8.7437E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.1850E-01
               RMS error according to true variance:   9.4326E-01
              Relative underestimation of variances:   8.7437E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     12
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.0796E-01
               RMS error according to true variance:   9.4268E-01
              Relative underestimation of variances:   8.8547E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.0796E-01
               RMS error according to true variance:   9.4268E-01
              Relative underestimation of variances:   8.8547E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     14
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   9.7926E-02
               RMS error according to true variance:   9.4110E-01
              Relative underestimation of variances:   8.9594E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   9.7926E-02
               RMS error according to true variance:   9.4110E-01
              Relative underestimation of variances:   8.9594E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     16
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   9.2088E-02
               RMS error according to true variance:   9.4022E-01
              Relative underestimation of variances:   9.0206E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   9.2088E-02
               RMS error according to true variance:   9.4022E-01
              Relative underestimation of variances:   9.0206E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     18
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.4728E-02
               RMS error according to true variance:   9.3915E-01
              Relative underestimation of variances:   9.0978E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.4728E-02
               RMS error according to true variance:   9.3915E-01
              Relative underestimation of variances:   9.0978E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     20
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.0894E-02
               RMS error according to true variance:   9.3875E-01
              Relative underestimation of variances:   9.1383E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  2
 model PE exited: mype  3
 model PE exited: mype  1







PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
 PDAF test suite: EXITED ASSIMILATION
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------

PDAF             Generate state ensemble (1):      0.001 s
PDAF          ---------------------------------------------
PDAF                   Time of forecasts (2):      0.070 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF                   Time of forecasts (2):      0.430 s
PDAF               Time of assimilations (3):      0.202 s
PDAF       Time to collect/distribute ens (19):      0.360 s
PDAF                   Time of forecasts (2):      0.430 s
PDAF                       get mean state (11):      0.000 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF       Time to collect/distribute ens (19):      0.429 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF                 compute HPH+R and HP (10):      0.010 s
PDAF               generate obs. ensemble (15):      0.029 s
PDAF                        init residual (12):      0.001 s
PDAF              ensemble transformation (14):      0.028 s
PDAF                 Time of prepoststep (5):      0.000 s
                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.30517 MB (temporary)
             Pre-Poststep:   0.00916 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and A:      0.001 MiB (persistent)
PDAF           ensemble array:      0.057 MiB (persistent)
PDAF            analysis step:      1.292 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time of assimilations (3):      0.067 s
PDAF                       get mean state (11):      0.000 s
PDAF                 compute HPH+R and HP (10):      0.011 s
PDAF                               HXmean_p (33):      0.000 s
PDAF                                 HXpert (30):      0.001 s
PDAF                                   HP_p (31):      0.004 s
PDAF                                    HPH (32):      0.005 s
PDAF               generate obs. ensemble (15):      0.028 s
PDAF                        init residual (12):      0.001 s
PDAF              ensemble transformation (14):      0.028 s
PDAF                 solve for representers (13):      0.025 s
PDAF                        ensemble update (16):      0.003 s
PDAF                 Time of prepoststep (5):      0.400 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.469 s
                   total run time:      0.472 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time of assimilations (3):      0.067 s
PDAF                       get mean state (11):      0.000 s
PDAF                 compute HPH+R and HP (10):      0.011 s
PDAF               generate obs. ensemble (15):      0.028 s
PDAF                        init residual (12):      0.001 s
PDAF              ensemble transformation (14):      0.028 s
PDAF                 Time of prepoststep (5):      0.400 s
Application 8683240 resources: utime ~2s, stime ~1s, Rss ~9628, inblocks ~33525, outblocks ~124006
--------------------------------------------------------
Run LSEIK tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2              2      0      1      1       F
     3              2      1      2      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         3
  PARSER: subtype=         0
  PARSER: filename= output_par_lseik0.dat
                     Filter: LSEIK
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  LSEIK Filter                   +++
PDAF    +++                                                 +++
PDAF    +++        Domain-localized SEIK filter by          +++
PDAF    +++   Nerger et al., Ocean Dynamics 56 (2006) 634   +++
PDAF    +++      based in the global SEIK filter by         +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LSEIK configuration
PDAF          filter sub-type = 0
PDAF            --> Standard LSEIK
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis-------------------------------------------------------
PDAF       2   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
PDAF     --- PE-domain:     1 number of analysis domains:       150
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis-------------------------------------------------------
PDAF       4   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3327E-01
               RMS error according to true variance:   9.4174E-01
              Relative underestimation of variances:   7.5230E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3327E-01
               RMS error according to true variance:   9.4174E-01
              Relative underestimation of variances:   7.5230E-01
PDAF Analysis-------------------------------------------------------
PDAF       6   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0196E-01
               RMS error according to true variance:   9.3820E-01
              Relative underestimation of variances:   7.8474E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0196E-01
               RMS error according to true variance:   9.3820E-01
              Relative underestimation of variances:   7.8474E-01
PDAF Analysis-------------------------------------------------------
PDAF       8   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8059E-01
               RMS error according to true variance:   9.2848E-01
              Relative underestimation of variances:   8.0550E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8059E-01
               RMS error according to true variance:   9.2848E-01
              Relative underestimation of variances:   8.0550E-01
PDAF Analysis-------------------------------------------------------
PDAF      10   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6482E-01
               RMS error according to true variance:   9.2810E-01
              Relative underestimation of variances:   8.2241E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6482E-01
               RMS error according to true variance:   9.2810E-01
              Relative underestimation of variances:   8.2241E-01
PDAF Analysis-------------------------------------------------------
PDAF      12   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5256E-01
               RMS error according to true variance:   9.2703E-01
              Relative underestimation of variances:   8.3543E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5256E-01
               RMS error according to true variance:   9.2703E-01
              Relative underestimation of variances:   8.3543E-01
PDAF Analysis-------------------------------------------------------
PDAF      14   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4268E-01
               RMS error according to true variance:   9.2194E-01
              Relative underestimation of variances:   8.4524E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4268E-01
               RMS error according to true variance:   9.2194E-01
              Relative underestimation of variances:   8.4524E-01
PDAF Analysis-------------------------------------------------------
PDAF      16   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3449E-01
               RMS error according to true variance:   9.2044E-01
              Relative underestimation of variances:   8.5388E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3449E-01
               RMS error according to true variance:   9.2044E-01
              Relative underestimation of variances:   8.5388E-01
PDAF Analysis-------------------------------------------------------
PDAF      18   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2757E-01
               RMS error according to true variance:   9.2040E-01
              Relative underestimation of variances:   8.6140E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2757E-01
               RMS error according to true variance:   9.2040E-01
              Relative underestimation of variances:   8.6140E-01
PDAF Analysis-------------------------------------------------------
PDAF      20   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2161E-01
               RMS error according to true variance:   9.1974E-01
              Relative underestimation of variances:   8.6777E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  2
 model PE exited: mype  1
 model PE exited: mype  3

 PDAF test suite: EXITED ASSIMILATION






PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF                     PDAF Timing information

PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
                  Model - Memory overview
PDAF                   Time of forecasts (2):      0.031 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF                   Time of forecasts (2):      0.448 s
PDAF                   Time of forecasts (2):      0.448 s
PDAF           Time for analysis/re-init (3):      0.305 s
PDAF       Time to collect/distribute ens (19):      0.417 s
PDAF       Time to collect/distribute ens (19):      0.447 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF                   global preparations (4):      0.142 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.163 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.082 s
PDAF                 ensemble transformation (8):      0.078 s
PDAF                        local to global (16):      0.002 s
PDAF                 Time of prepoststep (5):      0.000 s
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.28648 MB (temporary)
             Pre-Poststep:   0.00916 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and U:      0.021 MiB (persistent)
PDAF           ensemble array:      0.057 MiB (persistent)
PDAF            analysis step:      0.274 MiB (temporary)
PDAF                resampling:     0.170 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF           Time for analysis/re-init (3):      0.167 s
PDAF                   global preparations (4):      0.002 s
PDAF                         get mean state (11):      0.000 s
PDAF                             init Omega (33):      0.000 s
PDAF                   local analysis loop (6):      0.165 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.082 s
PDAF                            init residual (12):      0.001 s
PDAF                    compute new inverse U (10):      0.024 s
PDAF                                       HL_l (30):      0.004 s
PDAF                              complete Uinv (31):      0.020 s
PDAF                  get state weight vector (13):      0.055 s
PDAF                             update state (14):      0.001 s
PDAF                 ensemble transformation (8):      0.079 s
PDAF                 prepare ensemble weights (20):      0.073 s
PDAF                                 SQRT(Uinv) (32):      0.023 s
PDAF                          compute Ct OmegaT (34):      0.046 s
PDAF                           complete weights (35):      0.003 s
PDAF                    store ensemble matrix (21):      0.001 s
PDAF                          update ensemble (22):      0.004 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.331 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.501 s
                   total run time:      0.504 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF           Time for analysis/re-init (3):      0.167 s
PDAF                   global preparations (4):      0.002 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.165 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.082 s
PDAF                 ensemble transformation (8):      0.079 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.331 s
Application 8683241 resources: utime ~2s, stime ~0s, Rss ~8460, inblocks ~33525, outblocks ~124020

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         1

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2       2      1      2      3      0       T
     3       3      1      3      4      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  4 PEs
     task   1 PE(model)   0 dim_local(state):    75
     task   1 PE(model)   1 dim_local(state):    75
     task   1 PE(model)   2 dim_local(state):    75
     task   1 PE(model)   3 dim_local(state):    75

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         3
  PARSER: subtype=         2
  PARSER: filename= output_par_lseik2.dat
                     Filter: LSEIK
      -- fixed error-space basis
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  LSEIK Filter                   +++
PDAF    +++                                                 +++
PDAF    +++        Domain-localized SEIK filter by          +++
PDAF    +++   Nerger et al., Ocean Dynamics 56 (2006) 634   +++
PDAF    +++      based in the global SEIK filter by         +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LSEIK configuration
PDAF          filter sub-type = 2
PDAF            --> fixed error-space basis
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      4
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     4
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega
PDAF     --- PE-domain:     1 number of analysis domains:        75

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION

PDAF     --- PE-domain:     2 number of analysis domains:        75

PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis-------------------------------------------------------
PDAF       2   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis-------------------------------------------------------
PDAF       4   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3327E-01
               RMS error according to true variance:   9.4174E-01
              Relative underestimation of variances:   7.5230E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3327E-01
               RMS error according to true variance:   9.4174E-01
              Relative underestimation of variances:   7.5230E-01
PDAF Analysis-------------------------------------------------------
PDAF       6   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0196E-01
               RMS error according to true variance:   9.3820E-01
              Relative underestimation of variances:   7.8474E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0196E-01
               RMS error according to true variance:   9.3820E-01
              Relative underestimation of variances:   7.8474E-01
PDAF Analysis-------------------------------------------------------
PDAF       8   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8059E-01
               RMS error according to true variance:   9.2848E-01
              Relative underestimation of variances:   8.0550E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8059E-01
               RMS error according to true variance:   9.2848E-01
              Relative underestimation of variances:   8.0550E-01
PDAF Analysis-------------------------------------------------------
PDAF      10   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6482E-01
               RMS error according to true variance:   9.2810E-01
              Relative underestimation of variances:   8.2241E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6482E-01
               RMS error according to true variance:   9.2810E-01
              Relative underestimation of variances:   8.2241E-01
PDAF Analysis-------------------------------------------------------
PDAF      12   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5256E-01
               RMS error according to true variance:   9.2703E-01
              Relative underestimation of variances:   8.3543E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5256E-01
               RMS error according to true variance:   9.2703E-01
              Relative underestimation of variances:   8.3543E-01
PDAF Analysis-------------------------------------------------------
PDAF      14   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4268E-01
               RMS error according to true variance:   9.2194E-01
              Relative underestimation of variances:   8.4524E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4268E-01
               RMS error according to true variance:   9.2194E-01
              Relative underestimation of variances:   8.4524E-01
PDAF Analysis-------------------------------------------------------
PDAF      16   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3449E-01
               RMS error according to true variance:   9.2044E-01
              Relative underestimation of variances:   8.5388E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3449E-01
               RMS error according to true variance:   9.2044E-01
              Relative underestimation of variances:   8.5388E-01
PDAF Analysis-------------------------------------------------------
PDAF      18   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2757E-01
               RMS error according to true variance:   9.2040E-01
              Relative underestimation of variances:   8.6140E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2757E-01
               RMS error according to true variance:   9.2040E-01
              Relative underestimation of variances:   8.6140E-01
PDAF Analysis-------------------------------------------------------
PDAF      20   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2161E-01
               RMS error according to true variance:   9.1974E-01
              Relative underestimation of variances:   8.6777E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  2
 model PE exited: mype  1
 model PE exited: mype  3

 PDAF test suite: EXITED ASSIMILATION







PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
                  Model - Memory overview
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF           Time for analysis/re-init (3):      0.251 s
PDAF           Time for analysis/re-init (3):      0.252 s
PDAF           Time for analysis/re-init (3):      0.251 s
PDAF                   global preparations (4):      0.168 s
PDAF                   global preparations (4):      0.168 s
PDAF                   global preparations (4):      0.168 s
PDAF                         get mean state (11):      0.000 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.083 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.083 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                   local analysis loop (6):      0.084 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.000 s
PDAF                        global to local (15):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.042 s
PDAF                          local analysis (7):      0.042 s
PDAF                 ensemble transformation (8):      0.039 s
PDAF                          local analysis (7):      0.042 s
PDAF                 ensemble transformation (8):      0.039 s
PDAF                        local to global (16):      0.001 s
PDAF                        local to global (16):      0.001 s
PDAF                 ensemble transformation (8):      0.040 s
PDAF                 Time of prepoststep (5):      0.000 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.000 s
PDAF                 Time of prepoststep (5):      0.000 s
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00059 MB (persistent)
            ensemble init:   0.25787 MB (temporary)
             Pre-Poststep:   0.00687 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and U:      0.019 MiB (persistent)
PDAF           ensemble array:      0.029 MiB (persistent)
PDAF            analysis step:      0.274 MiB (temporary)
PDAF                resampling:     0.170 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF           Time for analysis/re-init (3):      0.089 s
PDAF                   global preparations (4):      0.003 s
PDAF                         get mean state (11):      0.000 s
PDAF                             init Omega (33):      0.000 s
PDAF                   local analysis loop (6):      0.086 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.000 s
PDAF                          local analysis (7):      0.043 s
PDAF                            init residual (12):      0.000 s
PDAF                    compute new inverse U (10):      0.013 s
PDAF                                       HL_l (30):      0.002 s
PDAF                              complete Uinv (31):      0.011 s
PDAF                  get state weight vector (13):      0.029 s
PDAF                             update state (14):      0.001 s
PDAF                 ensemble transformation (8):      0.041 s
PDAF                 prepare ensemble weights (20):      0.037 s
PDAF                                 SQRT(Uinv) (32):      0.012 s
PDAF                          compute Ct OmegaT (34):      0.023 s
PDAF                           complete weights (35):      0.002 s
PDAF                    store ensemble matrix (21):      0.001 s
PDAF                          update ensemble (22):      0.002 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.339 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.429 s
                   total run time:      0.433 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF           Time for analysis/re-init (3):      0.089 s
PDAF                   global preparations (4):      0.003 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.086 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.000 s
PDAF                          local analysis (7):      0.043 s
PDAF                 ensemble transformation (8):      0.041 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.339 s
Application 8683242 resources: utime ~2s, stime ~0s, Rss ~8460, inblocks ~33525, outblocks ~124024

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         1

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     2       2      1      2      3      0       T
     1       1      1      1      2      0       T
     3       3      1      3      4      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  4 PEs
     task   1 PE(model)   0 dim_local(state):    75
     task   1 PE(model)   1 dim_local(state):    75
     task   1 PE(model)   2 dim_local(state):    75
     task   1 PE(model)   3 dim_local(state):    75

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         3
  PARSER: subtype=         3
  PARSER: filename= output_par_lseik3.dat
                     Filter: LSEIK
      -- fixed state covariance matrix
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  LSEIK Filter                   +++
PDAF    +++                                                 +++
PDAF    +++        Domain-localized SEIK filter by          +++
PDAF    +++   Nerger et al., Ocean Dynamics 56 (2006) 634   +++
PDAF    +++      based in the global SEIK filter by         +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LSEIK configuration
PDAF          filter sub-type = 3
PDAF            --> fixed state covariance matrix
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      4
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     4
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis-------------------------------------------------------
PDAF       2   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   5.7864E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   5.7864E-01
PDAF Analysis-------------------------------------------------------
PDAF       4   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   5.7067E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   5.7067E-01
PDAF Analysis-------------------------------------------------------
PDAF       6   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   5.7356E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   5.7356E-01
PDAF Analysis-------------------------------------------------------
PDAF       8   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   5.6909E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   5.6909E-01
PDAF Analysis-------------------------------------------------------
PDAF      10   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   5.7546E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   5.7546E-01
PDAF Analysis-------------------------------------------------------
PDAF      12   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   5.7334E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   5.7334E-01
PDAF Analysis-------------------------------------------------------
PDAF      14   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   5.6801E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   5.6801E-01
PDAF Analysis-------------------------------------------------------
PDAF      16   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Analysis-------------------------------------------------------
PDAF      18   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   5.6941E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   5.6941E-01
PDAF Analysis-------------------------------------------------------
PDAF      20   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  1
 model PE exited: mype  2
 model PE exited: mype  3






PDAF                     PDAF Timing information

PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
 PDAF test suite: EXITED ASSIMILATION
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF           Time for analysis/re-init (3):      0.275 s
PDAF           Time for analysis/re-init (3):      0.275 s
PDAF           Time for analysis/re-init (3):      0.275 s
PDAF                   global preparations (4):      0.179 s
PDAF                   global preparations (4):      0.179 s
PDAF                   global preparations (4):      0.179 s
PDAF                         get mean state (11):      0.000 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.096 s
PDAF                         get mean state (11):      0.000 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                   local analysis loop (6):      0.096 s
PDAF                   local analysis loop (6):      0.096 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.000 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.000 s
PDAF                        global to local (15):      0.000 s
PDAF                          local analysis (7):      0.041 s
PDAF                          local analysis (7):      0.041 s
PDAF                          local analysis (7):      0.041 s
PDAF                 ensemble transformation (8):      0.053 s
PDAF                 ensemble transformation (8):      0.053 s
PDAF                 ensemble transformation (8):      0.053 s
PDAF                        local to global (16):      0.001 s
PDAF                        local to global (16):      0.001 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.005 s
PDAF                 Time of prepoststep (5):      0.005 s
PDAF                 Time of prepoststep (5):      0.005 s

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00059 MB (persistent)
            ensemble init:   0.25787 MB (temporary)
             Pre-Poststep:   0.11959 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and U:      0.019 MiB (persistent)
PDAF           ensemble array:      0.029 MiB (persistent)
PDAF            analysis step:      0.275 MiB (temporary)
PDAF                resampling:     0.188 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF           Time for analysis/re-init (3):      0.102 s
PDAF                   global preparations (4):      0.003 s
PDAF                         get mean state (11):      0.000 s
PDAF                             init Omega (33):      0.000 s
PDAF                   local analysis loop (6):      0.099 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.000 s
PDAF                          local analysis (7):      0.042 s
PDAF                            init residual (12):      0.000 s
PDAF                    compute new inverse U (10):      0.013 s
PDAF                                       HL_l (30):      0.002 s
PDAF                              complete Uinv (31):      0.011 s
PDAF                  get state weight vector (13):      0.028 s
PDAF                             update state (14):      0.001 s
PDAF                 ensemble transformation (8):      0.054 s
PDAF                 prepare ensemble weights (20):      0.051 s
PDAF                                 SQRT(Uinv) (32):      0.026 s
PDAF                          compute Ct OmegaT (34):      0.023 s
PDAF                           complete weights (35):      0.002 s
PDAF                    store ensemble matrix (21):      0.001 s
PDAF                          update ensemble (22):      0.002 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.345 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.449 s
                   total run time:      0.452 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF           Time for analysis/re-init (3):      0.102 s
PDAF                   global preparations (4):      0.003 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.099 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.000 s
PDAF                          local analysis (7):      0.042 s
PDAF                 ensemble transformation (8):      0.054 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.345 s
Application 8683243 resources: utime ~2s, stime ~0s, Rss ~8460, inblocks ~33525, outblocks ~124025

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2              2      0      1      1       F
     3              2      1      2      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         3
  PARSER: subtype=         4
  PARSER: filename= output_par_lseik4.dat
                     Filter: LSEIK
      -- use ensemble transformation
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  LSEIK Filter                   +++
PDAF    +++                                                 +++
PDAF    +++        Domain-localized SEIK filter by          +++
PDAF    +++   Nerger et al., Ocean Dynamics 56 (2006) 634   +++
PDAF    +++      based in the global SEIK filter by         +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LSEIK configuration
PDAF          filter sub-type = 4
PDAF            --> SEIK with ensemble transformation
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis-------------------------------------------------------
PDAF       2   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis-------------------------------------------------------
PDAF       4   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3327E-01
               RMS error according to true variance:   9.4174E-01
              Relative underestimation of variances:   7.5230E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3327E-01
               RMS error according to true variance:   9.4174E-01
              Relative underestimation of variances:   7.5230E-01
PDAF Analysis-------------------------------------------------------
PDAF       6   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0196E-01
               RMS error according to true variance:   9.3820E-01
              Relative underestimation of variances:   7.8474E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
PDAF     --- PE-domain:     1 number of analysis domains:       150
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0196E-01
               RMS error according to true variance:   9.3820E-01
              Relative underestimation of variances:   7.8474E-01
PDAF Analysis-------------------------------------------------------
PDAF       8   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8059E-01
               RMS error according to true variance:   9.2848E-01
              Relative underestimation of variances:   8.0550E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8059E-01
               RMS error according to true variance:   9.2848E-01
              Relative underestimation of variances:   8.0550E-01
PDAF Analysis-------------------------------------------------------
PDAF      10   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6482E-01
               RMS error according to true variance:   9.2810E-01
              Relative underestimation of variances:   8.2241E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6482E-01
               RMS error according to true variance:   9.2810E-01
              Relative underestimation of variances:   8.2241E-01
PDAF Analysis-------------------------------------------------------
PDAF      12   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5256E-01
               RMS error according to true variance:   9.2703E-01
              Relative underestimation of variances:   8.3543E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5256E-01
               RMS error according to true variance:   9.2703E-01
              Relative underestimation of variances:   8.3543E-01
PDAF Analysis-------------------------------------------------------
PDAF      14   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4268E-01
               RMS error according to true variance:   9.2194E-01
              Relative underestimation of variances:   8.4524E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4268E-01
               RMS error according to true variance:   9.2194E-01
              Relative underestimation of variances:   8.4524E-01
PDAF Analysis-------------------------------------------------------
PDAF      16   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3449E-01
               RMS error according to true variance:   9.2044E-01
              Relative underestimation of variances:   8.5388E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3449E-01
               RMS error according to true variance:   9.2044E-01
              Relative underestimation of variances:   8.5388E-01
PDAF Analysis-------------------------------------------------------
PDAF      18   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2757E-01
               RMS error according to true variance:   9.2040E-01
              Relative underestimation of variances:   8.6140E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2757E-01
               RMS error according to true variance:   9.2040E-01
              Relative underestimation of variances:   8.6140E-01
PDAF Analysis-------------------------------------------------------
PDAF      20   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2161E-01
               RMS error according to true variance:   9.1974E-01
              Relative underestimation of variances:   8.6777E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  2
 model PE exited: mype  3
 model PE exited: mype  1

 PDAF test suite: EXITED ASSIMILATION






PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------

PDAF             Generate state ensemble (1):      0.000 s
PDAF          ---------------------------------------------
PDAF                   Time of forecasts (2):      0.453 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.426 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF                   Time of forecasts (2):      0.028 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF                   Time of forecasts (2):      0.453 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.453 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF           Time for analysis/re-init (3):      0.291 s
PDAF                   global preparations (4):      0.129 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.162 s
                  Model - Memory overview
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.159 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.000 s
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.28648 MB (temporary)
             Pre-Poststep:   0.00916 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and U:      0.021 MiB (persistent)
PDAF           ensemble array:      0.057 MiB (persistent)
PDAF            analysis step:      0.370 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF           Time for analysis/re-init (3):      0.166 s
PDAF                   global preparations (4):      0.003 s
PDAF                         get mean state (11):      0.000 s
PDAF                             init Omega (33):      0.000 s
PDAF                   local analysis loop (6):      0.164 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.161 s
PDAF                            init residual (12):      0.001 s
PDAF                    compute new inverse U (10):      0.025 s
PDAF                                       HL_l (30):      0.005 s
PDAF                              complete Uinv (31):      0.020 s
PDAF                  get state weight vector (13):      0.054 s
PDAF                 prepare ensemble weights (20):      0.073 s
PDAF                                 SQRT(Uinv) (32):      0.022 s
PDAF                          compute Ct OmegaT (34):      0.046 s
PDAF                           complete weights (35):      0.005 s
PDAF                    store ensemble matrix (21):      0.002 s
PDAF                          update ensemble (22):      0.004 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.336 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.504 s
                   total run time:      0.507 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF           Time for analysis/re-init (3):      0.166 s
PDAF                   global preparations (4):      0.003 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.164 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.161 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.336 s
Application 8683244 resources: utime ~2s, stime ~1s, Rss ~8460, inblocks ~33525, outblocks ~124020
--------------------------------------------------------
Run ETKF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2              2      0      1      1       F
     3              2      1      2      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         4
  PARSER: subtype=         0
  PARSER: filename= output_par_etkf0.dat
                     Filter: ETKF
      -- Variant using T-matrix
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++     Ensemble Transform Kalman Filter (ETKF)     +++
PDAF    +++                                                 +++
PDAF    +++   Bishop et al., Mon. Wea. Rev. 129 (2001) 420  +++
PDAF    +++    A symmetric square root is used following    +++
PDAF    +++      Hunt et al. Physica D 230 (2007) 112       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ETKF configuration
PDAF         filter sub-type = 0
PDAF            --> ETKF using T-matrix
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      2
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      4
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      6
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      8
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     10
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     12
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     14
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     16
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     18
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     20
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0

 model PE exited: mype  3
 model PE exited: mype  2
 model PE exited: mype  1
 PDAF test suite: EXITED ASSIMILATION






PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF                     PDAF Timing information

PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.000 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.341 s
PDAF                   Time of forecasts (2):      0.341 s
PDAF                   Time of forecasts (2):      0.077 s
PDAF       Time to collect/distribute ens (19):      0.264 s
PDAF       Time to collect/distribute ens (19):      0.340 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF               Time for assimilation (3):      0.143 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
                  Model - Memory overview
PDAF                        init residual (12):      0.133 s
PDAF                compute new inverse U (10):      0.002 s
PDAF              get state weight vector (13):      0.006 s
PDAF             prepare ensemble weights (20):      0.000 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.001 s
PDAF                 Time of prepoststep (5):      0.000 s
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.28648 MB (temporary)
             Pre-Poststep:   0.00916 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and A:      0.020 MiB (persistent)
PDAF           ensemble array:      0.057 MiB (persistent)
PDAF            analysis step:      0.330 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.011 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.000 s
PDAF                compute new inverse U (10):      0.002 s
PDAF                                   HZ_p (30):      0.000 s
PDAF                          complete Uinv (31):      0.002 s
PDAF              get state weight vector (13):      0.007 s
PDAF             prepare ensemble weights (20):      0.000 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.001 s
PDAF                 Time of prepoststep (5):      0.356 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.369 s
                   total run time:      0.372 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.011 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.000 s
PDAF                compute new inverse U (10):      0.002 s
PDAF              get state weight vector (13):      0.007 s
PDAF             prepare ensemble weights (20):      0.000 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.001 s
PDAF                 Time of prepoststep (5):      0.356 s
Application 8683245 resources: utime ~2s, stime ~1s, Rss ~8460, inblocks ~33525, outblocks ~124007

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2              2      0      1      1       F
     3              2      1      2      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         4
  PARSER: subtype=         1
  PARSER: filename= output_par_etkf1.dat
                     Filter: ETKF
      -- Variant following Hunt et al. (2007)
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++     Ensemble Transform Kalman Filter (ETKF)     +++
PDAF    +++                                                 +++
PDAF    +++   Bishop et al., Mon. Wea. Rev. 129 (2001) 420  +++
PDAF    +++    A symmetric square root is used following    +++
PDAF    +++      Hunt et al. Physica D 230 (2007) 112       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ETKF configuration
PDAF         filter sub-type = 1
PDAF            --> ETKF following Hunt et al. (2007)
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      2
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      4
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      6
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      8
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     10
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     12
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     14
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     16
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     18
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     20
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  2
 model PE exited: mype  1
 model PE exited: mype  3


 PDAF test suite: EXITED ASSIMILATION





PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF                     PDAF Timing information

PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.000 s
PDAF             Generate state ensemble (1):      0.001 s
                  Model - Memory overview
PDAF                   Time of forecasts (2):      0.081 s
PDAF                   Time of forecasts (2):      0.351 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF               Time for assimilation (3):      0.166 s
PDAF       Time to collect/distribute ens (19):      0.350 s
PDAF                   Time of forecasts (2):      0.351 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF       Time to collect/distribute ens (19):      0.270 s
PDAF                       get mean state (11):      0.000 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.157 s
PDAF                compute new inverse U (10):      0.002 s
PDAF              get state weight vector (13):      0.006 s
PDAF             prepare ensemble weights (20):      0.000 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.001 s
PDAF                 Time of prepoststep (5):      0.000 s
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.28648 MB (temporary)
             Pre-Poststep:   0.00916 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and A:      0.020 MiB (persistent)
PDAF           ensemble array:      0.057 MiB (persistent)
PDAF            analysis step:      0.330 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.011 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.001 s
PDAF                compute new inverse U (10):      0.002 s
PDAF                                   HZ_p (30):      0.000 s
PDAF                          complete Uinv (31):      0.002 s
PDAF              get state weight vector (13):      0.006 s
PDAF             prepare ensemble weights (20):      0.000 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.001 s
PDAF                 Time of prepoststep (5):      0.394 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.406 s
                   total run time:      0.409 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.011 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.001 s
PDAF                compute new inverse U (10):      0.002 s
PDAF              get state weight vector (13):      0.006 s
PDAF             prepare ensemble weights (20):      0.000 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.001 s
PDAF                 Time of prepoststep (5):      0.394 s
Application 8683246 resources: utime ~2s, stime ~0s, Rss ~8460, inblocks ~33525, outblocks ~124007

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         1

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     3       3      1      3      4      0       T
     2       2      1      2      3      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  4 PEs
     task   1 PE(model)   0 dim_local(state):    75
     task   1 PE(model)   1 dim_local(state):    75
     task   1 PE(model)   2 dim_local(state):    75
     task   1 PE(model)   3 dim_local(state):    75

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         4
  PARSER: subtype=         2
  PARSER: filename= output_par_etkf2.dat
                     Filter: ETKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++     Ensemble Transform Kalman Filter (ETKF)     +++
PDAF    +++                                                 +++
PDAF    +++   Bishop et al., Mon. Wea. Rev. 129 (2001) 420  +++
PDAF    +++    A symmetric square root is used following    +++
PDAF    +++      Hunt et al. Physica D 230 (2007) 112       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ETKF configuration
PDAF         filter sub-type = 2
PDAF            --> ETKF with fixed error-space basis
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      4
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     4
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega
PDAF     --- PE-domain      1 dimension of observation vector        75

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
PDAF     --- PE-domain      3 dimension of observation vector        75
      0   Analyze initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      2
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      4
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      6
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      8
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     10
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     12
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     14
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     16
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     18
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     20
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  2
 model PE exited: mype  1
 model PE exited: mype  3







PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
 PDAF test suite: EXITED ASSIMILATION
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------

PDAF             Generate state ensemble (1):      0.001 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.169 s
PDAF               Time for assimilation (3):      0.169 s
PDAF               Time for assimilation (3):      0.169 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                       get mean state (11):      0.000 s
PDAF                       get mean state (11):      0.000 s
PDAF                        init residual (12):      0.160 s
PDAF           init observation dimension (15):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                compute new inverse U (10):      0.002 s
PDAF                        init residual (12):      0.160 s
PDAF              get state weight vector (13):      0.007 s
PDAF                        init residual (12):      0.160 s
PDAF                compute new inverse U (10):      0.002 s
PDAF             prepare ensemble weights (20):      0.000 s
PDAF              get state weight vector (13):      0.007 s
PDAF                compute new inverse U (10):      0.001 s
PDAF             prepare ensemble weights (20):      0.000 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF              get state weight vector (13):      0.007 s
PDAF             prepare ensemble weights (20):      0.000 s
PDAF                      update ensemble (22):      0.000 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                 Time of prepoststep (5):      0.000 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.000 s
PDAF                      update ensemble (22):      0.000 s
PDAF                 Time of prepoststep (5):      0.000 s
PDAF                 Time of prepoststep (5):      0.000 s
                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00059 MB (persistent)
            ensemble init:   0.25787 MB (temporary)
             Pre-Poststep:   0.00687 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and A:      0.020 MiB (persistent)
PDAF           ensemble array:      0.029 MiB (persistent)
PDAF            analysis step:      0.270 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.011 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.001 s
PDAF                compute new inverse U (10):      0.002 s
PDAF                                   HZ_p (30):      0.000 s
PDAF                          complete Uinv (31):      0.001 s
PDAF              get state weight vector (13):      0.007 s
PDAF             prepare ensemble weights (20):      0.000 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.000 s
PDAF                 Time of prepoststep (5):      0.348 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.360 s
                   total run time:      0.363 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.011 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.001 s
PDAF                compute new inverse U (10):      0.002 s
PDAF              get state weight vector (13):      0.007 s
PDAF             prepare ensemble weights (20):      0.000 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                      update ensemble (22):      0.000 s
PDAF                 Time of prepoststep (5):      0.348 s
Application 8683248 resources: utime ~2s, stime ~0s, Rss ~8460, inblocks ~33525, outblocks ~124010

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         1

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2       2      1      2      3      0       T
     3       3      1      3      4      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  4 PEs
     task   1 PE(model)   0 dim_local(state):    75
     task   1 PE(model)   1 dim_local(state):    75
     task   1 PE(model)   2 dim_local(state):    75
     task   1 PE(model)   3 dim_local(state):    75

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         4
  PARSER: subtype=         3
  PARSER: filename= output_par_etkf3.dat
                     Filter: ETKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++     Ensemble Transform Kalman Filter (ETKF)     +++
PDAF    +++                                                 +++
PDAF    +++   Bishop et al., Mon. Wea. Rev. 129 (2001) 420  +++
PDAF    +++    A symmetric square root is used following    +++
PDAF    +++      Hunt et al. Physica D 230 (2007) 112       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ETKF configuration
PDAF         filter sub-type = 3
PDAF            --> ETKF with fixed state covariance matrix
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      4
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     4
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      2
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   5.7864E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   6.9642E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   5.7067E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   6.9846E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   5.7356E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      8
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   6.9530E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   5.6909E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     10
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   6.9980E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   5.7546E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     12
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   6.9831E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   5.7334E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     14
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   6.9453E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   5.6801E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     16
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   6.9498E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     18
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   6.9552E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   5.6941E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     20
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   6.9498E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  2
 model PE exited: mype  1
 model PE exited: mype  3

 PDAF test suite: EXITED ASSIMILATION





PDAF                     PDAF Timing information

PDAF                     PDAF Timing information
PDAF                     PDAF Timing information

PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF          ---------------------------------------------
PDAF                   Time of forecasts (2):      0.000 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.301 s
PDAF               Time for assimilation (3):      0.301 s
PDAF               Time for assimilation (3):      0.301 s
PDAF                       get mean state (11):      0.000 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.293 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.293 s
PDAF                compute new inverse U (10):      0.001 s
PDAF                        init residual (12):      0.293 s
PDAF              get state weight vector (13):      0.006 s
PDAF                compute new inverse U (10):      0.001 s
PDAF                compute new inverse U (10):      0.001 s
PDAF            update state and ensemble (14):      0.000 s
PDAF              get state weight vector (13):      0.006 s
PDAF              get state weight vector (13):      0.006 s
PDAF            update state and ensemble (14):      0.000 s
PDAF                 Time of prepoststep (5):      0.003 s
PDAF                 Time of prepoststep (5):      0.003 s
PDAF            update state and ensemble (14):      0.000 s
PDAF                 Time of prepoststep (5):      0.003 s
                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00059 MB (persistent)
            ensemble init:   0.25787 MB (temporary)
             Pre-Poststep:   0.12074 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and A:      0.020 MiB (persistent)
PDAF           ensemble array:      0.029 MiB (persistent)
PDAF            analysis step:      0.193 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.009 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.001 s
PDAF                compute new inverse U (10):      0.001 s
PDAF                                   HZ_p (30):      0.000 s
PDAF                          complete Uinv (31):      0.001 s
PDAF              get state weight vector (13):      0.007 s
PDAF            update state and ensemble (14):      0.000 s
PDAF                 Time of prepoststep (5):      0.479 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.489 s
                   total run time:      0.492 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.009 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.001 s
PDAF                compute new inverse U (10):      0.001 s
PDAF              get state weight vector (13):      0.007 s
PDAF            update state and ensemble (14):      0.000 s
PDAF                 Time of prepoststep (5):      0.479 s
Application 8683252 resources: utime ~2s, stime ~0s, Rss ~8460, inblocks ~33525, outblocks ~124009
--------------------------------------------------------
Run LETKF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2              2      0      1      1       F
     3              2      1      2      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         5
  PARSER: subtype=         0
  PARSER: filename= output_par_letkf0.dat
                     Filter: LETKF
      -- Variant using T-matrix
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Ensemble Transform Kalman Filter (LETKF)  +++
PDAF    +++                                                  +++
PDAF    +++            Domain-localized LETKF by             +++
PDAF    +++      Hunt et al., Physica D 230 (2007) 112       +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LETKF configuration
PDAF          filter sub-type = 0
PDAF            --> LETKF using T-matrix
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  1
 model PE exited: mype  2
 model PE exited: mype  3

 PDAF test suite: EXITED ASSIMILATION






PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF                     PDAF Timing information

PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF                   Time of forecasts (2):      0.106 s
PDAF                   Time of forecasts (2):      0.858 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF                   Time of forecasts (2):      0.857 s
PDAF               Time for assimilation (3):      0.531 s
PDAF       Time to collect/distribute ens (19):      0.857 s
PDAF       Time to collect/distribute ens (19):      0.751 s
PDAF                   global preparations (4):      0.164 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.367 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
                  Model - Memory overview
PDAF                          local analysis (7):      0.363 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.000 s
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.28648 MB (temporary)
             Pre-Poststep:   0.00916 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and A:      0.021 MiB (persistent)
PDAF           ensemble array:      0.057 MiB (persistent)
PDAF            analysis step:      0.297 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.468 s
PDAF                   global preparations (4):      0.002 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.466 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.462 s
PDAF                    compute new inverse A (10):      0.024 s
PDAF                                       HZ_l (30):      0.004 s
PDAF                              complete Uinv (31):      0.019 s
PDAF                            init residual (12):      0.001 s
PDAF                  get state weight vector (13):      0.397 s
PDAF                 prepare ensemble weights (20):      0.035 s
PDAF                    store ensemble matrix (21):      0.001 s
PDAF                          update ensemble (22):      0.003 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.475 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.946 s
                   total run time:      0.949 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.468 s
PDAF                   global preparations (4):      0.002 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.466 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.462 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.475 s
Application 8683253 resources: utime ~4s, stime ~1s, Rss ~8460, inblocks ~33525, outblocks ~124019

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2              2      0      1      1       F
     3              2      1      2      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         5
  PARSER: subtype=         1
  PARSER: filename= output_par_letkf1.dat
                     Filter: LETKF
      -- Variant following Hunt et al. (2007)
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Ensemble Transform Kalman Filter (LETKF)  +++
PDAF    +++                                                  +++
PDAF    +++            Domain-localized LETKF by             +++
PDAF    +++      Hunt et al., Physica D 230 (2007) 112       +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LETKF configuration
PDAF          filter sub-type = 1
PDAF            --> LETKF following Hunt et al. (2007)
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
PDAF      --- PE-domain:     1 number of analysis domains:       150
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  1
 model PE exited: mype  3
 model PE exited: mype  2

 PDAF test suite: EXITED ASSIMILATION






PDAF                     PDAF Timing information

PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
                  Model - Memory overview
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF          ---------------------------------------------
PDAF                   Time of forecasts (2):      0.063 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF                   Time of forecasts (2):      0.800 s
PDAF               Time for assimilation (3):      0.489 s
PDAF                   Time of forecasts (2):      0.800 s
PDAF       Time to collect/distribute ens (19):      0.799 s
PDAF       Time to collect/distribute ens (19):      0.737 s
PDAF                   global preparations (4):      0.130 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.359 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.356 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.000 s
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.28648 MB (temporary)
             Pre-Poststep:   0.00916 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and A:      0.021 MiB (persistent)
PDAF           ensemble array:      0.057 MiB (persistent)
PDAF            analysis step:      0.297 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.458 s
PDAF                   global preparations (4):      0.002 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.456 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.453 s
PDAF                    compute new inverse A (10):      0.024 s
PDAF                                       HZ_l (30):      0.004 s
PDAF                              complete Uinv (31):      0.019 s
PDAF                            init residual (12):      0.001 s
PDAF                  get state weight vector (13):      0.388 s
PDAF                 prepare ensemble weights (20):      0.032 s
PDAF                    store ensemble matrix (21):      0.002 s
PDAF                          update ensemble (22):      0.003 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.415 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.876 s
                   total run time:      0.879 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.458 s
PDAF                   global preparations (4):      0.002 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.456 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.453 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.415 s
Application 8683254 resources: utime ~4s, stime ~1s, Rss ~8460, inblocks ~33525, outblocks ~124019

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         1

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2       2      1      2      3      0       T
     3       3      1      3      4      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  4 PEs
     task   1 PE(model)   0 dim_local(state):    75
     task   1 PE(model)   1 dim_local(state):    75
     task   1 PE(model)   2 dim_local(state):    75
     task   1 PE(model)   3 dim_local(state):    75

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         5
  PARSER: subtype=         2
  PARSER: filename= output_par_letkf2.dat
                     Filter: LETKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Ensemble Transform Kalman Filter (LETKF)  +++
PDAF    +++                                                  +++
PDAF    +++            Domain-localized LETKF by             +++
PDAF    +++      Hunt et al., Physica D 230 (2007) 112       +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LETKF configuration
PDAF          filter sub-type = 2
PDAF            --> LETKF with fixed error-space basis
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      4
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     4
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega
PDAF      --- PE-domain:     1 number of analysis domains:        75

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION
PDAF      --- PE-domain:     2 number of analysis domains:        75


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF      --- PE-domain:     3 number of analysis domains:        75
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF      --- PE-domain:     3 number of analysis domains:        75
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-domain:     3 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-domain:     3 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-domain:     3 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-domain:     3 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-domain:     3 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-domain:     3 number of analysis domains:        75
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-domain:     3 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-domain:     3 number of analysis domains:        75
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  2
 model PE exited: mype  3
 model PE exited: mype  1





PDAF                     PDAF Timing information
PDAF                     PDAF Timing information

PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------

PDAF             Generate state ensemble (1):      0.001 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.508 s
PDAF               Time for assimilation (3):      0.509 s
PDAF                   global preparations (4):      0.324 s
PDAF                   global preparations (4):      0.324 s
PDAF                         get mean state (11):      0.000 s
PDAF               Time for assimilation (3):      0.509 s
PDAF                   local analysis loop (6):      0.184 s
PDAF                         get mean state (11):      0.000 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                   global preparations (4):      0.324 s
PDAF                   local analysis loop (6):      0.185 s
PDAF                        global to local (15):      0.000 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                         get mean state (11):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                   local analysis loop (6):      0.185 s
PDAF                          local analysis (7):      0.182 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.000 s
PDAF                        local to global (16):      0.001 s
PDAF                          local analysis (7):      0.183 s
PDAF                 Time of prepoststep (5):      0.000 s
PDAF                          local analysis (7):      0.183 s
PDAF                        local to global (16):      0.001 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.000 s
 PDAF test suite: EXITED ASSIMILATION
PDAF                 Time of prepoststep (5):      0.000 s

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00059 MB (persistent)
            ensemble init:   0.25787 MB (temporary)
             Pre-Poststep:   0.00687 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and A:      0.020 MiB (persistent)
PDAF           ensemble array:      0.029 MiB (persistent)
PDAF            analysis step:      0.297 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.298 s
PDAF                   global preparations (4):      0.003 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.295 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.294 s
PDAF                    compute new inverse A (10):      0.012 s
PDAF                                       HZ_l (30):      0.002 s
PDAF                              complete Uinv (31):      0.010 s
PDAF                            init residual (12):      0.000 s
PDAF                  get state weight vector (13):      0.260 s
PDAF                 prepare ensemble weights (20):      0.018 s
PDAF                    store ensemble matrix (21):      0.001 s
PDAF                          update ensemble (22):      0.002 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.534 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.834 s
                   total run time:      0.837 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.298 s
PDAF                   global preparations (4):      0.003 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.295 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.294 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.534 s
Application 8683255 resources: utime ~3s, stime ~0s, Rss ~8460, inblocks ~33525, outblocks ~124022

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         1

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2       2      1      2      3      0       T
     3       3      1      3      4      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  4 PEs
     task   1 PE(model)   0 dim_local(state):    75
     task   1 PE(model)   1 dim_local(state):    75
     task   1 PE(model)   2 dim_local(state):    75
     task   1 PE(model)   3 dim_local(state):    75

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         5
  PARSER: subtype=         3
  PARSER: filename= output_par_letkf3.dat
                     Filter: LETKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Ensemble Transform Kalman Filter (LETKF)  +++
PDAF    +++                                                  +++
PDAF    +++            Domain-localized LETKF by             +++
PDAF    +++      Hunt et al., Physica D 230 (2007) 112       +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LETKF configuration
PDAF          filter sub-type = 3
PDAF            --> LETKF with fixed state covariance matrix
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      4
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     4
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-domain:     2 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
PDAF      --- PE-domain:     3 number of analysis domains:        75
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   5.7864E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-domain:     3 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   5.7864E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   5.7067E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
PDAF      --- PE-domain:     3 number of analysis domains:        75
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-domain:     2 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   5.7067E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   5.7356E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-domain:     3 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   5.7356E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   5.6909E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-domain:     3 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   5.6909E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   5.7546E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-domain:     3 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   5.7546E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   5.7334E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-domain:     3 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   5.7334E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   5.6801E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-domain:     3 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   5.6801E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-domain:     2 number of analysis domains:        75
PDAF      --- PE-domain:     3 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   5.6941E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
PDAF      --- PE-domain:     1 number of analysis domains:        75
PDAF      --- PE-domain:     3 number of analysis domains:        75
PDAF      --- PE-domain:     2 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   5.6941E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  3
 model PE exited: mype  2
 model PE exited: mype  1






PDAF                     PDAF Timing information
PDAF                     PDAF Timing information

PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
 PDAF test suite: EXITED ASSIMILATION
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF               Time for assimilation (3):      0.275 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF                   global preparations (4):      0.243 s
PDAF               Time for assimilation (3):      0.275 s
PDAF                   global preparations (4):      0.243 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF                         get mean state (11):      0.000 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.032 s
PDAF                   local analysis loop (6):      0.032 s
PDAF               Time for assimilation (3):      0.275 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                   global preparations (4):      0.243 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.000 s
PDAF                         get mean state (11):      0.000 s
PDAF                        global to local (15):      0.000 s
PDAF                   local analysis loop (6):      0.032 s
PDAF                          local analysis (7):      0.030 s
PDAF                          local analysis (7):      0.030 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        local to global (16):      0.000 s
PDAF                        local to global (16):      0.000 s
PDAF                        global to local (15):      0.000 s
PDAF                 Time of prepoststep (5):      0.003 s
PDAF                 Time of prepoststep (5):      0.003 s
PDAF                          local analysis (7):      0.031 s
PDAF                        local to global (16):      0.000 s
PDAF                 Time of prepoststep (5):      0.003 s

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00059 MB (persistent)
            ensemble init:   0.25787 MB (temporary)
             Pre-Poststep:   0.12074 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and A:      0.020 MiB (persistent)
PDAF           ensemble array:      0.029 MiB (persistent)
PDAF            analysis step:      0.277 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.261 s
PDAF                   global preparations (4):      0.003 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.258 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.000 s
PDAF                          local analysis (7):      0.256 s
PDAF                    compute new inverse A (10):      0.012 s
PDAF                                       HZ_l (30):      0.002 s
PDAF                              complete Uinv (31):      0.010 s
PDAF                            init residual (12):      0.000 s
PDAF                  get state weight vector (13):      0.243 s
PDAF                update state and ensemble (14):      0.000 s
PDAF                 Time of prepoststep (5):      0.448 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.710 s
                   total run time:      0.713 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.261 s
PDAF                   global preparations (4):      0.003 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.258 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.000 s
PDAF                          local analysis (7):      0.256 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.448 s
Application 8683256 resources: utime ~3s, stime ~0s, Rss ~8460, inblocks ~33525, outblocks ~124021
--------------------------------------------------------
Run ESTKF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2              2      0      1      1       F
     3              2      1      2      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         6
  PARSER: subtype=         0
  PARSER: filename= output_par_estkf0.dat
                     Filter: ESTKF
      -- Standard mode
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++ Error Subspace Transform Kalman Filter (ESTKF) +++
PDAF    +++                                                +++
PDAF    +++  Nerger et al., Mon. Wea. Rev. 140 (2012) 2335 +++
PDAF    +++           doi:10.1175/MWR-D-11-00102.1         +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ESTKF configuration
PDAF          filter sub-type = 0
PDAF            --> Standard ESTKF with ensemble integration
PDAF            --> Deterministic ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
PDAF     --- PE-domain      1 dimension of observation vector       150
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      2
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      4
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      6
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step      8
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     10
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     12
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     14
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     16
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     18
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- initialize observation at time step     20
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  1
 model PE exited: mype  2
 model PE exited: mype  3





PDAF                     PDAF Timing information


PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
 PDAF test suite: EXITED ASSIMILATION
PDAF             Generate state ensemble (1):      0.001 s
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF                   Time of forecasts (2):      0.070 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF                   Time of forecasts (2):      1.891 s
PDAF                   Time of forecasts (2):      1.892 s
PDAF               Time for assimilation (3):      0.771 s
PDAF       Time to collect/distribute ens (19):      1.891 s
PDAF       Time to collect/distribute ens (19):      1.821 s
PDAF                       get mean state (11):      0.000 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.762 s
PDAF                compute new inverse A (10):      0.002 s
PDAF              get state weight vector (13):      0.006 s

PDAF             prepare ensemble weights (20):      0.001 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                   transform ensemble (22):      0.001 s
PDAF                 Time of prepoststep (5):      0.000 s
                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.28648 MB (temporary)
             Pre-Poststep:   0.00916 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and A:      0.019 MiB (persistent)
PDAF           ensemble array:      0.057 MiB (persistent)
PDAF            analysis step:      0.402 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.012 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.001 s
PDAF                compute new inverse A (10):      0.002 s
PDAF                                   HL_p (30):      0.000 s
PDAF                          complete Uinv (31):      0.002 s
PDAF              get state weight vector (13):      0.006 s
PDAF             prepare ensemble weights (20):      0.001 s
PDAF                             SQRT(Uinv) (32):      0.000 s
PDAF                             init Omega (33):      0.000 s
PDAF                      compute Ct OmegaT (34):      0.000 s
PDAF                       complete weights (35):      0.000 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                   transform ensemble (22):      0.001 s
PDAF                 Time of prepoststep (5):      1.923 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      1.936 s
                   total run time:      1.940 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.012 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.001 s
PDAF                compute new inverse A (10):      0.002 s
PDAF              get state weight vector (13):      0.006 s
PDAF             prepare ensemble weights (20):      0.001 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                   transform ensemble (22):      0.001 s
PDAF                 Time of prepoststep (5):      1.923 s
Application 8683257 resources: utime ~6s, stime ~1s, Rss ~8460, inblocks ~33525, outblocks ~124008

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         1

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     3       3      1      3      4      0       T
     2       2      1      2      3      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  4 PEs
     task   1 PE(model)   0 dim_local(state):    75
     task   1 PE(model)   1 dim_local(state):    75
     task   1 PE(model)   2 dim_local(state):    75
     task   1 PE(model)   3 dim_local(state):    75

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         6
  PARSER: subtype=         2
  PARSER: filename= output_par_estkf2.dat
                     Filter: ESTKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++ Error Subspace Transform Kalman Filter (ESTKF) +++
PDAF    +++                                                +++
PDAF    +++  Nerger et al., Mon. Wea. Rev. 140 (2012) 2335 +++
PDAF    +++           doi:10.1175/MWR-D-11-00102.1         +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ESTKF configuration
PDAF          filter sub-type = 2
PDAF            --> ESTKF with fixed error-space basis
PDAF            --> Deterministic ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      4
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     4
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
PDAF     --- PE-domain      3 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      2
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      4
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      6
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      8
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     10
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     12
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     14
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     16
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     18
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     20
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  3
 model PE exited: mype  2
 model PE exited: mype  1





PDAF                     PDAF Timing information
PDAF                     PDAF Timing information

PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.002 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.002 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.211 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF                       get mean state (11):      0.000 s
PDAF               Time for assimilation (3):      0.211 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                       get mean state (11):      0.000 s
PDAF               Time for assimilation (3):      0.211 s
PDAF                        init residual (12):      0.203 s
PDAF           init observation dimension (15):      0.000 s
PDAF                       get mean state (11):      0.000 s
PDAF                        init residual (12):      0.203 s
PDAF                compute new inverse A (10):      0.001 s
PDAF                compute new inverse A (10):      0.001 s
PDAF           init observation dimension (15):      0.000 s
PDAF              get state weight vector (13):      0.006 s
PDAF              get state weight vector (13):      0.006 s
PDAF                        init residual (12):      0.203 s
PDAF             prepare ensemble weights (20):      0.001 s
PDAF             prepare ensemble weights (20):      0.001 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                compute new inverse A (10):      0.001 s
PDAF                   transform ensemble (22):      0.000 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF              get state weight vector (13):      0.006 s
PDAF                   transform ensemble (22):      0.000 s
PDAF                 Time of prepoststep (5):      0.000 s
PDAF                 Time of prepoststep (5):      0.000 s
PDAF             prepare ensemble weights (20):      0.001 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                   transform ensemble (22):      0.000 s
PDAF                 Time of prepoststep (5):      0.000 s

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00059 MB (persistent)
            ensemble init:   0.25787 MB (temporary)
             Pre-Poststep:   0.00687 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and A:      0.019 MiB (persistent)
PDAF           ensemble array:      0.029 MiB (persistent)
PDAF            analysis step:      0.343 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.011 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.001 s
PDAF                compute new inverse A (10):      0.001 s
PDAF                                   HL_p (30):      0.000 s
PDAF                          complete Uinv (31):      0.001 s
PDAF              get state weight vector (13):      0.007 s
PDAF             prepare ensemble weights (20):      0.001 s
PDAF                             SQRT(Uinv) (32):      0.000 s
PDAF                             init Omega (33):      0.000 s
PDAF                      compute Ct OmegaT (34):      0.000 s
PDAF                       complete weights (35):      0.000 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                   transform ensemble (22):      0.000 s
PDAF                 Time of prepoststep (5):      0.402 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.414 s
                   total run time:      0.418 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.011 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.001 s
PDAF                compute new inverse A (10):      0.001 s
PDAF              get state weight vector (13):      0.007 s
PDAF             prepare ensemble weights (20):      0.001 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                   transform ensemble (22):      0.000 s
PDAF                 Time of prepoststep (5):      0.402 s
Application 8683258 resources: utime ~2s, stime ~1s, Rss ~8460, inblocks ~33525, outblocks ~124012

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         1

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     3       3      1      3      4      0       T
     2       2      1      2      3      0       T
     1       1      1      1      2      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  4 PEs
     task   1 PE(model)   0 dim_local(state):    75
     task   1 PE(model)   1 dim_local(state):    75
     task   1 PE(model)   2 dim_local(state):    75
     task   1 PE(model)   3 dim_local(state):    75

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         6
  PARSER: subtype=         3
  PARSER: filename= output_par_estkf3.dat
                     Filter: ESTKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++ Error Subspace Transform Kalman Filter (ESTKF) +++
PDAF    +++                                                +++
PDAF    +++  Nerger et al., Mon. Wea. Rev. 140 (2012) 2335 +++
PDAF    +++           doi:10.1175/MWR-D-11-00102.1         +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ESTKF configuration
PDAF          filter sub-type = 3
PDAF            --> ESTKF with fixed state covariance matrix
PDAF            --> Deterministic ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      4
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     4
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      2
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   5.7864E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   6.9642E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   5.7067E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   6.9846E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   5.7356E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step      8
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   6.9530E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   5.6909E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     10
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   6.9980E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   5.7546E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     12
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   6.9831E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   5.7334E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     14
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   6.9453E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   5.6801E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     16
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   6.9498E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      1 dimension of observation vector        75
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     18
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   6.9552E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain      3 dimension of observation vector        75
PDAF     --- PE-domain      2 dimension of observation vector        75
PDAF     --- PE-domain      1 dimension of observation vector        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   5.6941E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        75
        --- initialize observation at time step     20
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   6.9498E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  2
 model PE exited: mype  1

 model PE exited: mype  3





PDAF                     PDAF Timing information
PDAF                     PDAF Timing information

 PDAF test suite: EXITED ASSIMILATION
PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------

PDAF             Generate state ensemble (1):      0.001 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF          ---------------------------------------------
PDAF                   Time of forecasts (2):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF               Time for assimilation (3):      0.182 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF               Time for assimilation (3):      0.182 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF                       get mean state (11):      0.000 s
PDAF                       get mean state (11):      0.000 s
PDAF               Time for assimilation (3):      0.182 s
PDAF           init observation dimension (15):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.175 s
PDAF                       get mean state (11):      0.000 s
PDAF                        init residual (12):      0.175 s
PDAF                compute new inverse A (10):      0.001 s
PDAF           init observation dimension (15):      0.000 s
PDAF                compute new inverse A (10):      0.001 s
PDAF              get state weight vector (13):      0.005 s
PDAF              get state weight vector (13):      0.005 s
PDAF                        init residual (12):      0.175 s
PDAF            update state and ensemble (14):      0.000 s
PDAF                compute new inverse A (10):      0.001 s
PDAF            update state and ensemble (14):      0.000 s
PDAF                 Time of prepoststep (5):      0.005 s
PDAF              get state weight vector (13):      0.005 s
PDAF                 Time of prepoststep (5):      0.005 s
PDAF            update state and ensemble (14):      0.000 s
PDAF                 Time of prepoststep (5):      0.005 s
                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00059 MB (persistent)
            ensemble init:   0.25787 MB (temporary)
             Pre-Poststep:   0.11959 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and A:      0.019 MiB (persistent)
PDAF           ensemble array:      0.029 MiB (persistent)
PDAF            analysis step:      0.211 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.008 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.001 s
PDAF                compute new inverse A (10):      0.001 s
PDAF                                   HL_p (30):      0.000 s
PDAF                          complete Uinv (31):      0.001 s
PDAF              get state weight vector (13):      0.006 s
PDAF            update state and ensemble (14):      0.000 s
PDAF                 Time of prepoststep (5):      0.333 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.342 s
                   total run time:      0.345 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.008 s
PDAF                       get mean state (11):      0.000 s
PDAF           init observation dimension (15):      0.000 s
PDAF                        init residual (12):      0.001 s
PDAF                compute new inverse A (10):      0.001 s
PDAF              get state weight vector (13):      0.006 s
PDAF            update state and ensemble (14):      0.000 s
PDAF                 Time of prepoststep (5):      0.333 s
Application 8683259 resources: utime ~2s, stime ~0s, Rss ~8460, inblocks ~33525, outblocks ~124008
--------------------------------------------------------
Run LESTKF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2              2      0      1      1       F
     3              2      1      2      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         7
  PARSER: subtype=         0
  PARSER: filename= output_par_lestkf0.dat
                     Filter: LESTKF
      -- Standard mode
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Error Subspace Transform Kalman Filter   +++
PDAF    +++                    (LESTKF)                     +++
PDAF    +++                                                 +++
PDAF    +++ Domain-localized implementation of the ESTKF by +++
PDAF    +++  Nerger et al., Mon. Wea. Rev. 140 (2012) 2335  +++
PDAF    +++           doi:10.1175/MWR-D-11-00102.1          +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LESTKF configuration
PDAF          filter sub-type = 0
PDAF            --> Standard LESTKF
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
PDAF     --- PE-domain:     1 number of analysis domains:       150
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  2
 model PE exited: mype  3
 model PE exited: mype  1







PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
 PDAF test suite: EXITED ASSIMILATION
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.000 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.903 s
PDAF                   Time of forecasts (2):      0.903 s
PDAF                   Time of forecasts (2):      0.130 s

PDAF       Time to collect/distribute ens (19):      0.773 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.902 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF           Time for analysis/re-init (3):      0.559 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF                   global preparations (4):      0.162 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.397 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.393 s
PDAF                        local to global (16):      0.001 s
                  Model - Memory overview
PDAF                 Time of prepoststep (5):      0.000 s
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.28648 MB (temporary)
             Pre-Poststep:   0.00916 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and A:      0.021 MiB (persistent)
PDAF           ensemble array:      0.057 MiB (persistent)
PDAF            analysis step:      0.409 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF           Time for analysis/re-init (3):      0.494 s
PDAF                   global preparations (4):      0.003 s
PDAF                         get mean state (11):      0.000 s
PDAF                             init Omega (33):      0.000 s
PDAF                   local analysis loop (6):      0.491 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.487 s
PDAF                            init residual (12):      0.001 s
PDAF                    compute new inverse U (10):      0.024 s
PDAF                                       HL_l (30):      0.004 s
PDAF                              complete Uinv (31):      0.019 s
PDAF                  get state weight vector (13):      0.393 s
PDAF                 prepare ensemble weights (20):      0.062 s
PDAF                                 SQRT(Uinv) (32):      0.030 s
PDAF                          compute Ct OmegaT (34):      0.026 s
PDAF                           complete weights (35):      0.006 s
PDAF                    store ensemble matrix (21):      0.002 s
PDAF                          update ensemble (22):      0.003 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.496 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.991 s
                   total run time:      0.995 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF           Time for analysis/re-init (3):      0.494 s
PDAF                   global preparations (4):      0.003 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.491 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.487 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.496 s
Application 8683260 resources: utime ~4s, stime ~1s, Rss ~8460, inblocks ~33525, outblocks ~124020

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         1

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     2       2      1      2      3      0       T
     3       3      1      3      4      0       T
     1       1      1      1      2      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  4 PEs
     task   1 PE(model)   0 dim_local(state):    75
     task   1 PE(model)   1 dim_local(state):    75
     task   1 PE(model)   2 dim_local(state):    75
     task   1 PE(model)   3 dim_local(state):    75

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         7
  PARSER: subtype=         2
  PARSER: filename= output_par_lestkf2.dat
                     Filter: LESTKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Error Subspace Transform Kalman Filter   +++
PDAF    +++                    (LESTKF)                     +++
PDAF    +++                                                 +++
PDAF    +++ Domain-localized implementation of the ESTKF by +++
PDAF    +++  Nerger et al., Mon. Wea. Rev. 140 (2012) 2335  +++
PDAF    +++           doi:10.1175/MWR-D-11-00102.1          +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LESTKF configuration
PDAF          filter sub-type = 2
PDAF            --> LESTKF with fixed error-space basis
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      4
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     4
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega
PDAF     --- PE-domain:     1 number of analysis domains:        75

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8577E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   7.0205E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3333E-01
               RMS error according to true variance:   9.4184E-01
              Relative underestimation of variances:   7.5226E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0207E-01
               RMS error according to true variance:   9.3827E-01
              Relative underestimation of variances:   7.8463E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8074E-01
               RMS error according to true variance:   9.2853E-01
              Relative underestimation of variances:   8.0535E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6499E-01
               RMS error according to true variance:   9.2803E-01
              Relative underestimation of variances:   8.2221E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5275E-01
               RMS error according to true variance:   9.2691E-01
              Relative underestimation of variances:   8.3520E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4289E-01
               RMS error according to true variance:   9.2203E-01
              Relative underestimation of variances:   8.4503E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3472E-01
               RMS error according to true variance:   9.2057E-01
              Relative underestimation of variances:   8.5366E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2780E-01
               RMS error according to true variance:   9.2052E-01
              Relative underestimation of variances:   8.6116E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2185E-01
               RMS error according to true variance:   9.1982E-01
              Relative underestimation of variances:   8.6752E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  2

 model PE exited: mype  3
 model PE exited: mype  1
 PDAF test suite: EXITED ASSIMILATION





PDAF                     PDAF Timing information

PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF           Time for analysis/re-init (3):      0.594 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF           Time for analysis/re-init (3):      0.593 s
PDAF                   global preparations (4):      0.393 s
PDAF           Time for analysis/re-init (3):      0.594 s
PDAF                   global preparations (4):      0.393 s
PDAF                         get mean state (11):      0.000 s
PDAF                   global preparations (4):      0.393 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.200 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.200 s
PDAF                   local analysis loop (6):      0.201 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.198 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.198 s
PDAF                          local analysis (7):      0.199 s
PDAF                        local to global (16):      0.001 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.000 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.000 s
PDAF                 Time of prepoststep (5):      0.000 s

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00059 MB (persistent)
            ensemble init:   0.25787 MB (temporary)
             Pre-Poststep:   0.00687 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and A:      0.019 MiB (persistent)
PDAF           ensemble array:      0.029 MiB (persistent)
PDAF            analysis step:      0.409 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF           Time for analysis/re-init (3):      0.307 s
PDAF                   global preparations (4):      0.003 s
PDAF                         get mean state (11):      0.000 s
PDAF                             init Omega (33):      0.000 s
PDAF                   local analysis loop (6):      0.303 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.301 s
PDAF                            init residual (12):      0.000 s
PDAF                    compute new inverse U (10):      0.012 s
PDAF                                       HL_l (30):      0.002 s
PDAF                              complete Uinv (31):      0.010 s
PDAF                  get state weight vector (13):      0.254 s
PDAF                 prepare ensemble weights (20):      0.031 s
PDAF                                 SQRT(Uinv) (32):      0.015 s
PDAF                          compute Ct OmegaT (34):      0.013 s
PDAF                           complete weights (35):      0.003 s
PDAF                    store ensemble matrix (21):      0.001 s
PDAF                          update ensemble (22):      0.002 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.695 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      1.004 s
                   total run time:      1.007 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF           Time for analysis/re-init (3):      0.307 s
PDAF                   global preparations (4):      0.003 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.303 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.301 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.695 s
Application 8683261 resources: utime ~4s, stime ~0s, Rss ~8460, inblocks ~33525, outblocks ~124023

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         1

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     3       3      1      3      4      0       T
     2       2      1      2      3      0       T


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  4 PEs
     task   1 PE(model)   0 dim_local(state):    75
     task   1 PE(model)   1 dim_local(state):    75
     task   1 PE(model)   2 dim_local(state):    75
     task   1 PE(model)   3 dim_local(state):    75

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         7
  PARSER: subtype=         3
  PARSER: filename= output_par_lestkf3.dat
                     Filter: LESTKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Error Subspace Transform Kalman Filter   +++
PDAF    +++                    (LESTKF)                     +++
PDAF    +++                                                 +++
PDAF    +++ Domain-localized implementation of the ESTKF by +++
PDAF    +++  Nerger et al., Mon. Wea. Rev. 140 (2012) 2335  +++
PDAF    +++           doi:10.1175/MWR-D-11-00102.1          +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LESTKF configuration
PDAF          filter sub-type = 3
PDAF            --> LESTKF with fixed state covariance matrix
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      4
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     4
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   5.7864E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5914E-01
              Relative underestimation of variances:   5.7864E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   5.7067E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4135E-01
              Relative underestimation of variances:   5.7067E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   5.7356E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4771E-01
              Relative underestimation of variances:   5.7356E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   5.6909E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain:     2 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3788E-01
              Relative underestimation of variances:   5.6909E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   5.7546E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.5195E-01
              Relative underestimation of variances:   5.7546E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   5.7334E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.4723E-01
              Relative underestimation of variances:   5.7334E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   5.6801E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3554E-01
              Relative underestimation of variances:   5.6801E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   5.6941E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
PDAF     --- PE-domain:     3 number of analysis domains:        75
PDAF     --- PE-domain:     1 number of analysis domains:        75
PDAF     --- PE-domain:     2 number of analysis domains:        75
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3858E-01
              Relative underestimation of variances:   5.6941E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:        75
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   9.3691E-01
              Relative underestimation of variances:   5.6864E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  2
 model PE exited: mype  3
 model PE exited: mype  1







PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
 PDAF test suite: EXITED ASSIMILATION
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s

PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF           Time for analysis/re-init (3):      0.269 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF                   global preparations (4):      0.223 s
PDAF           Time for analysis/re-init (3):      0.269 s
PDAF           Time for analysis/re-init (3):      0.270 s
PDAF                         get mean state (11):      0.000 s
PDAF                   global preparations (4):      0.223 s
PDAF                   global preparations (4):      0.223 s
PDAF                   local analysis loop (6):      0.046 s
PDAF                         get mean state (11):      0.000 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.046 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                   local analysis loop (6):      0.046 s
PDAF                        global to local (15):      0.000 s
PDAF                        global to local (15):      0.000 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                          local analysis (7):      0.044 s
PDAF                          local analysis (7):      0.045 s
PDAF                        global to local (15):      0.000 s
PDAF                        local to global (16):      0.000 s
PDAF                          local analysis (7):      0.045 s
PDAF                        local to global (16):      0.000 s
PDAF                 Time of prepoststep (5):      0.005 s
PDAF                        local to global (16):      0.000 s
PDAF                 Time of prepoststep (5):      0.005 s
PDAF                 Time of prepoststep (5):      0.005 s
                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00059 MB (persistent)
            ensemble init:   0.25787 MB (temporary)
             Pre-Poststep:   0.11959 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and A:      0.019 MiB (persistent)
PDAF           ensemble array:      0.029 MiB (persistent)
PDAF            analysis step:      0.314 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF           Time for analysis/re-init (3):      0.258 s
PDAF                   global preparations (4):      0.003 s
PDAF                         get mean state (11):      0.000 s
PDAF                             init Omega (33):      0.000 s
PDAF                   local analysis loop (6):      0.254 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.253 s
PDAF                            init residual (12):      0.000 s
PDAF                    compute new inverse U (10):      0.012 s
PDAF                                       HL_l (30):      0.002 s
PDAF                              complete Uinv (31):      0.010 s
PDAF                  get state weight vector (13):      0.239 s
PDAF                update state and ensemble (14):      0.000 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.483 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.742 s
                   total run time:      0.745 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF           Time for analysis/re-init (3):      0.258 s
PDAF                   global preparations (4):      0.003 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      0.254 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      0.253 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.483 s
Application 8683262 resources: utime ~3s, stime ~0s, Rss ~8460, inblocks ~33525, outblocks ~124021
--------------------------------------------------------
Run LENKF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2              2      0      1      1       F
     3              2      1      2      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         8
  PARSER: subtype=         0
  PARSER: filename= output_par_lenkf0.dat
                     Filter: localized EnKF
      -- Standard mode
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF     +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF     +++    Localized Ensemble Kalman Filter (LEnKF)     +++
PDAF     +++                                                 +++
PDAF     +++   Evensen, J. Geophys. Res. 99C (1994) 10143    +++
PDAF     +++ using an ensemble of observations according to  +++
PDAF     +++ Burgers et al., Mon. Wea. Rev. 126 (1998) 1719  +++
PDAF     +++          This implementation follows            +++
PDAF     +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF     +++   The localization is covariance lozalization   +++
PDAF     +++        of PH^T and HPH^T as described in        +++
PDAF     +++   Houtekamer & Mitchell, MWR, 129 (2001) 123    +++
PDAF     +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF      local EnKF configuration
PDAF            filter sub-type = 0
PDAF              --> local EnKF (analysis for small observation dimension)
PDAF              --> ensemble size:   50
PDAF          --> forgetting factor: 1.00

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
PDAF     --- PE-domain      1 dimension of observation vector       150
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - localized EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- Apply covariance localization
            --- Local influence radius        10.00
            --- Use uniform weight
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      2
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8067E-01
               RMS error according to true variance:   9.6119E-01
              Relative underestimation of variances:   7.0800E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8067E-01
               RMS error according to true variance:   9.6119E-01
              Relative underestimation of variances:   7.0800E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - localized EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- Apply covariance localization
            --- Local influence radius        10.00
            --- Use uniform weight
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      4
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.1808E-01
               RMS error according to true variance:   9.4463E-01
              Relative underestimation of variances:   7.6914E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.1808E-01
               RMS error according to true variance:   9.4463E-01
              Relative underestimation of variances:   7.6914E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - localized EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- Apply covariance localization
            --- Local influence radius        10.00
            --- Use uniform weight
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      6
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8610E-01
               RMS error according to true variance:   9.4266E-01
              Relative underestimation of variances:   8.0258E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.8610E-01
               RMS error according to true variance:   9.4266E-01
              Relative underestimation of variances:   8.0258E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - localized EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- Apply covariance localization
            --- Local influence radius        10.00
            --- Use uniform weight
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      8
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6359E-01
               RMS error according to true variance:   9.3540E-01
              Relative underestimation of variances:   8.2511E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.6359E-01
               RMS error according to true variance:   9.3540E-01
              Relative underestimation of variances:   8.2511E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - localized EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- Apply covariance localization
            --- Local influence radius        10.00
            --- Use uniform weight
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     10
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4805E-01
               RMS error according to true variance:   9.3371E-01
              Relative underestimation of variances:   8.4144E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4805E-01
               RMS error according to true variance:   9.3371E-01
              Relative underestimation of variances:   8.4144E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - localized EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- Apply covariance localization
            --- Local influence radius        10.00
            --- Use uniform weight
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     12
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3598E-01
               RMS error according to true variance:   9.3297E-01
              Relative underestimation of variances:   8.5425E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3598E-01
               RMS error according to true variance:   9.3297E-01
              Relative underestimation of variances:   8.5425E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - localized EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- Apply covariance localization
            --- Local influence radius        10.00
            --- Use uniform weight
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     14
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2379E-01
               RMS error according to true variance:   9.2788E-01
              Relative underestimation of variances:   8.6659E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2379E-01
               RMS error according to true variance:   9.2788E-01
              Relative underestimation of variances:   8.6659E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - localized EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- Apply covariance localization
            --- Local influence radius        10.00
            --- Use uniform weight
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     16
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.1630E-01
               RMS error according to true variance:   9.2643E-01
              Relative underestimation of variances:   8.7447E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.1630E-01
               RMS error according to true variance:   9.2643E-01
              Relative underestimation of variances:   8.7447E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - localized EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- Apply covariance localization
            --- Local influence radius        10.00
            --- Use uniform weight
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     18
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.1042E-01
               RMS error according to true variance:   9.2603E-01
              Relative underestimation of variances:   8.8076E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     --- PE-domain      1 dimension of observation vector       150
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.1042E-01
               RMS error according to true variance:   9.2603E-01
              Relative underestimation of variances:   8.8076E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - localized EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector       150
        --- Apply covariance localization
            --- Local influence radius        10.00
            --- Use uniform weight
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     20
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.0557E-01
               RMS error according to true variance:   9.2497E-01
              Relative underestimation of variances:   8.8587E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  1
 model PE exited: mype  3
 model PE exited: mype  2



PDAF                     PDAF Timing information



PDAF          ---------------------------------------------
PDAF                     PDAF Timing information

PDAF                     PDAF Timing information
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.034 s
PDAF          ---------------------------------------------
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF          ---------------------------------------------
PDAF                   Time of forecasts (2):      0.411 s
PDAF               Time of assimilations (3):      0.251 s
PDAF                       get mean state (11):      0.000 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.376 s
PDAF                        compute HPH+R (10):      0.046 s
PDAF                   Time of forecasts (2):      0.411 s
PDAF               generate obs. ensemble (15):      0.026 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF       Time to collect/distribute ens (19):      0.410 s
PDAF                        init residual (12):      0.001 s
PDAF              ensemble transformation (14):      0.028 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF                 Time of prepoststep (5):      0.000 s
 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.28648 MB (temporary)
             Pre-Poststep:   0.00916 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and A:      0.001 MiB (persistent)
PDAF           ensemble array:      0.029 MiB (persistent)
PDAF            analysis step:      1.365 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time of assimilations (3):      0.101 s
PDAF                       get mean state (11):      0.000 s
PDAF                        compute HPH+R (10):      0.028 s
PDAF                               HXmean_p (33):      0.000 s
PDAF                                 HXpert (30):      0.001 s
PDAF                                    HPH (32):      0.005 s
PDAF               generate obs. ensemble (15):      0.044 s
PDAF                        init residual (12):      0.001 s
PDAF              ensemble transformation (14):      0.028 s
PDAF                 solve for representers (13):      0.025 s
PDAF                blocked ensemble update (16):      0.003 s
PDAF                           HX*representer (31):      0.004 s
PDAF                             blocked X-Xm (35):      0.000 s
PDAF                          update ensemble (38):      0.000 s
PDAF                 Time of prepoststep (5):      0.353 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.456 s
                   total run time:      0.459 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time of assimilations (3):      0.101 s
PDAF                       get mean state (11):      0.000 s
PDAF                        compute HPH+R (10):      0.028 s
PDAF               generate obs. ensemble (15):      0.044 s
PDAF                        init residual (12):      0.001 s
PDAF              ensemble transformation (14):      0.028 s
PDAF                 Time of prepoststep (5):      0.353 s
Application 8683263 resources: utime ~2s, stime ~1s, Rss ~8980, inblocks ~33525, outblocks ~124010
--------------------------------------------------------
Run NETF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     2              2      0      1      1       F
     3              2      1      2      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         9
  PARSER: subtype=         0
  PARSER: filename= output_par_netf0.dat
                     Filter: NETF
      -- Standard mode
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++      Nonlinear Ensemble Transform Filter (NETF)       +++
PDAF    +++                                                       +++
PDAF    +++                         by                            +++
PDAF    +++ J. Toedter, B. Ahrens, Mon. Wea. Rev. 143 (2015) 1347 +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    NETF configuration
PDAF           filter sub-type = 0
PDAF            --> NETF 
PDAF            --> Transform ensemble including product with random matrix
PDAF            --> Use fixed forgetting factor: 1.00

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step      2
PDAF     --- Effective sample size       1.66
PDAF     --- number of small singular values     2
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5757E-01
               RMS error according to true variance:   1.0195E+00
              Relative underestimation of variances:   7.4736E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5757E-01
               RMS error according to true variance:   1.0195E+00
              Relative underestimation of variances:   7.4736E-01
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step      4
PDAF     --- Effective sample size       2.30
PDAF     --- number of small singular values     6
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   6.6714E-02
               RMS error according to true variance:   1.0030E+00
              Relative underestimation of variances:   9.3348E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   6.6714E-02
               RMS error according to true variance:   1.0030E+00
              Relative underestimation of variances:   9.3348E-01
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step      6
PDAF     --- Effective sample size      17.28
PDAF     --- number of small singular values     0
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.6322E-02
               RMS error according to true variance:   1.0013E+00
              Relative underestimation of variances:   9.5374E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.6322E-02
               RMS error according to true variance:   1.0013E+00
              Relative underestimation of variances:   9.5374E-01
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step      8
PDAF     --- Effective sample size      37.19
PDAF     --- number of small singular values     0
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.9465E-02
               RMS error according to true variance:   1.0012E+00
              Relative underestimation of variances:   9.6058E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.9465E-02
               RMS error according to true variance:   1.0012E+00
              Relative underestimation of variances:   9.6058E-01
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step     10
PDAF     --- Effective sample size      32.74
PDAF     --- number of small singular values     0
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4787E-02
               RMS error according to true variance:   1.0005E+00
              Relative underestimation of variances:   9.6523E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4787E-02
               RMS error according to true variance:   1.0005E+00
              Relative underestimation of variances:   9.6523E-01
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step     12
PDAF     --- Effective sample size      30.21
PDAF     --- number of small singular values     0
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9067E-02
               RMS error according to true variance:   9.9947E-01
              Relative underestimation of variances:   9.7092E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9067E-02
               RMS error according to true variance:   9.9947E-01
              Relative underestimation of variances:   9.7092E-01
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step     14
PDAF     --- Effective sample size      20.21
PDAF     --- number of small singular values     0
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5601E-02
               RMS error according to true variance:   9.9852E-01
              Relative underestimation of variances:   9.7436E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5601E-02
               RMS error according to true variance:   9.9852E-01
              Relative underestimation of variances:   9.7436E-01
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step     16
PDAF     --- Effective sample size      33.60
PDAF     --- number of small singular values     0
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.4757E-02
               RMS error according to true variance:   9.9830E-01
              Relative underestimation of variances:   9.7520E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.4757E-02
               RMS error according to true variance:   9.9830E-01
              Relative underestimation of variances:   9.7520E-01
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step     18
PDAF     --- Effective sample size      41.99
PDAF     --- number of small singular values     0
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3949E-02
               RMS error according to true variance:   9.9798E-01
              Relative underestimation of variances:   9.7600E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.3949E-02
               RMS error according to true variance:   9.9798E-01
              Relative underestimation of variances:   9.7600E-01
PDAF     --- PE-domain   1 dimension of observation vector     150
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector     150
        --- initialize observation at time step     20
PDAF     --- Effective sample size      30.19
PDAF     --- number of small singular values     0
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.2066E-02
               RMS error according to true variance:   9.9721E-01
              Relative underestimation of variances:   9.7787E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  1
 model PE exited: mype  3
 model PE exited: mype  2






PDAF                     PDAF Timing information

PDAF                     PDAF Timing information
PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.000 s
PDAF                   Time of forecasts (2):      0.033 s
PDAF             Generate state ensemble (1):      0.000 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF                   Time of forecasts (2):      0.356 s
PDAF               Time for assimilation (3):      0.167 s
PDAF                   Time of forecasts (2):      0.356 s
PDAF       Time to collect/distribute ens (19):      0.324 s
PDAF           init observation dimension (15):      0.000 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF       Time to collect/distribute ens (19):      0.356 s
PDAF       Note: for filterpe=F, the time (2) includes the wait time for the analysis step
PDAF               compute filter weights (12):      0.132 s
PDAF                     compute matrix A (10):      0.000 s
PDAF             compute transform matrix (13):      0.009 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                   transform ensemble (22):      0.001 s
 PDAF test suite: EXITED ASSIMILATION
PDAF                 Time of prepoststep (5):      0.000 s

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.28648 MB (temporary)
             Pre-Poststep:   0.00916 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and A:      0.020 MiB (persistent)
PDAF           ensemble array:      0.057 MiB (persistent)
PDAF            analysis step:      0.251 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.039 s
PDAF           init observation dimension (15):      0.000 s
PDAF                       inflate ensemble (34):      0.000 s
PDAF               compute filter weights (12):      0.002 s
PDAF                     compute matrix A (10):      0.000 s
PDAF             compute transform matrix (13):      0.010 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                   transform ensemble (22):      0.001 s
PDAF                 Time of prepoststep (5):      0.351 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      0.391 s
                   total run time:      0.394 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      0.039 s
PDAF           init observation dimension (15):      0.000 s
PDAF               compute filter weights (12):      0.002 s
PDAF                     compute matrix A (10):      0.000 s
PDAF             compute transform matrix (13):      0.010 s
PDAF                store ensemble matrix (21):      0.000 s
PDAF                   transform ensemble (22):      0.001 s
PDAF                 Time of prepoststep (5):      0.351 s
Application 8683264 resources: utime ~2s, stime ~0s, Rss ~8460, inblocks ~33527, outblocks ~124008
--------------------------------------------------------
Run NETF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on   4 PEs



  PARSER: tasks=         2

 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T
     1       1      1      1      2      0       T
     3              2      1      2      1       F
     2              2      0      1      1       F


  PARSER: dim_state=       300
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:    300
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  2 PEs
     task   1 PE(model)   0 dim_local(state):   150
     task   1 PE(model)   1 dim_local(state):   150

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=        10
  PARSER: subtype=         0
  PARSER: filename= output_par_lnetf0.dat
                     Filter: LNETF
      -- Standard mode
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.14.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++   Local Nonlinear Ensemble Transform Filter (LNETF)   +++
PDAF    +++                                                       +++
PDAF    +++              Domain-localized NETF by                 +++
PDAF    +++ J. Toedter, B. Ahrens, Mon. Wea. Rev. 143 (2015) 1347 +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LNETF configuration
PDAF          filter sub-type = 0
PDAF            --> LNETF 
PDAF            --> Transform ensemble including product with random matrix
PDAF            --> Use fixed forgetting factor: 1.00

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      4
PDAF      Number of parallel model tasks:      2
PDAF                      PEs for Filter:      2
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1     2
PDAF     #PEs     2     2
PDAF        N    25    25

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.0415E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   5.9585E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - LNETF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Initialize random transformation
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF        Minimal  effective ensemble size:             1.0
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:                0
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5007E-01
               RMS error according to true variance:   1.0029E+00
              Relative underestimation of variances:   7.5065E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5007E-01
               RMS error according to true variance:   1.0029E+00
              Relative underestimation of variances:   7.5065E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - LNETF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Initialize random transformation
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF        Minimal  effective ensemble size:             1.2
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:               17
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3598E-01
               RMS error according to true variance:   9.8811E-01
              Relative underestimation of variances:   8.6238E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3598E-01
               RMS error according to true variance:   9.8811E-01
              Relative underestimation of variances:   8.6238E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - LNETF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Initialize random transformation
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF        Minimal  effective ensemble size:             9.9
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:                0
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.0957E-01
               RMS error according to true variance:   9.8256E-01
              Relative underestimation of variances:   8.8849E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.0957E-01
               RMS error according to true variance:   9.8256E-01
              Relative underestimation of variances:   8.8849E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - LNETF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Initialize random transformation
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF        Minimal  effective ensemble size:             4.9
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:                0
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.8994E-02
               RMS error according to true variance:   9.7408E-01
              Relative underestimation of variances:   9.0864E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.8994E-02
               RMS error according to true variance:   9.7408E-01
              Relative underestimation of variances:   9.0864E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - LNETF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Initialize random transformation
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF        Minimal  effective ensemble size:            18.2
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:                0
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.4194E-02
               RMS error according to true variance:   9.7223E-01
              Relative underestimation of variances:   9.1340E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.4194E-02
               RMS error according to true variance:   9.7223E-01
              Relative underestimation of variances:   9.1340E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - LNETF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Initialize random transformation
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF        Minimal  effective ensemble size:            21.8
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:                0
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   7.9932E-02
               RMS error according to true variance:   9.7124E-01
              Relative underestimation of variances:   9.1770E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   7.9932E-02
               RMS error according to true variance:   9.7124E-01
              Relative underestimation of variances:   9.1770E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - LNETF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Initialize random transformation
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF        Minimal  effective ensemble size:            11.1
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:                0
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   7.3651E-02
               RMS error according to true variance:   9.6798E-01
              Relative underestimation of variances:   9.2391E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   7.3651E-02
               RMS error according to true variance:   9.6798E-01
              Relative underestimation of variances:   9.2391E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - LNETF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Initialize random transformation
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF        Minimal  effective ensemble size:            25.1
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:                0
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   7.0108E-02
               RMS error according to true variance:   9.6643E-01
              Relative underestimation of variances:   9.2746E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   7.0108E-02
               RMS error according to true variance:   9.6643E-01
              Relative underestimation of variances:   9.2746E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - LNETF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Initialize random transformation
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF        Minimal  effective ensemble size:            23.6
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:                0
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   6.5636E-02
               RMS error according to true variance:   9.6534E-01
              Relative underestimation of variances:   9.3201E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Distribute sub-ensembles
PDAF     --- Gather sub-ensembles on filter task
PDAF      --- PE-domain:     1 number of analysis domains:       150
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   6.5636E-02
               RMS error according to true variance:   9.6534E-01
              Relative underestimation of variances:   9.3201E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - LNETF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:       150
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector       300
PDAF     --- Initialize random transformation
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius   1.0000E+01
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:              300
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     20.6
PDAF        Minimal  effective ensemble size:            24.8
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:                0
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   6.4775E-02
               RMS error according to true variance:   9.6440E-01
              Relative underestimation of variances:   9.3283E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype  0
 model PE exited: mype  1
 model PE exited: mype  2
 model PE exited: mype  3



PDAF                     PDAF Timing information
 PDAF test suite: EXITED ASSIMILATION

PDAF          ---------------------------------------------
                  Model - Memory overview
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.040 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      1.233 s
PDAF                   global preparations (4):      0.145 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      1.088 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      1.084 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.000 s
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00115 MB (persistent)
            ensemble init:   0.28648 MB (temporary)
             Pre-Poststep:   0.00916 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MiB)
PDAF              state and A:      0.020 MiB (persistent)
PDAF           ensemble array:      0.057 MiB (persistent)
PDAF            analysis step:      3.203 MiB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      1.228 s
PDAF                   global preparations (4):      0.027 s
PDAF                apply forgetting factor (14):      0.000 s
PDAF                  compute HX for filter (12):      0.002 s
PDAF                         get mean state (11):      0.000 s
PDAF                 generate random matrix (13):      0.024 s
PDAF                   local analysis loop (6):      1.202 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      1.198 s
PDAF                           init local obs (21):      0.000 s
PDAF                 compute particle weights (22):      0.068 s
PDAF                                compute A (23):      0.002 s
PDAF                 compute transform matrix (24):      0.000 s
PDAF                compute SVD of W-ww^t and T (31):      1.062 s
PDAF                 compute product of T and A (32):      0.008 s
PDAF                        multiply with svals (33):      0.026 s
PDAF                        apply random matrix (35):      0.023 s
PDAF                       transform ensemble (25):      0.006 s
PDAF                      store ensemble matrix (36):      0.001 s
PDAF                            update ensemble (37):      0.003 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.382 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.002 s
                       assimilation:      1.613 s
                   total run time:      1.616 s

 PDAF test suite: END


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF             Generate state ensemble (1):      0.001 s
PDAF                   Time of forecasts (2):      0.001 s
PDAF       Time to collect/distribute ens (19):      0.000 s
PDAF               Time for assimilation (3):      1.228 s
PDAF                   global preparations (4):      0.027 s
PDAF                         get mean state (11):      0.000 s
PDAF                   local analysis loop (6):      1.202 s
PDAF                search local obs. domain (9):      0.000 s
PDAF                        global to local (15):      0.001 s
PDAF                          local analysis (7):      1.198 s
PDAF                        local to global (16):      0.001 s
PDAF                 Time of prepoststep (5):      0.382 s
Application 8683265 resources: utime ~7s, stime ~1s, Rss ~8460, inblocks ~33526, outblocks ~124021
PDAF tests completed:  Thu Jul 4 13:10:12 CEST 2019
 
Checking outputs:
Verification directory:  ../tests_dummy1D/out.cray_xc_hlrn/
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,
Traceback (most recent call last):
  File "../tests_dummy1D/check.py", line 13, in <module>
    field = np.loadtxt(fname)
  File "/usr/lib64/python2.6/site-packages/numpy/lib/io.py", line 489, in loadtxt
    X.append(tuple([conv(val) for (conv, val) in zip(converters, vals)]))
ValueError: invalid literal for float(): 0,

********************************************************************************
* Batch Job Information:                                                       *
********************************************************************************
End Time:               Thu Jul 4 13:10:22 CEST 2019
Walltime:               00:04:35
Requested Walltime:     00:30:00
Estimated NPL usage:    .152
********************************************************************************

