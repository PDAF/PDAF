!$Id: initialize.F90 870 2021-11-22 14:02:55Z lnerger $
!>  Initialize model
!!
!! Initialization routine for the simple 2D model without
!! parallelization of the model.
!!
!! The routine defines the size of the model grid and
!! reads the initial state from a file. 
!!
!! __Revision history:__
!! * 2013-09 - Lars Nerger - Initial code
!! * Later revisions - see repository log
!!
SUBROUTINE initialize()

  USE mod_model, &          ! Model variables
       ONLY: nx, ny, field, fieldB, total_steps

  IMPLICIT NONE

! *** local variables ***
  INTEGER :: i              ! Counters


! **********************
! *** INITIALIZATION ***
! **********************

! *** Model specifications ***
  nx = 36          ! Extent of grid in x-direction
  ny = 18          ! Extent of grid in y-direction
  total_steps = 18 ! Number of time steps to perform

! *** Screen output ***
  WRITE (*, '(1x, a)') 'INITIALIZE 2D-2FIELDS TUTORIAL MODEL'
  WRITE (*, '(10x,a,i4,1x,a1,1x,i4)') 'Grid size:', nx, 'x', ny
  WRITE (*, '(10x,a,i4)') 'Time steps', total_steps

  ! allocate arrays for model fields
  ALLOCATE(field(ny, nx))
  ALLOCATE(fieldB(ny, nx))


! *************************************
! *** Read initial fields from file ***
! *************************************

  OPEN(11, file = '../inputs_online_2fields/true_initial.txt', status='old')
 
  DO i = 1, ny
     READ (11, *) field(i, :)
  END DO

  CLOSE(11)

  ! Field0
  OPEN(11, file = '../inputs_online_2fields/trueB_initial.txt', status='old')
 
  DO i = 1, ny
     READ (11, *) fieldB(i, :)
  END DO

  CLOSE(11)
  
END SUBROUTINE initialize
