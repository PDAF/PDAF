Model binding for PDAF with AWI-CM1.4

Qi Tang, Lars Nerger, AWI, June 2019
Contact: pdaf@awi.de

This model binding for AWI-CM 1.4 (ECHAM6 with FESOM)
was originally described in the article in GMD
"Efficient ensemble data assimilation for 
coupled models with the Parallel Data Assimilation Framework: 
Example of ECHAM6-FESOM". 

These files provide the model binding for PDAF with AWI-CM1.4
(repository revision 550).
The directories
	fesom_cpl
	oasis3-mct
	echam-6.3.02p4
contain the PDAF user files and modified CMakeLists.txt files with
adaptions for compiling with PDAF. The modifications to the model
routines themselves are provided as patch files since license 
restrictions of the AWI-CM components do not allow us to make the
actual routines available. You recoqnize the patch files by their
suffix '.patch'.
The content of this directory including it subdirectories can be
copied over the existing directory structure of AWI-CM to add the
files. Further the modifications from the patch files have to be
applied. 

For the compilation you can use the script 'compile.sh'. One needs
to setthe environment variable PDAF_DIR to point to the installation
directory of PDAF. The compile environment is part of AWI-CM and 
not part of this package. 

For compiling you will need the PDAF package (from http://pdaf.awi.de).
The scaling experiments have been run using PDAF 1.14.0, but it would 
also work with newer versions.
You should compile the PDAF library as described in that package. Then
set the environment variable PDAF_DIR to the lib/ directory of your
PDAF installation.

As in the regular AWI-CM directory tree, you find run scripts in
the directory run_scripts/ and the namelist files in xmls_and_namelists/
For PDAF there is the additional namelist file namelist.pdaf which 
defines the settings for data assimilation with PDAF.

The directory tools/ contains tool programs to prepare the covariance
matrix information and SST observation files. Each subdirectory 
contains one tools program, a Makefile and an example run script.
The subdirectories are

gen_obs/
Contains the program obs_interp.F90 interpolates the CMEMS SST 
observations onto the FESOM mesh and writes these interpolated observations 
into a netCDF file.

dis_obs/
Contains the program distribute_obs.F90 which uses the distributed mesh
information from FESOM to generate observation files according to the
distributed mesh. It reads the netCDF file from obs_interp.F90 and
writes one observation file per FESOM sub-domain.

gen_cov/
Contains the program generate_covar.F90 which reads files from a FESOM
trajectory, computes an EOF decomposition and write the singular
values and vectors into a netCDF file.

dis_cov/
Contains the program distribute_covar_AWI-CM.F90 w$hich uses the i
distributed mesh information from FESOM to generate covariane files 
according to the distributed mesh. It reads the netCDF file 
generated by generate_covar.F90 and writes one covariance file 
per FESOM sub-domain.

The path to files and the filenames for the tool programs are set
within each program. 
