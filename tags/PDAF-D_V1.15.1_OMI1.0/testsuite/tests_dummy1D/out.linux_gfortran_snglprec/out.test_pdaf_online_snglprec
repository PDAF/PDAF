====================  Testing PDAF  ====================
Machine:  Linux binf02l009 3.13.0-100-generic #147-Ubuntu SMP Tue Oct 18 16:48:51 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux
Date:  Tue Dec 20 11:13:41 CET 2016
--------------------------------------------------------
Run SEEK tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        49
  PARSER: filtertype=         0
  PARSER: subtype=         0
  PARSER: filename= output_seek0.dat

                     Filter: SEEK
             number of EOFs:   49
      Assimilation interval:    2
          forgetting factor: 1.00
          Re-diag each    1-th analysis step

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF     +++                  SEEK Filter                   +++
PDAF     +++                                                +++
PDAF     +++    Pham et al., J. Mar. Syst. 16 (1998) 323    +++
PDAF     +++          This implementation follows           +++
PDAF     +++      Nerger et al., Tellus 57A (2005) 715      +++
PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEEK configuration
PDAF          filter sub-type = 0
PDAF            --> Standard SEEK with unit modes
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> number of EOFs:   49
PDAF          Re-diag at each analysis step

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    49
PDAF   Evolve central state on task:   1

PDAF: Call routine for ensemble initialization

         Initialize state estimate and EOF decomposed covariance matrix
         --- number of EOFs:   49

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecast state ensemble
            RMS error according to sampled variance:   8.3780E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6220E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      2
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   5.9201E-01
               RMS error according to true variance:   8.1045E-01
              Relative underestimation of variances:   2.6953E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecast state ensemble
            RMS error according to sampled variance:   5.9160E-01
               RMS error according to true variance:   8.1045E-01
              Relative underestimation of variances:   2.7003E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      4
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   4.8304E-01
               RMS error according to true variance:   7.1122E-01
              Relative underestimation of variances:   3.2082E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecast state ensemble
            RMS error according to sampled variance:   4.8370E-01
               RMS error according to true variance:   7.1122E-01
              Relative underestimation of variances:   3.1990E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      6
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   4.1875E-01
               RMS error according to true variance:   6.7158E-01
              Relative underestimation of variances:   3.7646E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecast state ensemble
            RMS error according to sampled variance:   4.1925E-01
               RMS error according to true variance:   6.7158E-01
              Relative underestimation of variances:   3.7572E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      8
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   3.7482E-01
               RMS error according to true variance:   6.8122E-01
              Relative underestimation of variances:   4.4979E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecast state ensemble
            RMS error according to sampled variance:   3.7533E-01
               RMS error according to true variance:   6.8122E-01
              Relative underestimation of variances:   4.4904E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     10
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   3.4245E-01
               RMS error according to true variance:   6.5696E-01
              Relative underestimation of variances:   4.7874E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecast state ensemble
            RMS error according to sampled variance:   3.4291E-01
               RMS error according to true variance:   6.5696E-01
              Relative underestimation of variances:   4.7804E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     12
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   3.1729E-01
               RMS error according to true variance:   6.5007E-01
              Relative underestimation of variances:   5.1191E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecast state ensemble
            RMS error according to sampled variance:   3.1766E-01
               RMS error according to true variance:   6.5007E-01
              Relative underestimation of variances:   5.1134E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     14
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.9698E-01
               RMS error according to true variance:   6.3706E-01
              Relative underestimation of variances:   5.3384E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecast state ensemble
            RMS error according to sampled variance:   2.9745E-01
               RMS error according to true variance:   6.3706E-01
              Relative underestimation of variances:   5.3309E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     16
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.8026E-01
               RMS error according to true variance:   6.3827E-01
              Relative underestimation of variances:   5.6091E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecast state ensemble
            RMS error according to sampled variance:   2.7797E-01
               RMS error according to true variance:   6.3827E-01
              Relative underestimation of variances:   5.6450E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     18
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.6379E-01
               RMS error according to true variance:   6.2442E-01
              Relative underestimation of variances:   5.7755E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecast state ensemble
            RMS error according to sampled variance:   2.6163E-01
               RMS error according to true variance:   6.2442E-01
              Relative underestimation of variances:   5.8101E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     20
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use normalized modes
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.4970E-01
               RMS error according to true variance:   6.2101E-01
              Relative underestimation of variances:   5.9791E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.02708 MB (temporary)
             Pre-Poststep:   0.04788 MB (temporary)


PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.00943 MB (persistent)
PDAF         covariance modes:   0.01308 MB (persistent)
PDAF            analysis step:   0.05527 MB (temporary)
PDAF         reinitialization:   0.04150 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF                 EOF initialization:      0.000 s
PDAF                  Time of forecasts:      0.001 s
PDAF              Time of assimilations:      0.001 s
PDAF               re-diagonalize covar:      0.002 s
PDAF                Time of prepoststep:      0.003 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.007 s
                   total run time:      0.008 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        49
  PARSER: filtertype=         0
  PARSER: subtype=         1
  PARSER: filename= output_seek1.dat

                     Filter: SEEK
             number of EOFs:   49
      Assimilation interval:    2
          forgetting factor: 1.00
          Re-diag each    1-th analysis step

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF     +++                  SEEK Filter                   +++
PDAF     +++                                                +++
PDAF     +++    Pham et al., J. Mar. Syst. 16 (1998) 323    +++
PDAF     +++          This implementation follows           +++
PDAF     +++      Nerger et al., Tellus 57A (2005) 715      +++
PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEEK configuration
PDAF          filter sub-type = 1
PDAF            --> SEEK with non-unit modes
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> number of EOFs:   49
PDAF          Re-diag at each analysis step

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    49
PDAF   Evolve central state on task:   1

PDAF: Call routine for ensemble initialization

         Initialize state estimate and EOF decomposed covariance matrix
         --- number of EOFs:   49

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecast state ensemble
            RMS error according to sampled variance:   8.3780E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6220E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      2
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   5.9201E-01
               RMS error according to true variance:   8.1045E-01
              Relative underestimation of variances:   2.6953E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecast state ensemble
            RMS error according to sampled variance:   5.9224E-01
               RMS error according to true variance:   8.1045E-01
              Relative underestimation of variances:   2.6924E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      4
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   4.8339E-01
               RMS error according to true variance:   7.1160E-01
              Relative underestimation of variances:   3.2070E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecast state ensemble
            RMS error according to sampled variance:   4.8273E-01
               RMS error according to true variance:   7.1160E-01
              Relative underestimation of variances:   3.2162E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      6
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   4.1812E-01
               RMS error according to true variance:   6.7194E-01
              Relative underestimation of variances:   3.7773E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecast state ensemble
            RMS error according to sampled variance:   4.1835E-01
               RMS error according to true variance:   6.7194E-01
              Relative underestimation of variances:   3.7740E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      8
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8174E-01
              Relative underestimation of variances:   4.5116E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecast state ensemble
            RMS error according to sampled variance:   3.7501E-01
               RMS error according to true variance:   6.8174E-01
              Relative underestimation of variances:   4.4992E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     10
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   3.4221E-01
               RMS error according to true variance:   6.5742E-01
              Relative underestimation of variances:   4.7947E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecast state ensemble
            RMS error according to sampled variance:   3.4310E-01
               RMS error according to true variance:   6.5742E-01
              Relative underestimation of variances:   4.7812E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     12
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   3.1744E-01
               RMS error according to true variance:   6.5056E-01
              Relative underestimation of variances:   5.1205E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecast state ensemble
            RMS error according to sampled variance:   3.1916E-01
               RMS error according to true variance:   6.5056E-01
              Relative underestimation of variances:   5.0941E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     14
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.9820E-01
               RMS error according to true variance:   6.3738E-01
              Relative underestimation of variances:   5.3215E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecast state ensemble
            RMS error according to sampled variance:   2.9484E-01
               RMS error according to true variance:   6.3738E-01
              Relative underestimation of variances:   5.3742E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     16
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.7804E-01
               RMS error according to true variance:   6.3831E-01
              Relative underestimation of variances:   5.6441E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecast state ensemble
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3831E-01
              Relative underestimation of variances:   5.6308E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     18
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.6454E-01
               RMS error according to true variance:   6.2520E-01
              Relative underestimation of variances:   5.7687E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state and error space basis
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecast state ensemble
            RMS error according to sampled variance:   2.6294E-01
               RMS error according to true variance:   6.2520E-01
              Relative underestimation of variances:   5.7943E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     20
PDAF     Re-orthogonalize covariance matrix modes
PDAF     --- Use unit U
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.5081E-01
               RMS error according to true variance:   6.2164E-01
              Relative underestimation of variances:   5.9654E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.02708 MB (temporary)
             Pre-Poststep:   0.04788 MB (temporary)


PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.00943 MB (persistent)
PDAF         covariance modes:   0.01308 MB (persistent)
PDAF            analysis step:   0.05527 MB (temporary)
PDAF         reinitialization:   0.04150 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF                 EOF initialization:      0.000 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time of assimilations:      0.000 s
PDAF               re-diagonalize covar:      0.005 s
PDAF                Time of prepoststep:      0.000 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.000 s
                       assimilation:      0.005 s
                   total run time:      0.005 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        49
  PARSER: filtertype=         0
  PARSER: subtype=         2
  PARSER: filename= output_seek2.dat

                     Filter: SEEK
      -- fixed basis filter with update of matrix U
      -- no re-diagonalization of VUV^T
             number of EOFs:   49
      Assimilation interval:    2
          forgetting factor: 1.00
          Re-diag each    1-th analysis step

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF     +++                  SEEK Filter                   +++
PDAF     +++                                                +++
PDAF     +++    Pham et al., J. Mar. Syst. 16 (1998) 323    +++
PDAF     +++          This implementation follows           +++
PDAF     +++      Nerger et al., Tellus 57A (2005) 715      +++
PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEEK configuration
PDAF          filter sub-type = 2
PDAF            --> fixed basis filter with update of matrix U
PDAF            --> no re-diagonalization of VUV^T
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> number of EOFs:   49

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    49
PDAF   Evolve central state on task:   1

PDAF: Call routine for ensemble initialization

         Initialize state estimate and EOF decomposed covariance matrix
         --- number of EOFs:   49

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecast state ensemble
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      2
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecast state ensemble
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecast state ensemble
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecast state ensemble
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      8
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8136E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecast state ensemble
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8136E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     10
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   3.4156E-01
               RMS error according to true variance:   6.5717E-01
              Relative underestimation of variances:   4.8025E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecast state ensemble
            RMS error according to sampled variance:   3.4156E-01
               RMS error according to true variance:   6.5717E-01
              Relative underestimation of variances:   4.8025E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     12
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecast state ensemble
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     14
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3722E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecast state ensemble
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3722E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     16
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3839E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecast state ensemble
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3839E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     18
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecast state ensemble
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     20
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   2.5226E-01
               RMS error according to true variance:   6.2088E-01
              Relative underestimation of variances:   5.9370E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.02708 MB (temporary)
             Pre-Poststep:   0.04788 MB (temporary)


PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.00943 MB (persistent)
PDAF         covariance modes:   0.01308 MB (persistent)
PDAF            analysis step:   0.05527 MB (temporary)
PDAF         reinitialization:   0.00000 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF                 EOF initialization:      0.000 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time of assimilations:      0.002 s
PDAF               re-diagonalize covar:      0.000 s
PDAF                Time of prepoststep:      0.000 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.002 s
                   total run time:      0.003 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        49
  PARSER: filtertype=         0
  PARSER: subtype=         3
  PARSER: filename= output_seek3.dat

                     Filter: SEEK
      -- fixed basis filter & no update of matrix U
      -- no re-diagonalization of VUV^T
             number of EOFs:   49
      Assimilation interval:    2
          forgetting factor: 1.00
          Re-diag each    1-th analysis step

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF     +++                  SEEK Filter                   +++
PDAF     +++                                                +++
PDAF     +++    Pham et al., J. Mar. Syst. 16 (1998) 323    +++
PDAF     +++          This implementation follows           +++
PDAF     +++      Nerger et al., Tellus 57A (2005) 715      +++
PDAF     ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEEK configuration
PDAF          filter sub-type = 3
PDAF            --> fixed basis filter & no update of matrix U
PDAF            --> no re-diagonalization of VUV^T
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> number of EOFs:   49

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    49
PDAF   Evolve central state on task:   1

PDAF: Call routine for ensemble initialization

         Initialize state estimate and EOF decomposed covariance matrix
         --- number of EOFs:   49

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecast state ensemble
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      2
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecast state ensemble
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:  -3.2268E-02
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.2640E-01
              Relative underestimation of variances:   1.8556E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecast state ensemble
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.2640E-01
              Relative underestimation of variances:  -1.5180E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.3995E-01
              Relative underestimation of variances:   2.0047E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecast state ensemble
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.3995E-01
              Relative underestimation of variances:  -1.3070E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      8
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.7827E-01
              Relative underestimation of variances:   2.3984E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecast state ensemble
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.7827E-01
              Relative underestimation of variances:  -7.5028E-02
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     10
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.0716E-01
              Relative underestimation of variances:   1.6340E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecast state ensemble
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.0716E-01
              Relative underestimation of variances:  -1.8313E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     12
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.0825E-01
              Relative underestimation of variances:   1.6469E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecast state ensemble
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.0825E-01
              Relative underestimation of variances:  -1.8131E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     14
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.1496E-01
              Relative underestimation of variances:   1.7253E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecast state ensemble
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.1496E-01
              Relative underestimation of variances:  -1.7023E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     16
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.5923E-01
              Relative underestimation of variances:   2.2078E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecast state ensemble
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.5923E-01
              Relative underestimation of variances:  -1.0198E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     18
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.3116E-01
              Relative underestimation of variances:   1.9086E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecast state ensemble
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.3116E-01
              Relative underestimation of variances:  -1.4429E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEEK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     20
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.2005E-01
              Relative underestimation of variances:   1.7838E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.02708 MB (temporary)
             Pre-Poststep:   0.04788 MB (temporary)


PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.00943 MB (persistent)
PDAF         covariance modes:   0.01308 MB (persistent)
PDAF            analysis step:   0.05527 MB (temporary)
PDAF         reinitialization:   0.00000 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF                 EOF initialization:      0.000 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time of assimilations:      0.001 s
PDAF               re-diagonalize covar:      0.000 s
PDAF                Time of prepoststep:      0.001 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.002 s
                   total run time:      0.003 s

 PDAF test suite: END
--------------------------------------------------------
Run SEIK tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         1
  PARSER: subtype=         0
  PARSER: filename= output_seik0.dat
                     Filter: SEIK
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  SEIK Filter                    +++
PDAF    +++                                                 +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++          This implementation follows            +++
PDAF    +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEIK configuration
PDAF          filter sub-type = 0
PDAF            --> Standard SEIK
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      2
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      4
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      6
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7174E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      8
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8135E-01
              Relative underestimation of variances:   4.5084E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8135E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     10
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4156E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4156E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     12
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5031E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5031E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     14
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3722E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3722E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     16
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3838E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3838E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     18
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7617E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     20
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5226E-01
               RMS error according to true variance:   6.2088E-01
              Relative underestimation of variances:   5.9370E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.00320 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.00943 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.10236 MB (temporary)
PDAF               resampling:   0.07553 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.000 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time for assimilation:      0.002 s
PDAF            ensemble transformation:      0.001 s
PDAF                Time of prepoststep:      0.000 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.000 s
                       assimilation:      0.003 s
                   total run time:      0.003 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         1
  PARSER: subtype=         1
  PARSER: filename= output_seik1.dat
                     Filter: SEIK
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  SEIK Filter                    +++
PDAF    +++                                                 +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++          This implementation follows            +++
PDAF    +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEIK configuration
PDAF          filter sub-type = 1
PDAF            --> Standard SEIK - old formulation
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      2
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      4
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      6
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7174E-01
              Relative underestimation of variances:   3.7724E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7174E-01
              Relative underestimation of variances:   3.7724E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      8
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8135E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8135E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     10
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4157E-01
               RMS error according to true variance:   6.5717E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4157E-01
               RMS error according to true variance:   6.5717E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     12
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     14
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3720E-01
              Relative underestimation of variances:   5.3577E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3719E-01
              Relative underestimation of variances:   5.3577E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     16
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3837E-01
              Relative underestimation of variances:   5.6313E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3837E-01
              Relative underestimation of variances:   5.6313E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     18
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2425E-01
              Relative underestimation of variances:   5.7617E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2425E-01
              Relative underestimation of variances:   5.7617E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEIK old formulation
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     20
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5226E-01
               RMS error according to true variance:   6.2087E-01
              Relative underestimation of variances:   5.9370E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.00320 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.00943 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.10190 MB (temporary)
PDAF               resampling:   0.06600 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.001 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time for assimilation:      0.000 s
PDAF            ensemble transformation:      0.002 s
PDAF                Time of prepoststep:      0.001 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.003 s
                   total run time:      0.004 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         1
  PARSER: subtype=         2
  PARSER: filename= output_seik2.dat
                     Filter: SEIK
      -- fixed error-space basis
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  SEIK Filter                    +++
PDAF    +++                                                 +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++          This implementation follows            +++
PDAF    +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEIK configuration
PDAF          filter sub-type = 2
PDAF            --> fixed error-space basis
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      2
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      4
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      6
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      8
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8135E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8135E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     10
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4156E-01
               RMS error according to true variance:   6.5717E-01
              Relative underestimation of variances:   4.8025E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4156E-01
               RMS error according to true variance:   6.5717E-01
              Relative underestimation of variances:   4.8025E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     12
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     14
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3723E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3723E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     16
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3840E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3840E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     18
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2427E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2427E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     20
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5226E-01
               RMS error according to true variance:   6.2088E-01
              Relative underestimation of variances:   5.9370E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.00320 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.00943 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.10236 MB (temporary)
PDAF               resampling:   0.07553 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.001 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time for assimilation:      0.001 s
PDAF            ensemble transformation:      0.001 s
PDAF                Time of prepoststep:      0.000 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.002 s
                   total run time:      0.003 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         1
  PARSER: subtype=         3
  PARSER: filename= output_seik3.dat
                     Filter: SEIK
      -- fixed state covariance matrix
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  SEIK Filter                    +++
PDAF    +++                                                 +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++          This implementation follows            +++
PDAF    +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEIK configuration
PDAF          filter sub-type = 3
PDAF            --> fixed state covariance matrix
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      2
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1050E-01
              Relative underestimation of variances:   2.7007E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   8.1050E-01
              Relative underestimation of variances:  -3.2267E-02
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      4
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.2639E-01
              Relative underestimation of variances:   1.8555E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.2639E-01
              Relative underestimation of variances:  -1.5179E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      6
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.3994E-01
              Relative underestimation of variances:   2.0047E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3665E-01
               RMS error according to true variance:   7.3994E-01
              Relative underestimation of variances:  -1.3070E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      8
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.7826E-01
              Relative underestimation of variances:   2.3983E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3665E-01
               RMS error according to true variance:   7.7826E-01
              Relative underestimation of variances:  -7.5024E-02
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     10
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.0715E-01
              Relative underestimation of variances:   1.6339E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3665E-01
               RMS error according to true variance:   7.0715E-01
              Relative underestimation of variances:  -1.8313E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     12
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9162E-01
               RMS error according to true variance:   7.0823E-01
              Relative underestimation of variances:   1.6465E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3664E-01
               RMS error according to true variance:   7.0823E-01
              Relative underestimation of variances:  -1.8131E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     14
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9160E-01
               RMS error according to true variance:   7.1495E-01
              Relative underestimation of variances:   1.7253E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3664E-01
               RMS error according to true variance:   7.1495E-01
              Relative underestimation of variances:  -1.7020E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     16
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.5923E-01
              Relative underestimation of variances:   2.2077E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3663E-01
               RMS error according to true variance:   7.5923E-01
              Relative underestimation of variances:  -1.0195E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     18
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9158E-01
               RMS error according to true variance:   7.3115E-01
              Relative underestimation of variances:   1.9090E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3663E-01
               RMS error according to true variance:   7.3115E-01
              Relative underestimation of variances:  -1.4426E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEIK
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     20
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.2005E-01
              Relative underestimation of variances:   1.7838E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.11593 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.00943 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.10255 MB (temporary)
PDAF               resampling:   0.08488 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.000 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time for assimilation:      0.001 s
PDAF            ensemble transformation:      0.001 s
PDAF                Time of prepoststep:      0.005 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.000 s
                       assimilation:      0.007 s
                   total run time:      0.007 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         1
  PARSER: subtype=         4
  PARSER: filename= output_seik4.dat
                     Filter: SEIK
      -- use ensemble transformation
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  SEIK Filter                    +++
PDAF    +++                                                 +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++          This implementation follows            +++
PDAF    +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    SEIK configuration
PDAF          filter sub-type = 4
PDAF            --> SEIK with ensemble transformation
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      2
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      4
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      6
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      8
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8135E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8135E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     10
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4156E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4156E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     12
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     14
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3721E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3721E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     16
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3839E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3839E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     18
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - SEIK with ensemble transformation
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     20
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- Compute deterministic Omega
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5226E-01
               RMS error according to true variance:   6.2088E-01
              Relative underestimation of variances:   5.9370E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.00320 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.00943 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.15957 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.001 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time for assimilation:      0.002 s
PDAF                Time of prepoststep:      0.001 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.003 s
                   total run time:      0.004 s

 PDAF test suite: END
--------------------------------------------------------
Run EnKF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         2
  PARSER: subtype=         0
  PARSER: filename= output_enkf0.dat
                     Filter: EnKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF     +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF     +++          Ensemble Kalman Filter (EnKF)          +++
PDAF     +++                                                 +++
PDAF     +++   Evensen, J. Geophys. Res. 99C (1994) 10143    +++
PDAF     +++ using an ensemble of observations according to  +++
PDAF     +++ Burgers et al., Mon. Wea. Rev. 126 (1998) 1719  +++
PDAF     +++          This implementation follows            +++
PDAF     +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF     +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF      EnKF configuration
PDAF            filter sub-type = 0
PDAF              --> EnKF with analysis for large observation dimension
PDAF              --> ensemble size:   50
PDAF          --> forgetting factor: 1.00

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use constrained random stochastic ensemble (EnKF type)
         --- Ensemble size:   50
         --- Generate ensemble
             Rank of covar matrix =    49
PDAF     --- EnKF_omega: Normalize columns of random matrix
PDAF     --- EnKF_omega: Project columns orthogonal to (1,...,1)^T

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.2639E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.7361E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.2639E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.7361E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      2
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.1622E-01
               RMS error according to true variance:   8.2226E-01
              Relative underestimation of variances:   3.7220E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.1622E-01
               RMS error according to true variance:   8.2226E-01
              Relative underestimation of variances:   3.7220E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      4
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.9084E-01
               RMS error according to true variance:   7.4961E-01
              Relative underestimation of variances:   4.7861E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.9084E-01
               RMS error according to true variance:   7.4961E-01
              Relative underestimation of variances:   4.7861E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      6
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.2009E-01
               RMS error according to true variance:   7.1992E-01
              Relative underestimation of variances:   5.5537E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.2009E-01
               RMS error according to true variance:   7.1992E-01
              Relative underestimation of variances:   5.5537E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      8
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8122E-01
               RMS error according to true variance:   7.2329E-01
              Relative underestimation of variances:   6.1120E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8122E-01
               RMS error according to true variance:   7.2329E-01
              Relative underestimation of variances:   6.1120E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     10
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.4700E-01
               RMS error according to true variance:   7.1387E-01
              Relative underestimation of variances:   6.5400E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.4700E-01
               RMS error according to true variance:   7.1387E-01
              Relative underestimation of variances:   6.5400E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     12
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.2952E-01
               RMS error according to true variance:   7.1057E-01
              Relative underestimation of variances:   6.7699E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.2952E-01
               RMS error according to true variance:   7.1057E-01
              Relative underestimation of variances:   6.7699E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     14
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0579E-01
               RMS error according to true variance:   6.9832E-01
              Relative underestimation of variances:   7.0530E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0579E-01
               RMS error according to true variance:   6.9832E-01
              Relative underestimation of variances:   7.0530E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     16
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.9157E-01
               RMS error according to true variance:   7.0144E-01
              Relative underestimation of variances:   7.2688E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.9157E-01
               RMS error according to true variance:   7.0144E-01
              Relative underestimation of variances:   7.2688E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     18
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.7946E-01
               RMS error according to true variance:   6.9867E-01
              Relative underestimation of variances:   7.4314E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.7946E-01
               RMS error according to true variance:   6.9867E-01
              Relative underestimation of variances:   7.4314E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - EnKF large-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     20
PDAF     --- use diagonal observation eror cov. matrix
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.7243E-01
               RMS error according to true variance:   6.9851E-01
              Relative underestimation of variances:   7.5314E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.07247 MB (temporary)
             Pre-Poststep:   0.00320 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF                    state:   0.00027 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.10831 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.000 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time of assimilations:      0.008 s
PDAF                Time of prepoststep:      0.000 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.000 s
                       assimilation:      0.008 s
                   total run time:      0.008 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         2
  PARSER: subtype=         1
  PARSER: filename= output_enkf1.dat
                     Filter: EnKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF     +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF     +++          Ensemble Kalman Filter (EnKF)          +++
PDAF     +++                                                 +++
PDAF     +++   Evensen, J. Geophys. Res. 99C (1994) 10143    +++
PDAF     +++ using an ensemble of observations according to  +++
PDAF     +++ Burgers et al., Mon. Wea. Rev. 126 (1998) 1719  +++
PDAF     +++          This implementation follows            +++
PDAF     +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF     +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF      EnKF configuration
PDAF            filter sub-type = 1
PDAF              --> EnKF with analysis for small observation dimension
PDAF              --> ensemble size:   50
PDAF          --> forgetting factor: 1.00

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use constrained random stochastic ensemble (EnKF type)
         --- Ensemble size:   50
         --- Generate ensemble
             Rank of covar matrix =    49
PDAF     --- EnKF_omega: Normalize columns of random matrix
PDAF     --- EnKF_omega: Project columns orthogonal to (1,...,1)^T

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.2639E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.7361E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.2639E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.7361E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      2
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.1622E-01
               RMS error according to true variance:   8.2226E-01
              Relative underestimation of variances:   3.7220E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.1622E-01
               RMS error according to true variance:   8.2226E-01
              Relative underestimation of variances:   3.7220E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      4
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.9084E-01
               RMS error according to true variance:   7.4961E-01
              Relative underestimation of variances:   4.7861E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.9084E-01
               RMS error according to true variance:   7.4961E-01
              Relative underestimation of variances:   4.7861E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      6
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.2009E-01
               RMS error according to true variance:   7.1992E-01
              Relative underestimation of variances:   5.5537E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.2009E-01
               RMS error according to true variance:   7.1992E-01
              Relative underestimation of variances:   5.5537E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      8
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8122E-01
               RMS error according to true variance:   7.2329E-01
              Relative underestimation of variances:   6.1120E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8122E-01
               RMS error according to true variance:   7.2329E-01
              Relative underestimation of variances:   6.1120E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     10
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.4700E-01
               RMS error according to true variance:   7.1387E-01
              Relative underestimation of variances:   6.5400E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.4700E-01
               RMS error according to true variance:   7.1387E-01
              Relative underestimation of variances:   6.5400E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     12
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.2952E-01
               RMS error according to true variance:   7.1057E-01
              Relative underestimation of variances:   6.7699E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.2952E-01
               RMS error according to true variance:   7.1057E-01
              Relative underestimation of variances:   6.7699E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     14
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0579E-01
               RMS error according to true variance:   6.9832E-01
              Relative underestimation of variances:   7.0530E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.0579E-01
               RMS error according to true variance:   6.9832E-01
              Relative underestimation of variances:   7.0530E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     16
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.9158E-01
               RMS error according to true variance:   7.0144E-01
              Relative underestimation of variances:   7.2688E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.9158E-01
               RMS error according to true variance:   7.0144E-01
              Relative underestimation of variances:   7.2688E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     18
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.7946E-01
               RMS error according to true variance:   6.9867E-01
              Relative underestimation of variances:   7.4314E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.7946E-01
               RMS error according to true variance:   6.9867E-01
              Relative underestimation of variances:   7.4314E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     20
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.7243E-01
               RMS error according to true variance:   6.9851E-01
              Relative underestimation of variances:   7.5314E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.07247 MB (temporary)
             Pre-Poststep:   0.00320 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF                    state:   0.00027 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.08885 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.001 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time of assimilations:      0.006 s
PDAF                Time of prepoststep:      0.001 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.007 s
                   total run time:      0.008 s

 PDAF test suite: END
--------------------------------------------------------
Run LSEIK tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         3
  PARSER: subtype=         0
  PARSER: filename= output_lseik0.dat
                     Filter: LSEIK
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  LSEIK Filter                   +++
PDAF    +++                                                 +++
PDAF    +++        Domain-localized SEIK filter by          +++
PDAF    +++   Nerger et al., Ocean Dynamics 56 (2006) 634   +++
PDAF    +++      based in the global SEIK filter by         +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LSEIK configuration
PDAF          filter sub-type = 0
PDAF            --> Standard LSEIK
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis-------------------------------------------------------
PDAF       2   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Analysis-------------------------------------------------------
PDAF       4   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8292E-01
               RMS error according to true variance:   7.0997E-01
              Relative underestimation of variances:   3.1981E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8292E-01
               RMS error according to true variance:   7.0997E-01
              Relative underestimation of variances:   3.1981E-01
PDAF Analysis-------------------------------------------------------
PDAF       6   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1810E-01
               RMS error according to true variance:   6.7094E-01
              Relative underestimation of variances:   3.7685E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1810E-01
               RMS error according to true variance:   6.7095E-01
              Relative underestimation of variances:   3.7685E-01
PDAF Analysis-------------------------------------------------------
PDAF       8   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7386E-01
               RMS error according to true variance:   6.8144E-01
              Relative underestimation of variances:   4.5137E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7386E-01
               RMS error according to true variance:   6.8144E-01
              Relative underestimation of variances:   4.5137E-01
PDAF Analysis-------------------------------------------------------
PDAF      10   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4121E-01
               RMS error according to true variance:   6.5687E-01
              Relative underestimation of variances:   4.8056E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4121E-01
               RMS error according to true variance:   6.5687E-01
              Relative underestimation of variances:   4.8056E-01
PDAF Analysis-------------------------------------------------------
PDAF      12   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1583E-01
               RMS error according to true variance:   6.4972E-01
              Relative underestimation of variances:   5.1390E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1583E-01
               RMS error according to true variance:   6.4972E-01
              Relative underestimation of variances:   5.1390E-01
PDAF Analysis-------------------------------------------------------
PDAF      14   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9537E-01
               RMS error according to true variance:   6.3642E-01
              Relative underestimation of variances:   5.3589E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9537E-01
               RMS error according to true variance:   6.3643E-01
              Relative underestimation of variances:   5.3589E-01
PDAF Analysis-------------------------------------------------------
PDAF      16   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7843E-01
               RMS error according to true variance:   6.3748E-01
              Relative underestimation of variances:   5.6324E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7843E-01
               RMS error according to true variance:   6.3748E-01
              Relative underestimation of variances:   5.6324E-01
PDAF Analysis-------------------------------------------------------
PDAF      18   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6409E-01
               RMS error according to true variance:   6.2415E-01
              Relative underestimation of variances:   5.7688E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6409E-01
               RMS error according to true variance:   6.2415E-01
              Relative underestimation of variances:   5.7688E-01
PDAF Analysis-------------------------------------------------------
PDAF      20   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5176E-01
               RMS error according to true variance:   6.2065E-01
              Relative underestimation of variances:   5.9435E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.00320 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.00969 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.09253 MB (temporary)
PDAF               resampling:   0.08488 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.001 s
PDAF                  Time of forecasts:      0.000 s
PDAF        Time for analysis/transform:      0.060 s
PDAF                  global preparations:      0.000 s
PDAF                  local analysis loop:      0.060 s
PDAF                Time of prepoststep:      0.002 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.062 s
                   total run time:      0.063 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         3
  PARSER: subtype=         2
  PARSER: filename= output_lseik2.dat
                     Filter: LSEIK
      -- fixed error-space basis
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  LSEIK Filter                   +++
PDAF    +++                                                 +++
PDAF    +++        Domain-localized SEIK filter by          +++
PDAF    +++   Nerger et al., Ocean Dynamics 56 (2006) 634   +++
PDAF    +++      based in the global SEIK filter by         +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LSEIK configuration
PDAF          filter sub-type = 2
PDAF            --> fixed error-space basis
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis-------------------------------------------------------
PDAF       2   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Analysis-------------------------------------------------------
PDAF       4   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8292E-01
               RMS error according to true variance:   7.0997E-01
              Relative underestimation of variances:   3.1980E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8292E-01
               RMS error according to true variance:   7.0997E-01
              Relative underestimation of variances:   3.1980E-01
PDAF Analysis-------------------------------------------------------
PDAF       6   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1810E-01
               RMS error according to true variance:   6.7094E-01
              Relative underestimation of variances:   3.7685E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1810E-01
               RMS error according to true variance:   6.7095E-01
              Relative underestimation of variances:   3.7685E-01
PDAF Analysis-------------------------------------------------------
PDAF       8   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7386E-01
               RMS error according to true variance:   6.8144E-01
              Relative underestimation of variances:   4.5137E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7386E-01
               RMS error according to true variance:   6.8144E-01
              Relative underestimation of variances:   4.5137E-01
PDAF Analysis-------------------------------------------------------
PDAF      10   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4121E-01
               RMS error according to true variance:   6.5687E-01
              Relative underestimation of variances:   4.8056E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4121E-01
               RMS error according to true variance:   6.5687E-01
              Relative underestimation of variances:   4.8056E-01
PDAF Analysis-------------------------------------------------------
PDAF      12   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1583E-01
               RMS error according to true variance:   6.4972E-01
              Relative underestimation of variances:   5.1390E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1583E-01
               RMS error according to true variance:   6.4972E-01
              Relative underestimation of variances:   5.1390E-01
PDAF Analysis-------------------------------------------------------
PDAF      14   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9537E-01
               RMS error according to true variance:   6.3643E-01
              Relative underestimation of variances:   5.3589E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9537E-01
               RMS error according to true variance:   6.3643E-01
              Relative underestimation of variances:   5.3589E-01
PDAF Analysis-------------------------------------------------------
PDAF      16   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7843E-01
               RMS error according to true variance:   6.3748E-01
              Relative underestimation of variances:   5.6324E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7843E-01
               RMS error according to true variance:   6.3748E-01
              Relative underestimation of variances:   5.6324E-01
PDAF Analysis-------------------------------------------------------
PDAF      18   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6409E-01
               RMS error according to true variance:   6.2415E-01
              Relative underestimation of variances:   5.7688E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6409E-01
               RMS error according to true variance:   6.2415E-01
              Relative underestimation of variances:   5.7687E-01
PDAF Analysis-------------------------------------------------------
PDAF      20   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5176E-01
               RMS error according to true variance:   6.2065E-01
              Relative underestimation of variances:   5.9435E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.00320 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.00969 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.09253 MB (temporary)
PDAF               resampling:   0.08488 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.000 s
PDAF                  Time of forecasts:      0.000 s
PDAF        Time for analysis/transform:      0.060 s
PDAF                  global preparations:      0.000 s
PDAF                  local analysis loop:      0.060 s
PDAF                Time of prepoststep:      0.001 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.000 s
                       assimilation:      0.062 s
                   total run time:      0.062 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         3
  PARSER: subtype=         3
  PARSER: filename= output_lseik3.dat
                     Filter: LSEIK
      -- fixed state covariance matrix
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  LSEIK Filter                   +++
PDAF    +++                                                 +++
PDAF    +++        Domain-localized SEIK filter by          +++
PDAF    +++   Nerger et al., Ocean Dynamics 56 (2006) 634   +++
PDAF    +++      based in the global SEIK filter by         +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LSEIK configuration
PDAF          filter sub-type = 3
PDAF            --> fixed state covariance matrix
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis-------------------------------------------------------
PDAF       2   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:  -3.2268E-02
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:  -3.2265E-02
PDAF Analysis-------------------------------------------------------
PDAF       4   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.2639E-01
              Relative underestimation of variances:  -1.5180E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.2639E-01
              Relative underestimation of variances:  -1.5179E-01
PDAF Analysis-------------------------------------------------------
PDAF       6   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.3994E-01
              Relative underestimation of variances:  -1.3071E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3665E-01
               RMS error according to true variance:   7.3994E-01
              Relative underestimation of variances:  -1.3070E-01
PDAF Analysis-------------------------------------------------------
PDAF       8   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.7826E-01
              Relative underestimation of variances:  -7.5031E-02
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3665E-01
               RMS error according to true variance:   7.7827E-01
              Relative underestimation of variances:  -7.5019E-02
PDAF Analysis-------------------------------------------------------
PDAF      10   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.0715E-01
              Relative underestimation of variances:  -1.8313E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3665E-01
               RMS error according to true variance:   7.0715E-01
              Relative underestimation of variances:  -1.8312E-01
PDAF Analysis-------------------------------------------------------
PDAF      12   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.0824E-01
              Relative underestimation of variances:  -1.8132E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3664E-01
               RMS error according to true variance:   7.0824E-01
              Relative underestimation of variances:  -1.8129E-01
PDAF Analysis-------------------------------------------------------
PDAF      14   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.1495E-01
              Relative underestimation of variances:  -1.7023E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3664E-01
               RMS error according to true variance:   7.1495E-01
              Relative underestimation of variances:  -1.7020E-01
PDAF Analysis-------------------------------------------------------
PDAF      16   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3665E-01
               RMS error according to true variance:   7.5923E-01
              Relative underestimation of variances:  -1.0198E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3663E-01
               RMS error according to true variance:   7.5923E-01
              Relative underestimation of variances:  -1.0195E-01
PDAF Analysis-------------------------------------------------------
PDAF      18   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3665E-01
               RMS error according to true variance:   7.3115E-01
              Relative underestimation of variances:  -1.4429E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3663E-01
               RMS error according to true variance:   7.3115E-01
              Relative underestimation of variances:  -1.4426E-01
PDAF Analysis-------------------------------------------------------
PDAF      20   Local SEIK analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble for fixed ensemble case
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3664E-01
               RMS error according to true variance:   7.2005E-01
              Relative underestimation of variances:  -1.6193E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.11593 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.00969 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.09272 MB (temporary)
PDAF               resampling:   0.09423 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.001 s
PDAF                  Time of forecasts:      0.000 s
PDAF        Time for analysis/transform:      0.071 s
PDAF                  global preparations:      0.000 s
PDAF                  local analysis loop:      0.071 s
PDAF                Time of prepoststep:      0.004 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.076 s
                   total run time:      0.077 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         3
  PARSER: subtype=         4
  PARSER: filename= output_lseik4.dat
                     Filter: LSEIK
      -- use ensemble transformation
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                  LSEIK Filter                   +++
PDAF    +++                                                 +++
PDAF    +++        Domain-localized SEIK filter by          +++
PDAF    +++   Nerger et al., Ocean Dynamics 56 (2006) 634   +++
PDAF    +++      based in the global SEIK filter by         +++
PDAF    +++ Pham et al., C. R. Acad. Sci. II, 326(1998) 255 +++
PDAF    +++    and Pham, Mon. Wea. Rev. 129 (2001) 1194     +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LSEIK configuration
PDAF          filter sub-type = 4
PDAF            --> SEIK with ensemble transformation
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis-------------------------------------------------------
PDAF       2   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Analysis-------------------------------------------------------
PDAF       4   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8292E-01
               RMS error according to true variance:   7.0997E-01
              Relative underestimation of variances:   3.1980E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8292E-01
               RMS error according to true variance:   7.0997E-01
              Relative underestimation of variances:   3.1980E-01
PDAF Analysis-------------------------------------------------------
PDAF       6   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1810E-01
               RMS error according to true variance:   6.7094E-01
              Relative underestimation of variances:   3.7685E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1810E-01
               RMS error according to true variance:   6.7094E-01
              Relative underestimation of variances:   3.7685E-01
PDAF Analysis-------------------------------------------------------
PDAF       8   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7386E-01
               RMS error according to true variance:   6.8144E-01
              Relative underestimation of variances:   4.5137E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7386E-01
               RMS error according to true variance:   6.8144E-01
              Relative underestimation of variances:   4.5137E-01
PDAF Analysis-------------------------------------------------------
PDAF      10   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4120E-01
               RMS error according to true variance:   6.5686E-01
              Relative underestimation of variances:   4.8056E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4120E-01
               RMS error according to true variance:   6.5686E-01
              Relative underestimation of variances:   4.8056E-01
PDAF Analysis-------------------------------------------------------
PDAF      12   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1583E-01
               RMS error according to true variance:   6.4972E-01
              Relative underestimation of variances:   5.1390E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1583E-01
               RMS error according to true variance:   6.4972E-01
              Relative underestimation of variances:   5.1390E-01
PDAF Analysis-------------------------------------------------------
PDAF      14   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9537E-01
               RMS error according to true variance:   6.3642E-01
              Relative underestimation of variances:   5.3589E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9537E-01
               RMS error according to true variance:   6.3642E-01
              Relative underestimation of variances:   5.3589E-01
PDAF Analysis-------------------------------------------------------
PDAF      16   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7843E-01
               RMS error according to true variance:   6.3748E-01
              Relative underestimation of variances:   5.6323E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7843E-01
               RMS error according to true variance:   6.3748E-01
              Relative underestimation of variances:   5.6323E-01
PDAF Analysis-------------------------------------------------------
PDAF      18   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6409E-01
               RMS error according to true variance:   6.2415E-01
              Relative underestimation of variances:   5.7687E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6409E-01
               RMS error according to true variance:   6.2415E-01
              Relative underestimation of variances:   5.7687E-01
PDAF Analysis-------------------------------------------------------
PDAF      20   Local SEIK analysis with ensemble transformation
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use Cholesky square-root of U
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5176E-01
               RMS error according to true variance:   6.2064E-01
              Relative underestimation of variances:   5.9435E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.00320 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and U:   0.00969 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.14021 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.000 s
PDAF                  Time of forecasts:      0.000 s
PDAF        Time for analysis/transform:      0.060 s
PDAF                  global preparations:      0.000 s
PDAF                  local analysis loop:      0.060 s
PDAF                Time of prepoststep:      0.001 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.000 s
                       assimilation:      0.062 s
                   total run time:      0.062 s

 PDAF test suite: END
--------------------------------------------------------
Run ETKF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         4
  PARSER: subtype=         0
  PARSER: filename= output_etkf0.dat
                     Filter: ETKF
      -- Variant using T-matrix
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++     Ensemble Transform Kalman Filter (ETKF)     +++
PDAF    +++                                                 +++
PDAF    +++   Bishop et al., Mon. Wea. Rev. 129 (2001) 420  +++
PDAF    +++    A symmetric square root is used following    +++
PDAF    +++      Hunt et al. Physica D 230 (2007) 112       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ETKF configuration
PDAF         filter sub-type = 0
PDAF            --> ETKF using T-matrix
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      2
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      4
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      6
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      8
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8136E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8136E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     10
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4157E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4157E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     12
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     14
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3721E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3721E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     16
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3839E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3839E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     18
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7617E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7617E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     20
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5226E-01
               RMS error according to true variance:   6.2088E-01
              Relative underestimation of variances:   5.9370E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.00320 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.00980 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.13295 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.000 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time for assimilation:      0.005 s
PDAF                Time of prepoststep:      0.000 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.005 s
                   total run time:      0.006 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         4
  PARSER: subtype=         1
  PARSER: filename= output_etkf1.dat
                     Filter: ETKF
      -- Variant following Hunt et al. (2007)
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++     Ensemble Transform Kalman Filter (ETKF)     +++
PDAF    +++                                                 +++
PDAF    +++   Bishop et al., Mon. Wea. Rev. 129 (2001) 420  +++
PDAF    +++    A symmetric square root is used following    +++
PDAF    +++      Hunt et al. Physica D 230 (2007) 112       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ETKF configuration
PDAF         filter sub-type = 1
PDAF            --> ETKF following Hunt et al. (2007)
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      2
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      4
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      6
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      8
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8135E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8135E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     10
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4157E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4157E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     12
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     14
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3721E-01
              Relative underestimation of variances:   5.3578E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3721E-01
              Relative underestimation of variances:   5.3578E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     16
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3838E-01
              Relative underestimation of variances:   5.6313E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3838E-01
              Relative underestimation of variances:   5.6313E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     18
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7617E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7617E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ETKF following Hunt et al. (2007)
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     20
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5226E-01
               RMS error according to true variance:   6.2086E-01
              Relative underestimation of variances:   5.9369E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.00320 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.00980 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.13295 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.001 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time for assimilation:      0.005 s
PDAF                Time of prepoststep:      0.000 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.005 s
                   total run time:      0.006 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         4
  PARSER: subtype=         2
  PARSER: filename= output_etkf2.dat
                     Filter: ETKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++     Ensemble Transform Kalman Filter (ETKF)     +++
PDAF    +++                                                 +++
PDAF    +++   Bishop et al., Mon. Wea. Rev. 129 (2001) 420  +++
PDAF    +++    A symmetric square root is used following    +++
PDAF    +++      Hunt et al. Physica D 230 (2007) 112       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ETKF configuration
PDAF         filter sub-type = 2
PDAF            --> ETKF with fixed error-space basis
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      2
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      4
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      6
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      8
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8136E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8136E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     10
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4157E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4157E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     12
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     14
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3722E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3722E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     16
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3839E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3839E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     18
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ETKF using T-matrix
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     20
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5226E-01
               RMS error according to true variance:   6.2088E-01
              Relative underestimation of variances:   5.9370E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.00320 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.00980 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.13295 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.000 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time for assimilation:      0.005 s
PDAF                Time of prepoststep:      0.000 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.000 s
                       assimilation:      0.005 s
                   total run time:      0.005 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         4
  PARSER: subtype=         3
  PARSER: filename= output_etkf3.dat
                     Filter: ETKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++     Ensemble Transform Kalman Filter (ETKF)     +++
PDAF    +++                                                 +++
PDAF    +++   Bishop et al., Mon. Wea. Rev. 129 (2001) 420  +++
PDAF    +++    A symmetric square root is used following    +++
PDAF    +++      Hunt et al. Physica D 230 (2007) 112       +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ETKF configuration
PDAF         filter sub-type = 3
PDAF            --> ETKF with fixed state covariance matrix
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      2
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:  -3.2267E-02
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.2639E-01
              Relative underestimation of variances:   1.8556E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.2640E-01
              Relative underestimation of variances:  -1.5179E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.3994E-01
              Relative underestimation of variances:   2.0047E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.3995E-01
              Relative underestimation of variances:  -1.3071E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      8
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.7827E-01
              Relative underestimation of variances:   2.3984E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3665E-01
               RMS error according to true variance:   7.7827E-01
              Relative underestimation of variances:  -7.5020E-02
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     10
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.0716E-01
              Relative underestimation of variances:   1.6340E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.0716E-01
              Relative underestimation of variances:  -1.8313E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     12
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.0825E-01
              Relative underestimation of variances:   1.6469E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.0825E-01
              Relative underestimation of variances:  -1.8130E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     14
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.1495E-01
              Relative underestimation of variances:   1.7252E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3665E-01
               RMS error according to true variance:   7.1496E-01
              Relative underestimation of variances:  -1.7022E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     16
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9160E-01
               RMS error according to true variance:   7.5923E-01
              Relative underestimation of variances:   2.2079E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3667E-01
               RMS error according to true variance:   7.5923E-01
              Relative underestimation of variances:  -1.0200E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     18
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.3115E-01
              Relative underestimation of variances:   1.9086E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3668E-01
               RMS error according to true variance:   7.3116E-01
              Relative underestimation of variances:  -1.4433E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     20
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.2005E-01
              Relative underestimation of variances:   1.7838E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.11707 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.00980 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.09462 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.001 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time for assimilation:      0.004 s
PDAF                Time of prepoststep:      0.002 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.006 s
                   total run time:      0.007 s

 PDAF test suite: END
--------------------------------------------------------
Run LETKF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         5
  PARSER: subtype=         0
  PARSER: filename= output_letkf0.dat
                     Filter: LETKF
      -- Variant using T-matrix
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Ensemble Transform Kalman Filter (LETKF)  +++
PDAF    +++                                                  +++
PDAF    +++            Domain-localized LETKF by             +++
PDAF    +++      Hunt et al., Physica D 230 (2007) 112       +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LETKF configuration
PDAF          filter sub-type = 0
PDAF            --> LETKF using T-matrix
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8136E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8136E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4157E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4157E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3722E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3722E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3839E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3839E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5226E-01
               RMS error according to true variance:   6.2088E-01
              Relative underestimation of variances:   5.9370E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.00320 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.01007 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.10363 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.001 s
PDAF                  Time of forecasts:      0.000 s
PDAF        Time for analysis/transform:      0.179 s
PDAF                  global preparations:      0.000 s
PDAF                  local analysis loop:      0.179 s
PDAF                Time of prepoststep:      0.000 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.179 s
                   total run time:      0.180 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         5
  PARSER: subtype=         1
  PARSER: filename= output_letkf1.dat
                     Filter: LETKF
      -- Variant following Hunt et al. (2007)
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Ensemble Transform Kalman Filter (LETKF)  +++
PDAF    +++                                                  +++
PDAF    +++            Domain-localized LETKF by             +++
PDAF    +++      Hunt et al., Physica D 230 (2007) 112       +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LETKF configuration
PDAF          filter sub-type = 1
PDAF            --> LETKF following Hunt et al. (2007)
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8135E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8135E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4157E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4157E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3721E-01
              Relative underestimation of variances:   5.3578E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3721E-01
              Relative underestimation of variances:   5.3578E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3837E-01
              Relative underestimation of variances:   5.6313E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3837E-01
              Relative underestimation of variances:   5.6313E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - LETKF following Hunt et al. (2007)
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5226E-01
               RMS error according to true variance:   6.2088E-01
              Relative underestimation of variances:   5.9370E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.00320 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.01007 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.10344 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.001 s
PDAF                  Time of forecasts:      0.000 s
PDAF        Time for analysis/transform:      0.177 s
PDAF                  global preparations:      0.000 s
PDAF                  local analysis loop:      0.177 s
PDAF                Time of prepoststep:      0.000 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.177 s
                   total run time:      0.178 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         5
  PARSER: subtype=         2
  PARSER: filename= output_letkf2.dat
                     Filter: LETKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Ensemble Transform Kalman Filter (LETKF)  +++
PDAF    +++                                                  +++
PDAF    +++            Domain-localized LETKF by             +++
PDAF    +++      Hunt et al., Physica D 230 (2007) 112       +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LETKF configuration
PDAF          filter sub-type = 2
PDAF            --> LETKF with fixed error-space basis
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8136E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8136E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4157E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4157E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3722E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3722E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3839E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3839E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - LETKF analysis using T-matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Perform ensemble transformation
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5226E-01
               RMS error according to true variance:   6.2088E-01
              Relative underestimation of variances:   5.9370E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.00320 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.01007 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.10363 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.000 s
PDAF                  Time of forecasts:      0.000 s
PDAF        Time for analysis/transform:      0.180 s
PDAF                  global preparations:      0.000 s
PDAF                  local analysis loop:      0.180 s
PDAF                Time of prepoststep:      0.000 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.180 s
                   total run time:      0.181 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         5
  PARSER: subtype=         3
  PARSER: filename= output_letkf3.dat
                     Filter: LETKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Ensemble Transform Kalman Filter (LETKF)  +++
PDAF    +++                                                  +++
PDAF    +++            Domain-localized LETKF by             +++
PDAF    +++      Hunt et al., Physica D 230 (2007) 112       +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LETKF configuration
PDAF          filter sub-type = 3
PDAF            --> LETKF with fixed state covariance matrix
PDAF            --> Deterministic symmetric ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:  -3.2269E-02
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:  -3.2267E-02
PDAF Analysis -------------------------------------------------------
PDAF       4   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.2639E-01
              Relative underestimation of variances:  -1.5180E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.2640E-01
              Relative underestimation of variances:  -1.5179E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.3994E-01
              Relative underestimation of variances:  -1.3071E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.3995E-01
              Relative underestimation of variances:  -1.3071E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3667E-01
               RMS error according to true variance:   7.7827E-01
              Relative underestimation of variances:  -7.5044E-02
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.7827E-01
              Relative underestimation of variances:  -7.5026E-02
PDAF Analysis -------------------------------------------------------
PDAF      10   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3667E-01
               RMS error according to true variance:   7.0716E-01
              Relative underestimation of variances:  -1.8314E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.0716E-01
              Relative underestimation of variances:  -1.8313E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3667E-01
               RMS error according to true variance:   7.0825E-01
              Relative underestimation of variances:  -1.8133E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   7.0825E-01
              Relative underestimation of variances:  -1.8130E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3667E-01
               RMS error according to true variance:   7.1495E-01
              Relative underestimation of variances:  -1.7024E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3665E-01
               RMS error according to true variance:   7.1496E-01
              Relative underestimation of variances:  -1.7022E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3668E-01
               RMS error according to true variance:   7.5923E-01
              Relative underestimation of variances:  -1.0201E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3667E-01
               RMS error according to true variance:   7.5923E-01
              Relative underestimation of variances:  -1.0199E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3670E-01
               RMS error according to true variance:   7.3115E-01
              Relative underestimation of variances:  -1.4436E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3662E-01
               RMS error according to true variance:   7.3116E-01
              Relative underestimation of variances:  -1.4424E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   LETKF analysis for fixed covariance matrix
PDAF      --- PE-domain:     0 number of analysis domains:        70
PDAF      --- PE-Domain:     0 dimension of PE-local full obs. vector        70
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble - for (L)ETKF
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3671E-01
               RMS error according to true variance:   7.2005E-01
              Relative underestimation of variances:  -1.6202E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.11707 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.01007 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.09391 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.000 s
PDAF                  Time of forecasts:      0.000 s
PDAF        Time for analysis/transform:      0.150 s
PDAF                  global preparations:      0.000 s
PDAF                  local analysis loop:      0.150 s
PDAF                Time of prepoststep:      0.006 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.000 s
                       assimilation:      0.156 s
                   total run time:      0.156 s

 PDAF test suite: END
--------------------------------------------------------
Run ESTKF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         6
  PARSER: subtype=         0
  PARSER: filename= output_estkf0.dat
                     Filter: ESTKF
      -- Standard mode
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++ Error Subspace Transform Kalman Filter (ESTKF) +++
PDAF    +++                                                +++
PDAF    +++  Nerger et al., Mon. Wea. Rev. 140 (2012) 2335 +++
PDAF    +++           doi:10.1175/MWR-D-11-00102.1         +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ESTKF configuration
PDAF          filter sub-type = 0
PDAF            --> Standard ESTKF with ensemble integration
PDAF            --> Deterministic ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      2
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      4
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      6
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      8
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8135E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8135E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     10
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4157E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4157E-01
               RMS error according to true variance:   6.5717E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     12
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     14
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3722E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3722E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     16
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3839E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3839E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     18
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     20
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5226E-01
               RMS error according to true variance:   6.2088E-01
              Relative underestimation of variances:   5.9370E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.00320 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.00943 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.16948 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.001 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time for assimilation:      0.004 s
PDAF                Time of prepoststep:      0.001 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.005 s
                   total run time:      0.006 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         6
  PARSER: subtype=         2
  PARSER: filename= output_estkf2.dat
                     Filter: ESTKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++ Error Subspace Transform Kalman Filter (ESTKF) +++
PDAF    +++                                                +++
PDAF    +++  Nerger et al., Mon. Wea. Rev. 140 (2012) 2335 +++
PDAF    +++           doi:10.1175/MWR-D-11-00102.1         +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ESTKF configuration
PDAF          filter sub-type = 2
PDAF            --> ESTKF with fixed error-space basis
PDAF            --> Deterministic ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      2
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      4
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      6
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      8
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8135E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8136E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     10
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4156E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4156E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     12
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     14
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3722E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3722E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     16
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3839E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3839E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     18
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ESTKF
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     20
PDAF     Perform ensemble transformation
PDAF     --- use symmetric square-root of A
PDAF     --- Compute deterministic Omega
PDAF     --- Ensemble update: use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5226E-01
               RMS error according to true variance:   6.2088E-01
              Relative underestimation of variances:   5.9370E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.00320 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.00943 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.16948 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.001 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time for assimilation:      0.005 s
PDAF                Time of prepoststep:      0.000 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.005 s
                   total run time:      0.006 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         6
  PARSER: subtype=         3
  PARSER: filename= output_estkf3.dat
                     Filter: ESTKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++ Error Subspace Transform Kalman Filter (ESTKF) +++
PDAF    +++                                                +++
PDAF    +++  Nerger et al., Mon. Wea. Rev. 140 (2012) 2335 +++
PDAF    +++           doi:10.1175/MWR-D-11-00102.1         +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    ESTKF configuration
PDAF          filter sub-type = 3
PDAF            --> ESTKF with fixed state covariance matrix
PDAF            --> Deterministic ensemble transformation
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      2
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:  -3.2273E-02
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.2639E-01
              Relative underestimation of variances:   1.8556E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3667E-01
               RMS error according to true variance:   7.2640E-01
              Relative underestimation of variances:  -1.5181E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      6
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.3994E-01
              Relative underestimation of variances:   2.0047E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3668E-01
               RMS error according to true variance:   7.3995E-01
              Relative underestimation of variances:  -1.3073E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step      8
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.7827E-01
              Relative underestimation of variances:   2.3984E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3668E-01
               RMS error according to true variance:   7.7827E-01
              Relative underestimation of variances:  -7.5050E-02
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     10
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.0716E-01
              Relative underestimation of variances:   1.6340E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3669E-01
               RMS error according to true variance:   7.0716E-01
              Relative underestimation of variances:  -1.8317E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     12
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.0825E-01
              Relative underestimation of variances:   1.6469E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3670E-01
               RMS error according to true variance:   7.0825E-01
              Relative underestimation of variances:  -1.8137E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     14
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.1495E-01
              Relative underestimation of variances:   1.7251E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3670E-01
               RMS error according to true variance:   7.1496E-01
              Relative underestimation of variances:  -1.7028E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     16
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.5923E-01
              Relative underestimation of variances:   2.2078E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3674E-01
               RMS error according to true variance:   7.5923E-01
              Relative underestimation of variances:  -1.0208E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     18
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.3115E-01
              Relative underestimation of variances:   1.9086E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3670E-01
               RMS error according to true variance:   7.3116E-01
              Relative underestimation of variances:  -1.4435E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - ESTKF with fixed ensemble
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- initialize observation at time step     20
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   7.2005E-01
              Relative underestimation of variances:   1.7838E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.11593 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.00943 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.10349 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.000 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time for assimilation:      0.003 s
PDAF                Time of prepoststep:      0.004 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.000 s
                       assimilation:      0.007 s
                   total run time:      0.007 s

 PDAF test suite: END
--------------------------------------------------------
Run LESTKF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         7
  PARSER: subtype=         0
  PARSER: filename= output_lestkf0.dat
                     Filter: LESTKF
      -- Standard mode
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Error Subspace Transform Kalman Filter   +++
PDAF    +++                    (LESTKF)                     +++
PDAF    +++                                                 +++
PDAF    +++ Domain-localized implementation of the ESTKF by +++
PDAF    +++  Nerger et al., Mon. Wea. Rev. 140 (2012) 2335  +++
PDAF    +++           doi:10.1175/MWR-D-11-00102.1          +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LESTKF configuration
PDAF          filter sub-type = 0
PDAF            --> Standard LESTKF
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8136E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8136E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4156E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4156E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3721E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3722E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3839E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3839E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5226E-01
               RMS error according to true variance:   6.2088E-01
              Relative underestimation of variances:   5.9370E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.00320 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.00969 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.15965 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.000 s
PDAF                  Time of forecasts:      0.000 s
PDAF        Time for analysis/transform:      0.197 s
PDAF                  global preparations:      0.000 s
PDAF                  local analysis loop:      0.197 s
PDAF                Time of prepoststep:      0.000 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.197 s
                   total run time:      0.198 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         7
  PARSER: subtype=         2
  PARSER: filename= output_lestkf2.dat
                     Filter: LESTKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Error Subspace Transform Kalman Filter   +++
PDAF    +++                    (LESTKF)                     +++
PDAF    +++                                                 +++
PDAF    +++ Domain-localized implementation of the ESTKF by +++
PDAF    +++  Nerger et al., Mon. Wea. Rev. 140 (2012) 2335  +++
PDAF    +++           doi:10.1175/MWR-D-11-00102.1          +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LESTKF configuration
PDAF          filter sub-type = 2
PDAF            --> LESTKF with fixed error-space basis
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.9161E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:   2.7008E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.8305E-01
               RMS error according to true variance:   7.1145E-01
              Relative underestimation of variances:   3.2104E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.1833E-01
               RMS error according to true variance:   6.7175E-01
              Relative underestimation of variances:   3.7725E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8136E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.7417E-01
               RMS error according to true variance:   6.8136E-01
              Relative underestimation of variances:   4.5085E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4157E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4157E-01
               RMS error according to true variance:   6.5716E-01
              Relative underestimation of variances:   4.8024E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.1623E-01
               RMS error according to true variance:   6.5030E-01
              Relative underestimation of variances:   5.1372E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3721E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.9580E-01
               RMS error according to true variance:   6.3722E-01
              Relative underestimation of variances:   5.3579E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3839E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7889E-01
               RMS error according to true variance:   6.3839E-01
              Relative underestimation of variances:   5.6314E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.6458E-01
               RMS error according to true variance:   6.2426E-01
              Relative underestimation of variances:   5.7618E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Local ESTKF analysis
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     Transform state ensemble
PDAF     --- use symmetric square-root of A
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5226E-01
               RMS error according to true variance:   6.2088E-01
              Relative underestimation of variances:   5.9370E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.00320 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.00969 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.15965 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.001 s
PDAF                  Time of forecasts:      0.000 s
PDAF        Time for analysis/transform:      0.198 s
PDAF                  global preparations:      0.000 s
PDAF                  local analysis loop:      0.198 s
PDAF                Time of prepoststep:      0.000 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.198 s
                   total run time:      0.199 s

 PDAF test suite: END

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         7
  PARSER: subtype=         3
  PARSER: filename= output_lestkf3.dat
                     Filter: LESTKF
              ensemble size:   50
      Assimilation interval:    2
          forgetting factor: 1.00

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++  Local Error Subspace Transform Kalman Filter   +++
PDAF    +++                    (LESTKF)                     +++
PDAF    +++                                                 +++
PDAF    +++ Domain-localized implementation of the ESTKF by +++
PDAF    +++  Nerger et al., Mon. Wea. Rev. 140 (2012) 2335  +++
PDAF    +++           doi:10.1175/MWR-D-11-00102.1          +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LESTKF configuration
PDAF          filter sub-type = 3
PDAF            --> LESTKF with fixed state covariance matrix
PDAF            --> Transform ensemble with deterministic Omega
PDAF            --> Use fixed forgetting factor: 1.00
PDAF            --> ensemble size:   50

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:  -3.2271E-02
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   8.1051E-01
              Relative underestimation of variances:  -3.2273E-02
PDAF Analysis -------------------------------------------------------
PDAF       4   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3667E-01
               RMS error according to true variance:   7.2639E-01
              Relative underestimation of variances:  -1.5181E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3667E-01
               RMS error according to true variance:   7.2640E-01
              Relative underestimation of variances:  -1.5181E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3667E-01
               RMS error according to true variance:   7.3994E-01
              Relative underestimation of variances:  -1.3072E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3668E-01
               RMS error according to true variance:   7.3995E-01
              Relative underestimation of variances:  -1.3073E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3668E-01
               RMS error according to true variance:   7.7827E-01
              Relative underestimation of variances:  -7.5057E-02
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3668E-01
               RMS error according to true variance:   7.7827E-01
              Relative underestimation of variances:  -7.5050E-02
PDAF Analysis -------------------------------------------------------
PDAF      10   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3668E-01
               RMS error according to true variance:   7.0716E-01
              Relative underestimation of variances:  -1.8317E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3669E-01
               RMS error according to true variance:   7.0716E-01
              Relative underestimation of variances:  -1.8317E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3670E-01
               RMS error according to true variance:   7.0825E-01
              Relative underestimation of variances:  -1.8137E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3669E-01
               RMS error according to true variance:   7.0825E-01
              Relative underestimation of variances:  -1.8136E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3670E-01
               RMS error according to true variance:   7.1495E-01
              Relative underestimation of variances:  -1.7029E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3671E-01
               RMS error according to true variance:   7.1496E-01
              Relative underestimation of variances:  -1.7029E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3672E-01
               RMS error according to true variance:   7.5923E-01
              Relative underestimation of variances:  -1.0206E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3674E-01
               RMS error according to true variance:   7.5924E-01
              Relative underestimation of variances:  -1.0208E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3675E-01
               RMS error according to true variance:   7.3115E-01
              Relative underestimation of variances:  -1.4442E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Fixed basis - evolve only state estimate
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3670E-01
               RMS error according to true variance:   7.3116E-01
              Relative underestimation of variances:  -1.4435E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   LESTKF analysis for fixed covariance matrix
PDAF     --- PE-domain:     0 number of analysis domains:        70
PDAF     --- PE-Domain:     0 dimension of PE-local full obs. vector        70
PDAF     --- Compute deterministic Omega
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        Subtype=3 variant to compute variances!
            RMS error according to sampled variance:   8.3677E-01
               RMS error according to true variance:   7.2005E-01
              Relative underestimation of variances:  -1.6209E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.11593 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.00969 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.11235 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.000 s
PDAF                  Time of forecasts:      0.000 s
PDAF        Time for analysis/transform:      0.147 s
PDAF                  global preparations:      0.001 s
PDAF                  local analysis loop:      0.145 s
PDAF                Time of prepoststep:      0.005 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.000 s
                       assimilation:      0.152 s
                   total run time:      0.152 s

 PDAF test suite: END
--------------------------------------------------------
Run LEnKF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         8
  PARSER: subtype=         0
  PARSER: filename= output_lenkf0.dat

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF     +++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF     +++    Localized Ensemble Kalman Filter (LEnKF)     +++
PDAF     +++                                                 +++
PDAF     +++   Evensen, J. Geophys. Res. 99C (1994) 10143    +++
PDAF     +++ using an ensemble of observations according to  +++
PDAF     +++ Burgers et al., Mon. Wea. Rev. 126 (1998) 1719  +++
PDAF     +++          This implementation follows            +++
PDAF     +++      Nerger et al., Tellus 57A (2005) 715       +++
PDAF     +++   The localization is covariance lozalization   +++
PDAF     +++        of PH^T and HPH^T as described in        +++
PDAF     +++   Houtekamer & Mitchell, MWR, 129 (2001) 123    +++
PDAF     +++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF      local EnKF configuration
PDAF            filter sub-type = 0
PDAF              --> local EnKF (analysis for small observation dimension)
PDAF              --> ensemble size:   50
PDAF          --> forgetting factor: 1.00

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - localized EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- Apply covariance localization
            --- Local influence radius        10.00
            --- Use uniform weight
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      2
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.7933E-01
               RMS error according to true variance:   8.1867E-01
              Relative underestimation of variances:   2.9235E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.7933E-01
               RMS error according to true variance:   8.1867E-01
              Relative underestimation of variances:   2.9235E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - localized EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- Apply covariance localization
            --- Local influence radius        10.00
            --- Use uniform weight
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      4
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.6582E-01
               RMS error according to true variance:   7.2926E-01
              Relative underestimation of variances:   3.6125E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   4.6582E-01
               RMS error according to true variance:   7.2926E-01
              Relative underestimation of variances:   3.6125E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - localized EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- Apply covariance localization
            --- Local influence radius        10.00
            --- Use uniform weight
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      6
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.8991E-01
               RMS error according to true variance:   7.0093E-01
              Relative underestimation of variances:   4.4372E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.8991E-01
               RMS error according to true variance:   7.0093E-01
              Relative underestimation of variances:   4.4372E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - localized EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- Apply covariance localization
            --- Local influence radius        10.00
            --- Use uniform weight
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step      8
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4332E-01
               RMS error according to true variance:   7.0341E-01
              Relative underestimation of variances:   5.1192E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.4332E-01
               RMS error according to true variance:   7.0341E-01
              Relative underestimation of variances:   5.1192E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - localized EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- Apply covariance localization
            --- Local influence radius        10.00
            --- Use uniform weight
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     10
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.0813E-01
               RMS error according to true variance:   6.8028E-01
              Relative underestimation of variances:   5.4706E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   3.0813E-01
               RMS error according to true variance:   6.8028E-01
              Relative underestimation of variances:   5.4706E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - localized EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- Apply covariance localization
            --- Local influence radius        10.00
            --- Use uniform weight
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     12
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8536E-01
               RMS error according to true variance:   6.7058E-01
              Relative underestimation of variances:   5.7445E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.8536E-01
               RMS error according to true variance:   6.7058E-01
              Relative underestimation of variances:   5.7445E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - localized EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- Apply covariance localization
            --- Local influence radius        10.00
            --- Use uniform weight
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     14
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5893E-01
               RMS error according to true variance:   6.6261E-01
              Relative underestimation of variances:   6.0923E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.5893E-01
               RMS error according to true variance:   6.6261E-01
              Relative underestimation of variances:   6.0923E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - localized EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- Apply covariance localization
            --- Local influence radius        10.00
            --- Use uniform weight
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     16
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.4494E-01
               RMS error according to true variance:   6.6272E-01
              Relative underestimation of variances:   6.3040E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.4494E-01
               RMS error according to true variance:   6.6272E-01
              Relative underestimation of variances:   6.3040E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - localized EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- Apply covariance localization
            --- Local influence radius        10.00
            --- Use uniform weight
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     18
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.2934E-01
               RMS error according to true variance:   6.4997E-01
              Relative underestimation of variances:   6.4715E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.2934E-01
               RMS error according to true variance:   6.4997E-01
              Relative underestimation of variances:   6.4715E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - localized EnKF small-m version
PDAF     --- use HPH directly
PDAF     --- PE-domain      0 dimension of observation vector        70
        --- Apply covariance localization
            --- Local influence radius        10.00
            --- Use uniform weight
PDAF     --- Generate ensemble of observations
        --- initialize observation at time step     20
PDAF     --- use diagonal observation eror cov. matrix
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.2089E-01
               RMS error according to true variance:   6.4994E-01
              Relative underestimation of variances:   6.6014E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.00320 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF                    state:   0.00027 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.12567 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.000 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time of assimilations:      0.007 s
PDAF                Time of prepoststep:      0.000 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.000 s
                       assimilation:      0.008 s
                   total run time:      0.008 s

 PDAF test suite: END
--------------------------------------------------------
Run NETF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=         9
  PARSER: subtype=         0
  PARSER: filename= output_netf0.dat

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++      Nonlinear Ensemble Transform Filter (NETF)       +++
PDAF    +++                                                       +++
PDAF    +++                         by                            +++
PDAF    +++ J. Toedter, B. Ahrens, Mon. Wea. Rev. 143 (2015) 1347 +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    NETF configuration
PDAF           filter sub-type = 0
--> NETF 
PDAF            --> Transform ensemble including product with random matrix
PDAF            --> Use fixed forgetting factor: 1.00

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       2
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF       2   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector      70
        --- initialize observation at time step      2
PDAF     --- Effective sample size       1.66
PDAF     --- number of small singular values     2
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.3323E-01
               RMS error according to true variance:   1.0814E+00
              Relative underestimation of variances:   5.0689E-01
PDAF Forecast -------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       4
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.3323E-01
               RMS error according to true variance:   1.0814E+00
              Relative underestimation of variances:   5.0689E-01
PDAF Analysis -------------------------------------------------------
PDAF       4   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector      70
        --- initialize observation at time step      4
PDAF     --- Effective sample size       3.51
PDAF     --- number of small singular values    15
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3250E-01
               RMS error according to true variance:   1.0208E+00
              Relative underestimation of variances:   8.7020E-01
PDAF Forecast -------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       6
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3250E-01
               RMS error according to true variance:   1.0208E+00
              Relative underestimation of variances:   8.7020E-01
PDAF Analysis -------------------------------------------------------
PDAF       6   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector      70
        --- initialize observation at time step      6
PDAF     --- Effective sample size      11.15
PDAF     --- number of small singular values    -1
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2373E-01
               RMS error according to true variance:   1.0120E+00
              Relative underestimation of variances:   8.7774E-01
PDAF Forecast -------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step       8
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2373E-01
               RMS error according to true variance:   1.0120E+00
              Relative underestimation of variances:   8.7774E-01
PDAF Analysis -------------------------------------------------------
PDAF       8   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector      70
        --- initialize observation at time step      8
PDAF     --- Effective sample size      32.95
PDAF     --- number of small singular values     0
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   9.9668E-02
               RMS error according to true variance:   1.0089E+00
              Relative underestimation of variances:   9.0121E-01
PDAF Forecast -------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      10
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   9.9668E-02
               RMS error according to true variance:   1.0089E+00
              Relative underestimation of variances:   9.0121E-01
PDAF Analysis -------------------------------------------------------
PDAF      10   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector      70
        --- initialize observation at time step     10
PDAF     --- Effective sample size      28.87
PDAF     --- number of small singular values     0
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   7.8733E-02
               RMS error according to true variance:   1.0052E+00
              Relative underestimation of variances:   9.2168E-01
PDAF Forecast -------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      12
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   7.8733E-02
               RMS error according to true variance:   1.0052E+00
              Relative underestimation of variances:   9.2168E-01
PDAF Analysis -------------------------------------------------------
PDAF      12   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector      70
        --- initialize observation at time step     12
PDAF     --- Effective sample size      29.05
PDAF     --- number of small singular values     0
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   7.5880E-02
               RMS error according to true variance:   1.0034E+00
              Relative underestimation of variances:   9.2438E-01
PDAF Forecast -------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      14
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   7.5880E-02
               RMS error according to true variance:   1.0034E+00
              Relative underestimation of variances:   9.2438E-01
PDAF Analysis -------------------------------------------------------
PDAF      14   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector      70
        --- initialize observation at time step     14
PDAF     --- Effective sample size      29.63
PDAF     --- number of small singular values    -1
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   6.9747E-02
               RMS error according to true variance:   1.0052E+00
              Relative underestimation of variances:   9.3062E-01
PDAF Forecast -------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      16
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   6.9747E-02
               RMS error according to true variance:   1.0052E+00
              Relative underestimation of variances:   9.3062E-01
PDAF Analysis -------------------------------------------------------
PDAF      16   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector      70
        --- initialize observation at time step     16
PDAF     --- Effective sample size      35.58
PDAF     --- number of small singular values     0
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   6.7679E-02
               RMS error according to true variance:   1.0035E+00
              Relative underestimation of variances:   9.3255E-01
PDAF Forecast -------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      18
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   6.7679E-02
               RMS error according to true variance:   1.0035E+00
              Relative underestimation of variances:   9.3255E-01
PDAF Analysis -------------------------------------------------------
PDAF      18   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector      70
        --- initialize observation at time step     18
PDAF     --- Effective sample size      37.02
PDAF     --- number of small singular values    -1
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   6.3125E-02
               RMS error according to true variance:   1.0021E+00
              Relative underestimation of variances:   9.3701E-01
PDAF Forecast -------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
PDAF     Call pre-post routine after forecast; step      20
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   6.3125E-02
               RMS error according to true variance:   1.0021E+00
              Relative underestimation of variances:   9.3701E-01
PDAF Analysis -------------------------------------------------------
PDAF      20   Assimilating observations - NETF
PDAF     --- Initialize random transformation
PDAF     Compute NETF filter update
PDAF     --- PE-domain   0 dimension of observation vector      70
        --- initialize observation at time step     20
PDAF     --- Effective sample size      36.55
PDAF     --- number of small singular values     0
PDAF     --- use blocking with size   200
PDAF     Call pre-post routine after analysis step
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   6.0075E-02
               RMS error according to true variance:   1.0007E+00
              Relative underestimation of variances:   9.3997E-01
PDAF Forecast -------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.00320 MB (temporary)

PDAF                       PDAF Memory overview
PDAF          ---------------------------------------------
PDAF                     Allocated memory  (MB)
PDAF              state and A:   0.00980 MB (persistent)
PDAF           ensemble array:   0.01335 MB (persistent)
PDAF            analysis step:   0.12440 MB (temporary)


PDAF                     PDAF Timing information
PDAF          ---------------------------------------------
PDAF            Generate state ensemble:      0.001 s
PDAF                  Time of forecasts:      0.000 s
PDAF              Time for assimilation:      0.049 s
PDAF                Time of prepoststep:      0.000 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.001 s
                       assimilation:      0.049 s
                   total run time:      0.050 s

 PDAF test suite: END
--------------------------------------------------------
Run LNETF tests
--------------------------------------------------------

                +++++ PDAF test suite +++++

                Data assimilation with PDAF

                     Running on 1 PE




 Initialize communicators for assimilation with PDAF

                  PE configuration:
   world   filter     model        couple     filterPE
   rank     rank   task   rank   task   rank    T/F
  ----------------------------------------------------------
     0       0      1      0      1      0       T


  PARSER: dim_state=        70
 INITIALIZE MODEL
                      MODEL: 1D Dummy Model
     Global model dimension:     70
                 Time steps:     20  (final step:     20)
             Time step size:     1.000

  -- Domain decomposition over  1 PEs
     task   1 PE(model)   0 dim_local(state):    70

 INITIALIZE PDAF
  PARSER: screen=         1
  PARSER: dim_ens=        50
  PARSER: filtertype=        10
  PARSER: subtype=         0
  PARSER: filename= output_lnetf0.dat

PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++                      PDAF                      +++
PDAF    +++      Parallel Data Assimilation Framework      +++
PDAF    +++                                                +++
PDAF    +++                Version 1.12.0                  +++
PDAF    ++++++++++++++++++++++++++++++++++++++++++++++++++++++


PDAF: Initialize filter

PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
PDAF    +++   Local Nonlinear Ensemble Transform Filter (LNETF)   +++
PDAF    +++                                                       +++
PDAF    +++              Domain-localized NETF by                 +++
PDAF    +++ J. Toedter, B. Ahrens, Mon. Wea. Rev. 143 (2015) 1347 +++
PDAF    +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

PDAF    LNETF configuration
PDAF          filter sub-type = 0
PDAF            --> LNETF 
PDAF            --> Transform ensemble including product with random matrix
PDAF            --> Use fixed forgetting factor: 1.00

PDAF: Initialize Parallelization
PDAF     Parallelization - Filter on model PEs:
PDAF                 Total number of PEs:      1
PDAF      Number of parallel model tasks:      1
PDAF                      PEs for Filter:      1
PDAF     # PEs per ensemble task and local ensemble sizes: 
PDAF     Task     1
PDAF     #PEs     1
PDAF        N    50

PDAF: Call routine for ensemble initialization

         Initialize state ensemble
         --- generate ensemble from covariance matrix
         --- use rank reduction and 2nd order exact sampling (SEIK type)
         --- Ensemble size:     50
         --- number of EOFs:    49
         --- generate ensemble of model states
PDAF     ******************************************************
PDAF     *                  PDAF_SampleEns                    *
PDAF     *                                                    *
PDAF     *  Sample an ensemble with 2nd-order exact sampling  *
PDAF     *    based on the Sangoma tool Sangoma_SampleEns.    *
PDAF     ******************************************************

PDAF     Sample state ensemble from covariance matrix
PDAF     given as EOF vectors and singular values
PDAF     --- Ensemble size:     50
PDAF     --- number of EOFs:    49
PDAF     --- Compute random Omega

PDAF: Initialization completed

 PDAF test suite: START ASSIMILATION


PDAF ----------------------------------------------------------------
PDAF                    +++++ ASSIMILATION +++++
PDAF ----------------------------------------------------------------
PDAF     Call pre-post routine at initial time
      0   Analyze initial state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Forecast -------------------------------------------------------
      0   Next observation at time step      2
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   8.3666E-01
               RMS error according to true variance:   1.0000E+00
              Relative underestimation of variances:   1.6334E-01
PDAF Analysis -------------------------------------------------------
PDAF      2   Assimilating observations - LNETF analysis using T-matrix
PDAF     --- PE-domain:  0 number of analysis domains:      70
PDAF     --- PE-Domain:  0 dimension of PE-local full obs. vector      70
PDAF     --- Initialize random transformation
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF        Minimal  effective ensemble size:             1.0
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:              -22
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.1769E-01
               RMS error according to true variance:   1.0128E+00
              Relative underestimation of variances:   4.8887E-01
    -------------------------------------------------------------
      2   Next observation at time step      4
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   5.1769E-01
               RMS error according to true variance:   1.0128E+00
              Relative underestimation of variances:   4.8887E-01
PDAF Analysis -------------------------------------------------------
PDAF      4   Assimilating observations - LNETF analysis using T-matrix
PDAF     --- PE-domain:  0 number of analysis domains:      70
PDAF     --- PE-Domain:  0 dimension of PE-local full obs. vector      70
PDAF     --- Initialize random transformation
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF        Minimal  effective ensemble size:             1.1
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:               -8
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7851E-01
               RMS error according to true variance:   9.5011E-01
              Relative underestimation of variances:   7.0686E-01
    -------------------------------------------------------------
      4   Next observation at time step      6
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.7851E-01
               RMS error according to true variance:   9.5011E-01
              Relative underestimation of variances:   7.0686E-01
PDAF Analysis -------------------------------------------------------
PDAF      6   Assimilating observations - LNETF analysis using T-matrix
PDAF     --- PE-domain:  0 number of analysis domains:      70
PDAF     --- PE-Domain:  0 dimension of PE-local full obs. vector      70
PDAF     --- Initialize random transformation
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF        Minimal  effective ensemble size:             1.7
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:              -39
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.1682E-01
               RMS error according to true variance:   9.2718E-01
              Relative underestimation of variances:   7.6615E-01
    -------------------------------------------------------------
      6   Next observation at time step      8
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   2.1682E-01
               RMS error according to true variance:   9.2718E-01
              Relative underestimation of variances:   7.6615E-01
PDAF Analysis -------------------------------------------------------
PDAF      8   Assimilating observations - LNETF analysis using T-matrix
PDAF     --- PE-domain:  0 number of analysis domains:      70
PDAF     --- PE-Domain:  0 dimension of PE-local full obs. vector      70
PDAF     --- Initialize random transformation
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF        Minimal  effective ensemble size:             7.6
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:              -35
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.9143E-01
               RMS error according to true variance:   9.2745E-01
              Relative underestimation of variances:   7.9360E-01
    -------------------------------------------------------------
      8   Next observation at time step     10
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.9143E-01
               RMS error according to true variance:   9.2745E-01
              Relative underestimation of variances:   7.9360E-01
PDAF Analysis -------------------------------------------------------
PDAF     10   Assimilating observations - LNETF analysis using T-matrix
PDAF     --- PE-domain:  0 number of analysis domains:      70
PDAF     --- PE-Domain:  0 dimension of PE-local full obs. vector      70
PDAF     --- Initialize random transformation
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF        Minimal  effective ensemble size:            15.8
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:              -36
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.7769E-01
               RMS error according to true variance:   9.1511E-01
              Relative underestimation of variances:   8.0582E-01
    -------------------------------------------------------------
     10   Next observation at time step     12
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.7769E-01
               RMS error according to true variance:   9.1511E-01
              Relative underestimation of variances:   8.0582E-01
PDAF Analysis -------------------------------------------------------
PDAF     12   Assimilating observations - LNETF analysis using T-matrix
PDAF     --- PE-domain:  0 number of analysis domains:      70
PDAF     --- PE-Domain:  0 dimension of PE-local full obs. vector      70
PDAF     --- Initialize random transformation
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF        Minimal  effective ensemble size:            13.6
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:              -35
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5606E-01
               RMS error according to true variance:   9.0369E-01
              Relative underestimation of variances:   8.2730E-01
    -------------------------------------------------------------
     12   Next observation at time step     14
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.5606E-01
               RMS error according to true variance:   9.0369E-01
              Relative underestimation of variances:   8.2730E-01
PDAF Analysis -------------------------------------------------------
PDAF     14   Assimilating observations - LNETF analysis using T-matrix
PDAF     --- PE-domain:  0 number of analysis domains:      70
PDAF     --- PE-Domain:  0 dimension of PE-local full obs. vector      70
PDAF     --- Initialize random transformation
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF        Minimal  effective ensemble size:             6.6
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:              -35
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4758E-01
               RMS error according to true variance:   8.9723E-01
              Relative underestimation of variances:   8.3552E-01
    -------------------------------------------------------------
     14   Next observation at time step     16
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4758E-01
               RMS error according to true variance:   8.9723E-01
              Relative underestimation of variances:   8.3552E-01
PDAF Analysis -------------------------------------------------------
PDAF     16   Assimilating observations - LNETF analysis using T-matrix
PDAF     --- PE-domain:  0 number of analysis domains:      70
PDAF     --- PE-Domain:  0 dimension of PE-local full obs. vector      70
PDAF     --- Initialize random transformation
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF        Minimal  effective ensemble size:            12.0
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:              -39
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4119E-01
               RMS error according to true variance:   8.9510E-01
              Relative underestimation of variances:   8.4227E-01
    -------------------------------------------------------------
     16   Next observation at time step     18
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.4119E-01
               RMS error according to true variance:   8.9510E-01
              Relative underestimation of variances:   8.4227E-01
PDAF Analysis -------------------------------------------------------
PDAF     18   Assimilating observations - LNETF analysis using T-matrix
PDAF     --- PE-domain:  0 number of analysis domains:      70
PDAF     --- PE-Domain:  0 dimension of PE-local full obs. vector      70
PDAF     --- Initialize random transformation
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF        Minimal  effective ensemble size:            21.5
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:              -39
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3509E-01
               RMS error according to true variance:   8.9514E-01
              Relative underestimation of variances:   8.4909E-01
    -------------------------------------------------------------
     18   Final observation at time step     20
PDAF     Evolve state ensemble
PDAF     --- Gather sub-ensembles on filter task
        Analyze forecasted state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.3509E-01
               RMS error according to true variance:   8.9514E-01
              Relative underestimation of variances:   8.4909E-01
PDAF Analysis -------------------------------------------------------
PDAF     20   Assimilating observations - LNETF analysis using T-matrix
PDAF     --- PE-domain:  0 number of analysis domains:      70
PDAF     --- PE-Domain:  0 dimension of PE-local full obs. vector      70
PDAF     --- Initialize random transformation
        --- Use global rms for observations of        1.000
        --- Domain localization
            --- Local influence radius        10.00
PDAF     Set localization weights
PDAF     --- Initialize unit weights
PDAF     --- Support radius    10.0000
PDAF     --- use blocking with size   200
PDAF     --- Global statistics for local analysis:
PDAF        Local domains with observations:               70
PDAF        Local domains without observations:             0
PDAF        Maximum local observation dimension:           21
PDAF        Total avg. local observation dimension:     19.4
PDAF        Minimal  effective ensemble size:            21.2
PDAF        Maximal  effective ensemble size:            50.0
PDAF        Number of small singular values:              -37
        Analyze assimilated state ensemble
        --- compute ensemble mean
            RMS error according to sampled variance:   1.2635E-01
               RMS error according to true variance:   8.9730E-01
              Relative underestimation of variances:   8.5919E-01
    -------------------------------------------------------------
     20   No more observations, exit filtering
 model PE exited: mype            0

 PDAF test suite: EXITED ASSIMILATION

                  Model - Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              Model field:   0.00054 MB (persistent)
            ensemble init:   0.05378 MB (temporary)
             Pre-Poststep:   0.00320 MB (temporary)

                       PDAF Memory overview
          ---------------------------------------------
                     Allocated memory  (MB)
              state and A:   0.00980 MB (persistent)
           ensemble array:   0.01335 MB (persistent)
            analysis step:   1.55745 MB (temporary)


                     PDAF Timing information
          ---------------------------------------------
            Generate state ensemble:      0.000 s
                  Time of forecasts:      0.000 s
        Time for analysis/transform:      0.378 s
                  global preparations:      0.042 s
                  local analysis loop:      0.336 s
                Time of prepoststep:      0.002 s

                 Model - Timing information
          ---------------------------------------------
                   Time of forecasts:     0.000 s
                 ------------ Summary ------------
                   initialize model:      0.000 s
                  initialize filter:      0.000 s
                       assimilation:      0.380 s
                   total run time:      0.380 s

 PDAF test suite: END
PDAF tests completed:  Tue Dec 20 11:13:43 CET 2016
